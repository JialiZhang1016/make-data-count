H-wave -A Python package for the Hartree-Fock approximation and the random phase approximation  State Physics, The University of Tokyo   JSPS KAK-ENHI         20 Jan 2024   Tatsumi  Aoyama   Institute for Solid State Physics, University of Tokyo, Chiba 277-8581, Japan  Institute for Solid State Physics  University of Tokyo  277-8581  Chiba  Japan     Kazuyoshi  Yoshimi   k-yoshimi@issp.u-tokyo.ac.jp  Institute for Solid State Physics, University of Tokyo, Chiba 277-8581, Japan  Institute for Solid State Physics  University of Tokyo  277-8581  Chiba  Japan     Kota  Ido   Institute for Solid State Physics, University of Tokyo, Chiba 277-8581, Japan  Institute for Solid State Physics  University of Tokyo  277-8581  Chiba  Japan     Yuichi  Motoyama   Institute for Solid State Physics, University of Tokyo, Chiba 277-8581, Japan  Institute for Solid State Physics  University of Tokyo  277-8581  Chiba  Japan     Taiki  Kawamura   Department of Physics, Nagoya University, Nagoya 464-8602, Japan  Department of Physics  Nagoya University  464-8602  Nagoya  Japan     Takahiro  Misawa   Institute for Solid State Physics, University of Tokyo, Chiba 277-8581, Japan  Institute for Solid State Physics  University of Tokyo  277-8581  Chiba  Japan     Takeo  Kato   Institute for Solid State Physics, University of Tokyo, Chiba 277-8581, Japan  Institute for Solid State Physics  University of Tokyo  277-8581  Chiba  Japan     Akito  Kobayashi   Department of Physics, Nagoya University, Nagoya 464-8602, Japan  Department of Physics  Nagoya University  464-8602  Nagoya  Japan     H-wave -A Python package for the Hartree-Fock approximation and the random phase approximation   20 Jan 2024    A55BE8216DD0F7805133F7847CE77175  arXiv:2308.00324v2[cond-mat.str-el]  Preprint submitted to Computer Physics Communications January 23, 2024     GROBID - A machine learning software for extracting information from scholarly documents       Quantum lattice models  Mean field approximation  Random phase approximation    H-wave is an open-source software package for performing the Hartree-Fock approximation (HFA) and random phase approximation (RPA) for a wide range of Hamiltonians of interacting fermionic systems.  In HFA calculations, H-wave examines the stability of several symmetry-broken phases, such as anti-ferromagnetic and charge-ordered phases, in the given Hamiltonians at zero and finite temperatures.  Furthermore, H-wave calculates the dynamical susceptibilities using RPA to examine the instability toward the symmetry-broken phases.  By preparing a simple input file for specifying the Hamiltonians, users can perform HFA and RPA for standard Hamiltonians in condensed matter physics, such as the Hubbard model and its extensions.  Additionally, users can use a Wannier90-like format to specify fermionic Hamiltonians.  A Wannier90 format is implemented in RESPACK to derive ab initio Hamiltonians for solids.  HFA and RPA for the ab initio Hamiltonians can be easily performed using H-wave.  In this paper, we first explain the basis of HFA and RPA, and the basic usage of H-wave, including download and installation.  Thereafter, the input file formats implemented in H-wave, including the Wannier90-like format for specifying the interacting fermionic Hamiltonians, are discussed.  Finally, we present several examples of H-wave such as zero-temperature HFA calculations for the extended Hubbard model on a square lattice, finite-temperature HFA calculations for the Hubbard model on a cubic lattice, and RPA in the extended Hubbard model on a square lattice. 



    PROGRAM SUMMARY Program Title: H-wave CPC Library link to program files: Developer's repository link: https://github.com/  issp-center-dev/H-wave Code Ocean capsule: Licensing provisions: GNU General Public License version 3 Programming language: Python3 External routines/libraries: NumPy, SciPy, Tomli, Requests.  Nature of problem: Physical properties of strongly correlated electrons are examined such as ground state phase structure and response functions at zero and 



 Introduction Clarifying how electron correlations in solids induce several symmetry-broken phases has long been a crucial issue in the field of condensed matter physics [1,  2] .   Although deriving tight-binding models from ab initio calculations is now a standard daily procedure [3]  [4]  [5] , solving the obtained effective models by considering the effects of Coulomb interactions remains as a non-trivial problem.   To solve effective models numerically, various numerical algorithms such as the exact diagonalization [6] , quantum Monte Carlo  [7] , and tensor network  [8]  [9]  [10] methods have been developed to date  [11,  12] .   However, these algorithms frequently incur high computational cost because they consume a significant amount of memory or execution time. 

 Numerical algorithms based on the Hartree-Fock approximation (HFA) have long been used in condensed matter physics [13,  14] .   Unrestricted HFA (UHFA), which is a simple and fundamental method for treating electronic states in molecules and solids, is used to examine the stability of ordered phases.  For example, the HFA has been used for analyzing the ordered phases in the Hubbard model [15,  16] , spin and orbital orderings in 3d transition-metal oxides  [17] , and the spin and charge ordered phases in organic compounds  [18] .   Similarly, random phase approximation (RPA), which is an algorithm for calculating response functions consistent with the UHFA [13,  19,  20] , is used for detecting instability toward ordered phases through the divergence of susceptibility.   In comparison with other sophisticated algorithms, the main advantage of the UHFA and the RPA is low numerical cost.  Therefore, they are suitable for clarifying general trends in ordered phases in correlated electron systems. 

 Program codes for UHFA and RPA have been implemented and maintained by researchers for specific lattice models.  To our knowledge, there are no widely used packages for UHFA and RPA, except for a supplementary RPA package included in triqs [21,  22] and the supplementary real-space UHF package included in mVMC  [23] .   Recently, HF and RPA analyses combined with first-principles calculations have become popular in treating real materials.  When handling such complex models derived from the first-principles calculations, it will take much time to modify existing packages or to newly implement programs.  For an easy application of the UHFA and RPA to such complex models, the development of a software package that treats various effective models of solids in a simple format is desirable.  Recently, H-wave was released as an opensource Python package with a simple and flexible user interface [24] .   Using H-wave, users can perform calculations by applying UHFA and RPA to widely studied quantum lattice models by preparing only one input file with less than ten lines.  H-wave can treat the Wannier90-like format and has interfaces for smooth connection with mVMC [23] and HΦ [25], which are program packages for more accurate calculation taking into account electron correlations. 

 In this paper, we introduce H-wave version 1.0.0.  The remainder of this paper is organized as follows.  Models that can be treated using H-wave are explained in Sec.  2.1.  The basis of the UHFA and RPA is discussed in Secs.  2.2 and 2.3, respectively.  In Sec. 3, the basic usage of H-wave, for example, downloading, installing, and running operations, is explained.  The formats of the input files, including the Wannier90-like format for specifying the Hamiltonians, are elaborated.  Three applications of H-wave are demonstrated in Sec. 4, such as the ground-state UHFA calculations of the extended Hubbard model on a square lattice, finitetemperature UHFA calculations of the Hubbard model on a cubic lattice, and RPA calculations of the extended Hubbard model on a square lattice.  Section 5 presents a summary of the study. 



 Model and Algorithm  Model In H-wave, the following extended Hubbard model can be treated: 

 H = H 0 + H int , (1)   H 0 = ⟨iα;jβ⟩ t αβ ij c † iα c jβ + H.c. , (2)   H Int = i,j,k,l α,α ′ ,β,β ′ I αα ′ ββ ′ ijkl c † iα c jα ′ c † kβ c lβ ′ , ( 3   )  where i, j, k, and l (∈ 0, • • • , N site -1) denote the lattice points with N site being the number of lattice sites, and α, α ′ , β, and β ′ specify the general orbitals including the orbitals and spins in a unit cell.  c † iα (c iα ) is the creation (annihilation) operator for an electron with a general orbital α at the ith site.  ⟨iα; jβ⟩ and t αβ ij represent the bond pair and the hopping integral between sites (i, α) and (j, β), respectively.  H Int is a general two-body Hamiltonian and the two-body interaction satisfies 

 I αα ′ ββ ′ ijkl = I β ′ βα ′ α lkji *  for satisfying the Hermiticity.  

 Unrestricted Hartree-Fock approximation In the unrestricted Hartree-Fock approximation (UHFA), we can decouple the general two-body in-teractions as 

 c † I c J c † K c L = -c † I c † K c J c L + c † I c L δ J,K ∼ -⟨c † I c L ⟩c † K c J -c † I c L ⟨c † K c J ⟩ + ⟨c † I c J ⟩c † K c L + c † I c J ⟨c † K c L ⟩ + ⟨c † I c L ⟩⟨c † K c J ⟩ -⟨c † I c J ⟩⟨c † K c L ⟩ + c † I c L δ J,K , ( 4   )  where we adopt I ≡ (i, α), J ≡ (j, α ′ ), K ≡ (k, β ′ ), and L ≡ (l, β) as notations for brevity, and the Kronecker's delta is denoted as δ J,K .  Using the UHFA, the Hamiltonian is generally denoted as 

 H UHFA = I,J c † I H IJ c J = c † Hc, (5)   where H denotes a matrix with elements represented as H IJ , and c (c † ) represents a column (row) vector with elements denoted as c I (c † I ).  Since H is an Hermite matrix, the Hamiltonian can be diagonalized by the unitary matrix U as 

 H UHFA = U ΛU † , Λ = diag(λ 0 , λ 1 , . . . ) (6)  where λ n represents the nth eigenvalue of H.  By defining d = U † c, H UHFA can be rewritten as 

 H UHFA = d † Λd = n λ n d † n d n . ( 7   )  Thus, the free energy from the UHFA can be expressed as 

 F = µN e - 1 β n ln [1 + exp(-β(λ n -µ))] + I,J,K,L I IJKL ⟨c † I c L ⟩⟨c † K c J ⟩-⟨c † I c J ⟩⟨c † K c L ⟩ , (8)   where β denotes the inverse temperature, N e is the total number of particles, and µ represents the chemical potential. 

 In the UHFA calculations, we start from the initial one-body Green's functions, which are then updated as 

 ⟨c † I c J ⟩ = n U * In U Jn ⟨d † n d n ⟩ = n U * In U Jn 1 + e β(λn-µ) . ( 9   )  In the canonical calculation in which the number of particles is fixed to N e , µ is determined to satisfy the relation N e = I ⟨c † I c I ⟩ at every step.  In Hwave, the simple-mixing algorithm is employed to update the one-body Green's functions, which are defined as 

 ⟨c † I c J ⟩ (n+1) ← (1-α mix ) ⟨c † I c J ⟩ (n) +α mix ⟨c † I c J ⟩ (n+1) , ( 10   )  where ⟨c † I c J ⟩ (n) represents the Green's functions at the nth step and α mix denotes a parameter between 0 and 1.  The iterations are repeated until the convergence condition is satisfied in which the residue R becomes smaller than a given criterion ε, such that 

 R = 1 2N 2 site IJ ⟨c † I c J ⟩ (n+1) -⟨c † I c J ⟩ (n) 2 < ε. ( 11   )  The calculation is unsuccessful or fails if the convergence condition is not met within a specified number of iterations.  In Fig. 1 , a schematic flow of the calculation of the UHFA calculation is shown for convenience.  

 At the 1st step, Set initial one-body Green's functions. 



 Hartree-Fock approximation in the momentum space When a two-body Hamiltonian satisfies the translational symmetry, we can efficiently perform the HFA calculation in the momentum space.  In the following, the translational-invariant two-body Hamiltonian below is considered instead of Eq. ( 3 )  

 H Int ≡ ij α,α ′ ,β,β ′ W αα ′ ββ ′ ij c † iα c iα ′ c † jβ c jβ ′ , ( 12   )  where a two-body interactions satisfies   W αα ′ ββ ′ ij = W β ′ βα ′ α ji *  for the Hermiticity.  The Fourier transformations of the operator are defined as 

 c riα = 1 √ N site k e ik•ri c kα , ( 13   )  c † riα = 1 √ N site k e -ik•ri c † kα , ( 14   )  where N site denotes the number of the sites and r i is a position vector at the ith site.  The one-body Hamiltonian in the real space is rewritten as 

 h 0 = k,α,β c † kα h αβ (k)c kβ . ( 15   )  Since the system has a translational symmetry, the coefficients depend only on the translation vectors, r ij = r j -r i and h αβ (k) = j tαβ 0j e -ik•r0j , where tαβ 0j includes t αβ 0j and the decoupled two-body interaction terms.  As the Hamiltonian is diagonal with respect to the wave number k, the eigenvalue and eigenvector calculations are simplified from the diagonalization of the matrix of the size N site N orbit × N site N orbit to that of N site matrices of the size N orbit × N orbit , where N orbit denotes the number of orbitals, including the spin degrees of freedom.  Thus, the calculation costs are reduced. 



 Random Phase Approximation The random phase approximation (RPA) is used for calculating the response functions, such as charge/spin susceptibility.  By examining the temperature dependence of the charge/spin susceptibility, the instability of charge/spin ordered phases can be detected.  In H-wave, RPA can be implemented in momentum space and users can obtain the dynamical susceptibility χ(q, iν n ), where ν n represents the bosonic Matsubara frequency, 

 ν n = 2nπk B T (n = -N ω /2, • • • , N ω /2 -1)  with the even cutoff integer N ω .  Here, T is the temperature and k B is the Boltzmann constant, and for simplicity, we set k B = 1 in the following.  We note that it is necessary to perform the analytical continuation to obtaining the real-frequency dynamical susceptibility χ(q, ω), which can be measured by experiments.  In this section, we briefly introduce the method for calculating the dynamical susceptibility using the RPA. 

 By applying Fourier transformation to the twobody Hamiltonian H Int defined in Eq. ( 12 ), the Hamiltonian can be rewritten as  

 H Int = 1 2N site k,k ′ ,q α,α ′ ,β,β ′ W αα ′ ββ ′ q × c † k+q,α c k,α ′ c † k ′ -q,β c k ′ ,β ′ . ( 16   )  In the RPA, the scattering processes by the interaction are considered on the basis of eigenvectors of the non-interacting Hamiltonian H 0 .  On this basis, the two-body interaction operator can be approximated as 

 c † k+q,α c k,α ′ c † k ′ -q,β c k ′ ,β ′ ∼ γ,γ ′ u * αγ,k+q u α ′ γ,k u * βγ ′ ,k ′ -q u β ′ γ ′ ,k ′ × d † k+q,γ d k,γ d † k ′ -q,γ ′ d k ′ ,γ ′ , ( 17   )  where c k,α = γ u αγ,k d k,γ , and d k,γ denotes the annihilation operator that diagonalizes H 0 .  (γ denotes the eigenvalue index.)  Then, the irreducible one-body Green's function can be expressed as 

 G (0)αβ γ (k, iω n ) = u αγ (k)u * βγ (k) iω n -ξ γ (k) + µ , ( 18   )  where ω n represents the fermionic Matsubara frequency ω n = (2n + 1)πT .  Generally, the irreducible susceptibility in non-interacting systems can be expressed as 

 χ (0)αα ′ ,β ′ β (q, iν n ) = - T N site N orbit γ=1 k,m G (0)αβ γ (k + q, iω m + iν n ) × G (0)β ′ α ′ γ (k, iω m ). ( 19   )  By using the irreducible susceptibility, the dynamical susceptibility from the RPA, χ αα ′ ,β ′ β (q, iν n ), can be obtained as 

 χ αα ′ ,β ′ β (q) = χ (0)αα ′ ,β ′ β (q) - α ′ 1 β ′ 1 χ (0)αα ′ ,β ′ 1 β1 (q) W α1α ′ 1 β ′ 1 β1 q χ α1α ′ 1 ,β ′ β (q), (20)   where we define q ≡ (q, iν n ) for simplicity.  Here, the index α includes the orbital and spin degrees of freedom.  By combining indices into one index, for example, a = α × α ′ , Eq. ( 20 ) can be rewritten in a matrix form as  

 χ(q) = χ (0) (q) -χ (0) (q)W (q)χ(q) = I + χ (0) (q)W (q) -1 χ (0) (q), (21)   where I denotes the identity matrix.  Here, for describing the equation in matrix notation, we define the two-body interaction [W (q)] ab ≡ W ba q .  The dimensions of the susceptibilities χ (0)αα ′ β ′ β (q, iν n ) and χ αα ′ ,β ′ β (q, iν n ) are given by N 4 orbit N site N ω .  The size of the multidimensional array of susceptibilities can be reduced by separating orbitals and spins.  When the spin-orbital coupling does not exist and H does not include terms that mix spin and orbital, the orbital and spin Hilbert spaces become independent.  In this case, the two-body interaction can be rewritten as 

 W α σσ ′ β σ 1 σ ′ 1 q c † k+q,ασ c k,ασ ′ c † k ′ -q,βσ1 c k ′ ,βσ ′ 1 , (22)   where α σσ ′ ≡ ασασ ′ and β σ1σ ′ 1 ≡ βσ 1 βσ ′ 1 .  Since the scattering processes occur only on the same diagonalized general orbitals, the irreducible susceptibility can be expressed as 

 χ (0)α,β σσ ′ σ ′ 1 σ1 (q, iν n ) = - T N site N orb γ=1 k,m G (0)αβ σσ ′ 1 ,γ (k + q, iω m + iν n ) × G (0)βα σ1σ ′ ,γ (k, iω m ). (23)  Here, the array size can be reduced to N 2 orb N 4 spin N site N ω where N orb and N spin denote the number of the orbital and spin degrees of freedom, respectively.  Then, the susceptibility can be obtained as 

 χ α,β σσ ′ σ ′ 1 σ1 (q) = χ (0)α,β σ σ ′ σ ′ 1 σ 1 (q) - α 2 α 3 σ 2 ,σ ′ 2 σ 3 ,σ ′ 3 χ (0)α,α2 σσ ′ σ ′ 2 σ2 (q) × W α3 σ 3 σ ′ 3 α2 σ ′ 2 σ 2 q χ α3,β σ 3 σ ′ 3 ,σ ′ 1 σ 1 (q). ( 24   )  Like as deriving Eq. ( 20 ), if α σσ ′ is represented as a single index, it can be inserted into a matrix form, and for generalized orbitals it can be denoted as  

 χ(q) = χ (0) (q) -χ (0) (q)W (q)χ(q) = I + χ (0) (q)W (q) -1 χ (0) (q). ( 25   )  In the above formula, it is necessary to store G (0)βα σ1σ ′ ,γ (k, iω n ) and align the indices of γ for G (0)βα σ1σ ′ ,γ (k, iω n ) before the summation of γ.  However, these procedures increase the numerical cost.  To reduce the numerical cost, in previous studies [26]  [27]  [28]  [29]  [30]  [31]  [32]  [33] the one-body Green's function is simply calculated as  

 G (0)αβ σσ ′ (k, iω n ) = N orb γ=1 G (0)αβ σσ ′ ,γ (k, iω n ).  Therefore, the irreducible susceptibility is calculated as 

 χ (0)α,β σσ ′ σ1σ ′ 1 (q, iν n ) = - T N site k,m G (0)αβ σσ ′ 1 (k + q, iν n + iω m ) × G (0)βα σ1σ ′ (k, iω m ). ( 26   )  Since additional terms,   G (0)αβ σσ ′ 1 ,γ (k + q, iν m + iω n )G (0)βα σ1σ ′ ,γ ′ (k, iω n ) for γ ̸ = γ ′  are included, it can lead to quantitatively different results.  Although this treatment is an approximation of the original RPA equations defined in Eq. ( 25 ), we adopted this approach.   We note that when this approximation is applied to orbitals that are clearly independent, a qualitative difference appears because it takes into account the hybridization of orbitals that do not originally exist.  After performing the block diagonalization, it is expected to closely agree with the exact RPA when only specific modes are essential, such as near the transition point.  However, quantitative deviations will occur away from the transition point.  In the next version of the software, a mode for the correct handling of the Green's functions and susceptibilities to examine the accuracy of the approximation method will be implemented. 



 Usage  Installing H-wave H-wave is implemented in Python3 and requires several external libraries, such as NumPy [34,  35] , SciPy  [36,  37] , tomli [38], and requests [39].   Since H-wave is registered to the Python Package Index (PyPI) repository [40] , users can install Hwave using the command-line tool pip as $ python3 -m pip install h-wave Additionally, the required libraries are installed.  

 The source code for H-wave is available in the GitHub repository [41] .   The users can download the zipped file from the release page, or clone the repository to obtain the latest version.  After unpacking the zipped source files and changing the current directory to the top of the source tree, users can install H-wave by executing the following command. 



 $ python3 -m pip install . Subsequently, H-wave and the required libraries are installed, and the executable file hwave is placed in the specified installation path.  Further details are provided in the installation section of the manual [42] .  



 Using H-wave To use H-wave, a toml-format file (e.g., input.toml)  and input files that specify the parameters in the Hamiltonians have to be prepared.  Figure 3 shows the schematic flow of the calculations.   In the toml file, the calculation parameters and the names of the input files for the Hamiltonian are specified.  For standard models such as the Hubbard model on a square lattice, users can use the StdFace library [44] to generate the input files that specify the Hamiltonians.  Users can run H-wave by executing the following command. 



 $ hwave input.toml When the calculations are complete, the results are provided as outputs to the files, which are specified by input.toml. 



 Input parameter file The input parameter file is written in the tomlformat [45] text file.  In the toml format, the value of a parameter is specified in the form parameter = value, where the value can be a string, number, Boolean value, array, or table (associative array).  A set of parameters can be classified into a toml table structure and labeled by a name within a square bracket, which we call a section hereafter.  An example of input.toml is presented below: [mode]-In the mode section, the calculation mode is specified as [mode] mode = "UHFk" As aforementioned, H-wave implements three methods, UHFA in real space (mode="UHFr"), UHFA in wave-number space (mode="UHFk"), and RPA (mode="RPA").  During the UHFA calculations, decision to include the Fock term can be specified using flag fock.  In the wave-number space UHFA and RPA calculations, enable spin orbital can be used to allow the hopping integrals that break the total S z conservation.  If the total S z is conserved, the calculation cost of RPA can be significantly reduced.  See Sec.  4.2.2 of the H-wave manual for the index rule of the orbitals and spins when the enable spin orbital is set to true. 

 [mode.param]-In the mode.param  section, the parameters concerning the calculation conditions can be specified.  The lattice size (the number of sites) is specified using CellShape (Nsite).  For the wave-number space UHFA and RPA calculations, a sub-lattice structure can be introduced using SubShape, as depicted in Fig. 4 . The temperature is denoted by T. The number of electrons is specified using Ncond or by filling ratio to the total number of states.   In the UHFA calculations, the total spin can be specified using 2Sz, or it can be left free. 

 The mean-field approximation is iteratively solved using the convergence criterion given by the EPS parameter.  For the RPA calculations, the number of Matsubara frequencies is specified using Nmat.  For sufficiently large Matsubara frequency, the Green's function behaves like 1/iω n .  The highenergy tail of the Green's functions along the Matsubara frequencies can be improved by subtracting a/iω n , which can be treated analytically.  The coefficient of the subtraction term a can be specified through coeff tail.  Basically, the default value a = 1 works well, but for more precise work, it may be better to select a as iω nmax G(iω nmax ). 

 [log]-In the log section, the conditions of calculation logs can be specified.  print level is used to specify the verbosity of the log outputs.  In the UHFA calculations, the interval between the residue outputs during the iterations can be set using print step.  When specified, the residues are written to the files given by print check. 

 [file.input]-In the file.input  section, the input files can be specified.  The files that define the Hamiltonians are specified in a separate subsection [file.input.interaction],  as described in Sec.  3.2.2.  In this section, the file name of the initial Green's function can be specified using initial parameter.  In the RPA calculations, the interaction term approximated using the UHFA can be considered for the initial configuration.  The coefficient of the modified hopping term H 0 = t αβ ij c † iα c jβ + H.c., where 

 t αβ ij = t αβ ij + k,γ,γ ′ W γγ ′ ,αβ ik ⟨c † kγ ′ c kγ ⟩ δ ij , ( 27   )  can be read from a file specified by trans mod.  The input file can be generated through a wave-number space UHFA calculation using the rpa output option.  An option for using the irreducible susceptibility χ (0) (q) specified by chi0q, which is obtained from the former calculation, is available for the calculation of the susceptibility matrix. 

 [file.output]-In the file.output  section, the output files for the calculation results can be specified.  The items as output for each calculation mode are described in Sec.  3.2.3. 



 Interaction definition files H-wave supports a set of interaction definition files that define the Hamiltonian.  They are specified in the [file.input.interaction]  section of the parameter file with keywords and associated file names.  These files consist of geometry information (labeled as Geometry), transfer integral (labeled as Trans for UHFr or Transfer for UHFk and RPA), and two-body interaction terms with names based on the convention adopted in other software for quantum lattice models, HΦ [46,  47] and mVMC  [48] , as listed in Table  1 .   For the RPA calculations, an external field to the one-body interaction term can be introduced using the keyword Extern.  The form of the term added to the transfer term T ασ,βσ ′ (r) reads (28) where B αβ (r) is the external field given in the file specified by Extern keyword, h is the coefficient specified by extern coeff parameter, and σ z is the z-component of the Pauli matrix.  

 T ασ,βσ ′ (r) → T ασ,βσ ′ (r) + h(σ z ) σσ ′ B αβ (r),  The file format of the interaction definition files for the UHFr calculations follows the Expert-mode format of HΦ, which is a text-based format with header lines, followed by content in which the indices i and j and the value of the coefficient, for example, J ij , are listed for the interaction term. 

 Table 1 : Keywords for the interaction types and their descriptions are summarized.   c † iα↑(↓) and c iα↑(↓) denote the creation and annihilation operators, respectively, of electrons at site i and orbital α with spin-up (spin-down). 

 N iα↑(↓) = c † iα↑(↓) c iα↑(↓)  , and   N iα = N iα↑ + N iα↓ . S ν iα = 1 2 σ,σ ′ c † iασ σ ν σσ ′ c iασ ′  where σ k is the Pauli matrix, and   σ ± = 1 2 (σ x ± iσ y ). 

 Keyword Description Transfer (or Trans)   Transfer term denoted by T iαjβ c † iασ c jβσ (spin orbital = False), or T i(α,σ)j(β,σ ′ ) c † i(α,σ) c j(β,σ ′ ) (spin orbital = True) 

 InterAll A general two-body interaction term of the form Further details have been provided in the manuals of HΦ [25] and mVMC [23] .  

 I ijklσ 1 σ 2 σ 3 σ 4 c † iσ 1 c jσ 2 c † kσ 3 c  For the UHFk and RPA calculations, a Wan-nier90-like format [3] is adopted for the interaction definition because translational symmetry is assumed in these methods.   In this format, the coefficient of the interaction term J iαjβ = J αβ (r ij ) can be expressed by the components of the threedimensional translation vector r ij , the orbital indices α and β, and the value in each line.  H-wave allows zero components to be omitted.  A few examples of the interaction definition files for the UHFk calculations are presented in the following.  The Transfer term can be expressed as Transfer in Wannier90-like format for uhfk 

 • energy: The total energy and its components for each interaction term, the number of electrons, and the value of S z are written to a text file in the item=value format. 

 • eigen: The eigenvalues and eigenvectors are provided as outputs in NumPy zip files [49] .  

 For a fixed S z , the spin-up and spin-down components are stored in separate files with spin-up or spin-down prefix.  Otherwise, the eigenvalues and eigenvectors are provided as outputs in a single file with a prefix sz-free. 

 • green: The Green's function is provided as an output in a text file with indices specified in the OnebodyG file. 

 • fij: In real-space UHFA calculations, the coefficients of the pair-product wave functions f ij , which are equivalent to the converged onebody wave functions, are provided as outputs. 

 They are written to a text-format file specified by fij.  Further details on the relationship between the HFA solutions and the pair-product wave functions have been provided in Ref. [48] .  

 In the UHFk calculations, the following keywords can be used. 

 • energy: The value of the total energy and its components for each interaction term, the number of electrons, and the value of S z are written to a text file in the item=value format.  An example output of energy is shown below.  • eigen: The eigenvalues and eigenvectors are provided as outputs in a NumPy zip file. 

 • green: The Green's function is provided as an output in a NumPy zip file. 

 • rpa: The modified Transfer term representing the approximated one-body Hamiltonian is provided as an output in a NumPy zip file for an initial value of the RPA calculation. 

 In the RPA calculations, the following keywords can be used. 

 • chi0q: The irreducible susceptibility matrix χ (0) (q, iν n ) is provided as an output in a NumPy zip file. 

 • chiq: The susceptibility matrix χ(q, iν n ) is provided as an output in a NumPy zip file. 



 Applications In this section, three examples of H-wave have been introduced, which include methods to calculate a ground-state phase diagram at zero temperature (zero-temperature UHFk), finite-temperature physical quantities (finite-temperature UHFk), and charge and spin susceptibilities at finite temperatures (RPA).  Tutorials on H-wave have been uploaded to a repository [50] , which includes several other samples of H-wave and examples presented in this paper.  



 Ground state of the extended Hubbard model on a square lattice As a simple application of the UHFk calculation at zero temperature, the ground states of the extended Hubbard model on a square lattice at halffilling were considered.  In the extended Hubbard model, a first-order quantum phase transition is expected from the antiferromagnetic (AF) phase to the charge-ordered (CO) phase by changing the offsite Coulomb interactions.  The extended Hubbard model is defined as 

 H = -t ⟨i,j⟩ σ=↑↓ c † iσ c jσ + c † jσ c iσ + U i N i↑ N i↓ + V ⟨i,j⟩ N i N j , ( 29   )  where ⟨i, j⟩ means the nearest neighbor pairs on the square lattice, N iσ = c † iσ c iσ represents the number operator of the spin σ at the site i, N i = N i↑ + N i↓ , and U and V denote the onsite and offsite Coulomb repulsion.  The hopping constant t was used as the unit of energy.  (Hereafter, t = 1.)  The case of half-filling was considered, in which the number of electrons was taken to be equal to the number of sites.  Two phases are expected to appear as the ground states (Fig. 5(a) ).   For V /U ≲ 1/4, the AF phase where the neighboring spins align in opposite directions to each other emerges.  The AF phase is characterized by the staggered magnetization defined as S(Q) = i S z i exp(-iQ • r i )/N cell with Q = (π, π), where S z i = (N i↑ -N i↓ )/2 and the summation runs over sites in the unit cell, and N cell is the number of sites in the unit cell.  For V /U ≳ 1/4, the CO phase becomes the ground state where the doubly occupied sites are arranged in a checkerboard pattern.  The CO phase is characterized by the staggered density defined as shows the V dependence of S(π, π) and N (π, π).  As expected, the first-order phase transition between the AF and the CO phases was observed at V /t = 1(= U/4t).  A sample script is available in samples/UHFk/CDW SDW directory of the tutorial repository.  By executing the script run.py, the results shown in Figure 5 (b) can be reproduced.  

 N (Q) = i (N i↑ + N i↓ ) exp(-iQ • r i )/N cell . 

 Finite-temperature properties of the Hubbard model on a cubic lattice H-wave supports finite-temperature mean-field calculations.  In this section, a typical simple example involving the estimation of Néel temperature for the Hubbard model on a cubic lattice at half-filling has been discussed.  The model was defined as 

 H = r -t ν,σ δ=±aν c † rσ c r+δ,σ + U N r↑ N r↓ , ( 30   )  where a ν denotes the translation vector along the α-axis, and ν = x, y, and z. 

 Figure 6 (a) shows the dependency of magnetization on temperature for the Hubbard model on a cubic lattice at half-filling.   The magnetization presented along the z axis was defined as 

 m z = 1 2N site r | ⟨n r↑ -n r↓ ⟩| . ( 31   )  The number of sites N site was denoted as N site = L 3 , where L denotes the linear dimensions of a cubic structure.  The magnetization was observed to be finite at the critical temperature T Néel .  For this study, T Néel was regarded as the lowest temperature at which m z had a value lesser than 10 -4 .  Figure 6 (b) shows the interaction dependence of Néel temperature T Néel .   The results suggested that T Néel monotonically increased with the interaction U/t.  However, this tendency was a well-known artifact of the HFA.  For a strong-coupling limit, T Néel is expected to decrease with increase in U/t [51]  [52]  [53] because it is governed by super-exchange interactions J = 4t 2 /U .   To correctly reproduce such a tendency, many-body correlations beyond the HFA must necessarily be included. 



 Charge and spin susceptibilities of the extended Hubbard model on a square lattice In this sub-section, charge and spin susceptibilities of the extended Hubbard model on a square lattice defined in Eq. ( 29 ) using the RPA are discussed.   In order to reproduce the numerical results shown in Fig. 1 of Ref.  [54] , the electron filling was set as 3/4 and T = 0.01.   The cell size was set to L x = L y = 128.  Sample files and scripts were used from the samples/RPA/kobayashi_2004 directory of the tutorial repository. 

 Figure 7 shows spin and charge susceptibilities χ s (q, 0), χ c (q, 0) at (U, V ) = (3.7,   0) and (0, 0.8), respectively, where χ s (q, 0) and χ c (q, 0) are defined as 1/2 σσ ′ σσ ′ χ σσ ′ (q, 0) with σ = +(-) for ↑ (↓) and 1/2 σσ ′ χ σσ ′ (q, 0), respectively.  At (U, V ) = (3.7,  0), χ s (q, 0) showed a sharp peak around Q nest = (π, π/2) due to the nesting condition as shown in the inset of Fig. 7 .   This peak developed with increasing U and diverged when the spin-density-wave transition occurred.  At (U, V ) = (0, 0.8), χ c (q, 0) exhibited sharp peaks around (π, π/2) and (π/2, π/2).  The first peak originated from the nesting condition, whereas the second peak originated from the anisotropy of V q , which had a negative peak at (π, π), in addition to the nesting conditions.  The latter peak developed with an increase in V and diverged when a charge-density wave (or charge ordering) transition occurred.  The obtained results aligned with those shown in Fig. 1 of Ref.  [54] .  



 Summary In this paper, we introduced H-wave, which can perform the unrestricted Hartree-Fock approximation (UHFA) and the random phase approximation (RPA).  UHFA and RPA in wave-number space enable numerical analyses of electron correlation effects in periodic electron systems within fluctuations up to the first order at a low computational 0 0.5 1 1.5 (0, 0) (π, 0) (π, π) (0, 0) q χ s (q, 0) χ c (q, 0) χ s (q, 0) χ c (q, 0) cost.  H-wave is open-source software with simple and flexible user interface.  Users can execute UHFA and RPA for widely studied quantum lattice models such as the Hubbard model by preparing only one input file with less than ten lines.  Furthermore, the input files of one-and two-body interactions describing effective models can be imported from first principles calculations using the Wannier90 format such as RESPACK.  This enables a highthroughput connection between the first principles calculations and H-wave.  The resulting files can be used as input files for softwares that handle strong correlation effects, such as mVMC [48] .   H-wave is included in MateriApps LIVE! [55,  56] , an environment for computational materials science, and Ma-teriApps Installer  [56,  57] , a collection of scripts for installing materials science calculation software.   These provide the environment to easy application of H-wave. 

 In the future, we plan to develop the following functions based on the experience gained from our previous works; (a) function to calculate the quantities corresponding to the experimentally measured dynamic susceptibilities, such as magnetic susceptibility and spin-lattice relaxation rate for nuclear magnetic resonance and conductivity [58]  [59]  [60]  [61] , (b) function to solve the linear Eliashberg equation evaluating the superconducting transition temperature and order parameters by considering pairing interactions mediated by charge and spin fluctua-tions  [26,  29,  54,  62] , and (c) function to treat approximations beyond RPA such as fluctuation exchange approximation (FLEX) and vertex corrections  [63]  [64]  [65]  [66]  [67] .  



 Figure 1 : 1  Figure 1: Schematic flow of the UHFA calculation. 



   Finally, for   convenience, a schematic flow of the RPA calculation is presented in Fig.2.  (Option) Set one-body Green's functions Calculate and diagonalize a one-body Hamiltonian Determine a chemical potential [using Eq. (9)] Calculate one-body Green's function [Eq.  (18)] Calculate irreducible susceptibility [Eq.  (19)] Calculate susceptibility matrix [Eq.  (21)] 



   Figure 2 : 2  Figure 2: Schematic flow of the RPA calculation.  

   Figure 3 : 3  Figure 3: Schematic flow of calculations.  First, the users prepare an input parameter file (input.toml)  and a set of interaction definition files.  The interaction definition files can be generated by StdFace from a simple definition file (stan.in),  or the output of other software such as RESPACK[43] can be used.  Then, H-wave is run in a chosen mode.  The results are provided as output in the files according to the input parameters. 



     [file.input] path_to_input = "" [file.input.interaction]  path_to_input = "./"  Geometry = "geom.dat"  Transfer = "transfer.dat"  CoulombIntra = "coulombintra.dat"  [file.output]  path_to_output = "output" energy = "energy.dat"  eigen = "eigen" green = "green" Important sections used in input.toml,  such as [mode], [mode.param],  [log], [file.input],  and [file.output]  are discussed in this paper.  Further details have been provided in the manual of H-wave [42]. 



   Figure 4 : 4  Figure 4: The definitions of the overall lattice (CellShape) and the sublattice structure (SubShape) are depicted with examples. 



   Figure 5 : 5  Figure 5: (a) Expected phase diagram of the extended Hubbard model on the square lattice at half-filling in the strong coupling limit.  (b) V dependencies of the staggered magnetization S(π, π) (green circles) and the staggered charge density N (π, π) (blue squares) of the extended Hubbard model on the square lattice with U = 4 at half-filling calculated by the UHFk mode of H-wave.  A first-order phase transition between the AF phase and the CO phase occurs around V /U = 1/4. 



   Figure 5 ( 5  Figure 5 (b) shows the V dependence of S(π, π)and N (π, π).  As expected, the first-order phase transition between the AF and the CO phases was observed at V /t = 1(= U/4t).  A sample script is available in samples/UHFk/CDW SDW directory of the tutorial repository.  By executing the script run.py, the results shown in Figure5(b) can be reproduced. 



   Figure 6 : 6  Figure 6: Magnetic properties of the Hubbard model on the cubic lattice at half-filling for L = 12.  (a) Temperature dependence of the magnetic moment along the z-axis.  Red circles, green squares, blue triangles, and purple diamonds denote the mean-field results for U/t = 4, 8, 12, and 16, respectively.  (b) Interaction dependence of the Néel temperature T Néel .  Red circles denote the mean-field results.  Insets represent schematics of paramagnetic (PM) and antiferromagnetic (AF) states. 



   (        Figure 7 : 7  Figure 7: Spin and charge susceptibilities of the extended Hubbard model at T = 0.01.  The interaction parameters are set as (U, V ) = (3.7,  0) and (0, 0.8), respectively.  The inset shows the Fermi surface (solid line) and the nesting vector Qnest ≡ (π, π/2). 



     lσ 4 (only for UHFr), CoulombIntra On-site Coulomb interaction denoted by Uiα N iα↑ N iα↓ CoulombInter Off-site Coulomb interaction denoted by V iαjβ NiαN jβ Hund Hund coupling interaction denoted by J Hund iαjβ (N iα↑ N jβ↑ + N iα↓ N jβ↓ ) 



  Ising  Ising  interaction  denoted  by     J Ising iαjβ S z iα S z jβ       Exchange  Exchange interaction denoted by     J Ex iαjβ S + iα S -jβ       PairLift  The  interaction  denoted  by     J PairLift iαjβ  c † iα↑ c iα↓ c † jβ↑ c jβ↓     PairHop  The  interaction  denoted  by     J PairHop iαjβ  c † iα↑ c jβ↑ c † iα↓ c jβ↓ (only for     UHFr mode)      

  Acknowledgments H-wave is developed under the support of " Project for Advancement of Software Usability in Materials Science " in the fiscal year 2022 by The  Institute for Solid  State Physics, The University of Tokyo .This work was supported by  JSPS KAK-ENHI Grant Numbers  21H01041 and  22K03526 . 





 Project for Advancement of Software Usability in Materials Science   21H01041   22K03526    The geometry definition (Geometry) can be expressed as 

 1.000 0.000 0.000 0.000 1.000 0.000 0.000 0.000 1.000 1 0.000e+00 0.000e+00 0.000e+00 

 The file specifications section of the H-wave manual [42] can be referred to for details on the file formats.   Such files can be generated from a simple input using the StdFace library [44].  An example of the input file (stan.in)  has been provided 



 Output H-wave outputs the calculation results to the files according to the settings specified in the [file.output]  section of the input parameter file.  A brief overview of the main parameters in [file.output] is discussed. 

 In real space UHFA calculations, the following keywords can be used. 





 Metal-insulator transitions  M  Imada    A  Fujimori    Y  Tokura    10.1103/RevModPhys.70.1039     Rev. Mod. Phys  70    1998    M. Imada, A. Fujimori, Y. Tokura, Metal-insulator transitions, Rev. Mod. Phys. 70 (1998) 1039-1263. doi:10.1103/RevModPhys.70.1039. URL https://link.aps.org/doi/10.1103/ RevModPhys.70.1039   P  Fazekas    10.1142/2945    Lecture Notes on Electron Correlation and Magnetism (Series in Modern Condensed Matter Physics)  World Scientific  1999    P. Fazekas (Ed.), Lecture Notes on Electron Correlation and Magnetism (Series in Modern Condensed Matter Physics), World Scientific, 1999. doi:10.1142/2945. URL https://www.worldscientific.com/doi/abs/10. 1142/2945   Wannier90 as a community code: new features and applications  G  Pizzi    V  Vitale    R  Arita    S  Blügel    F  Freimuth    G  Géranton    M  Gibertini    D  Gresch    C  Johnson    T  Koretsune    J  Ibañez-Azpiroz    H  Lee    J.-M  Lihm    D  Marchand    A  Marrazzo    Y  Mokrousov    J  I  Mustafa    Y  Nohara    Y  Nomura    L  Paulatto    S  Poncé    T  Ponweiser    J  Qiao    F  Thöle    S  S  Tsirkin    M  Wierzbowska    N  Marzari    D  Vanderbilt    I  Souza    A  A  Mostofi    J  R  Yates    10.1088/1361-648X/ab51ff     J. Phys. Condens. Matter  32  165902  2020    G. Pizzi, V. Vitale, R. Arita, S. Blügel, F. Freimuth, G. Géranton, M. Gibertini, D. Gresch, C. John- son, T. Koretsune, J. Ibañez-Azpiroz, H. Lee, J.-M. Lihm, D. Marchand, A. Marrazzo, Y. Mokrousov, J. I. Mustafa, Y. Nohara, Y. Nomura, L. Paulatto, S. Poncé, T. Ponweiser, J. Qiao, F. Thöle, S. S. Tsirkin, M. Wierzbowska, N. Marzari, D. Vanderbilt, I. Souza, A. A. Mostofi, J. R. Yates, Wannier90 as a community code: new features and applications, J. Phys. Condens. Matter 32 (2020) 165902. doi:10.1088/1361-648X/ ab51ff. URL https://dx.doi.org/10.1088/1361-648X/ab51ff   Frequency-dependent local interactions and low-energy effective models from electronic structure calculations  F  Aryasetiawan    M  Imada    A  Georges    G  Kotliar    S  Biermann    A  I  Lichtenstein    10.1103/PhysRevB.70.195104     Phys. Rev. B  70  195104  2004    F. Aryasetiawan, M. Imada, A. Georges, G. Kotliar, S. Biermann, A. I. Lichtenstein, Frequency-dependent local interactions and low-energy effective models from electronic structure calculations, Phys. Rev. B 70 (2004) 195104. doi:10.1103/PhysRevB.70.195104. URL https://link.aps.org/doi/10.1103/PhysRevB. 70.195104   Electronic structure calculation by first principles for strongly correlated electron systems  M  Imada    T  Miyake    10.1143/JPSJ.79.112001  doi:10.1143/JPSJ.79.112001     Journal of the Physical Society of Japan  79  11  112001  2010    M. Imada, T. Miyake, Electronic structure calcula- tion by first principles for strongly correlated elec- tron systems, Journal of the Physical Society of Japan 79 (11) (2010) 112001. arXiv:https://doi.org/10. 1143/JPSJ.79.112001, doi:10.1143/JPSJ.79.112001. URL https://doi.org/10.1143/JPSJ.79.112001   Correlated electrons in high-temperature superconductors  E  Dagotto    10.1103/RevModPhys.66.763     Rev. Mod. Phys  66    1994    E. Dagotto, Correlated electrons in high-temperature superconductors, Rev. Mod. Phys. 66 (1994) 763-840. doi:10.1103/RevModPhys.66.763. URL https://link.aps.org/doi/10.1103/ RevModPhys.66.763   10.1017/CBO9780511902581  Quantum Monte Carlo Methods  J  Gubernatis    N  Kawashima    P  Werner    Cambridge University Press  2016    J. Gubernatis, N. Kawashima, P. Werner (Eds.), Quan- tum Monte Carlo Methods, Cambridge University Press, 2016. doi:10.1017/CBO9780511902581.   The density-matrix renormalization group  U  Schollwöck    10.1103/RevModPhys.77.259     Rev. Mod. Phys  77    2005    U. Schollwöck, The density-matrix renormaliza- tion group, Rev. Mod. Phys. 77 (2005) 259-315. doi:10.1103/RevModPhys.77.259. URL https://link.aps.org/doi/10.1103/ RevModPhys.77.259   A practical introduction to tensor networks: Matrix product states and projected entangled pair states  Román  Orús    10.1016/j.aop.2014.06.013     Ann. Phys  349    2014    Román Orús, A practical introduction to tensor networks: Matrix product states and projected en- tangled pair states, Ann. Phys. 349 (2014) 117-158. doi:10.1016/j.aop.2014.06.013. URL https://www.sciencedirect.com/science/ article/pii/S0003491614001596   Tensor networks for complex quantum systems  R  Orús    10.1038/s42254-019-0086-7   Nature Reviews Physics  1  9    2019    R. Orús, Tensor networks for complex quantum sys- tems, Nature Reviews Physics 1 (9) (2019) 538-550. doi:10.1038/s42254-019-0086-7.   10.1007/978-3-540-74686-7  Computational Many-Particle Physics  H  Fehske    R  Schneider    Weiße    Springer  2008    H. Fehske, R. Schneider, Weiße (Eds.), Computational Many-Particle Physics, Springer, 2008. doi:10.1007/ 978-3-540-74686-7.   10.1007/978-3-642-35106-8    Strongly Correlated Systems  A  Avella    F  Mancini    Berlin Heidelberg    Springer  2013    A. Avella, F. Mancini (Eds.), Strongly Correlated Sys- tems, Springer Berlin Heidelberg, 2013. doi:10.1007/ 978-3-642-35106-8. URL https://doi.org/10.1007/978-3-642-35106-8   G  D  Mahan    10.1007/978-1-4757-5714-9  Many-Particle Physics  Springer  2000    3rd Edition  G. D. Mahan (Ed.), Many-Particle Physics, 3rd Edition, Springer, 2000. doi:10.1007/978-1-4757-5714-9.   P  Ring    P  Schuck    The nuclear many-body problem  Berlin, Heidelberg    Springer  1980    P. Ring, P. Schuck, The nuclear many-body problem, Springer Berlin, Heidelberg, 1980.   Two-dimensional Hubbard model: Numerical simulation study  J  E  Hirsch    10.1103/PhysRevB.31.4403     Phys. Rev. B  31    1985    J. E. Hirsch, Two-dimensional Hubbard model: Numer- ical simulation study, Phys. Rev. B 31 (1985) 4403- 4419. doi:10.1103/PhysRevB.31.4403. URL https://link.aps.org/doi/10.1103/PhysRevB. 31.4403   Stability theory of the magnetic phases for a simple model of the transition metals  D  R  Penn    10.1103/PhysRev.142.350     Phys. Rev  142    1966    D. R. Penn, Stability theory of the magnetic phases for a simple model of the transition metals, Phys. Rev. 142 (1966) 350-365. doi:10.1103/PhysRev.142.350. URL https://link.aps.org/doi/10.1103/PhysRev. 142.350   Electronic structure and orbital ordering in perovskite-type 3d transition-metal oxides studied by Hartree-Fock band-structure calculations  T  Mizokawa    A  Fujimori    10.1103/PhysRevB.54.5368     Phys. Rev. B  54    1996    T. Mizokawa, A. Fujimori, Electronic structure and orbital ordering in perovskite-type 3d transition-metal oxides studied by Hartree-Fock band-structure calcula- tions, Phys. Rev. B 54 (1996) 5368-5380. doi:10.1103/ PhysRevB.54.5368. URL https://link.aps.org/doi/10.1103/PhysRevB. 54.5368   Toward Systematic Understanding of Diversity of Electronic Properties in Low-Dimensional Molecular Solids  H  Seo    C  Hotta    H  Fukuyama    10.1021/cr030646k     Chem. Rev  104    2004    H. Seo, C. Hotta, H. Fukuyama, Toward Systematic Understanding of Diversity of Electronic Properties in Low-Dimensional Molecular Solids, Chem. Rev. 104 (2004) 5005-5036, pMID: 15535640. doi:10.1021/ cr030646k. URL https://doi.org/10.1021/cr030646k   A  L  Fetter    J  D  Walecka    Quantum Theory of Many-Particle Systems  Boston    McGraw-Hill  1971    A. L. Fetter, J. D. Walecka, Quantum Theory of Many- Particle Systems, McGraw-Hill, Boston, 1971.   Quantum Statistical Mechanics: Green's Function Methods in Equilibrium and Nonequilibrium Problems  L  P  Kadanoff    G  Baym    Westview Press  1994    L. P. Kadanoff, G. Baym (Eds.), Quantum Statistical Mechanics: Green's Function Methods in Equilibrium and Nonequilibrium Problems, Westview Press, 1994.   Triqs      Toolbox for Research on Interacting Quantum Systems     TRIQS (Toolbox for Research on Interacting Quantum Systems), https://triqs.github.io/triqs/latest/.   Triqs: A toolbox for research on interacting quantum systems  O  Parcollet    M  Ferrero    T  Ayral    H  Hafermann    I  Krivenko    L  Messio    P  Seth    10.1016/j.cpc.2015.04.023     Comput. Phys. Commun  196    2015    O. Parcollet, M. Ferrero, T. Ayral, H. Hafermann, I. Krivenko, L. Messio, P. Seth, Triqs: A toolbox for re- search on interacting quantum systems, Comput. Phys. Commun. 196 (2015) 398 -415. doi:http://dx.doi. org/10.1016/j.cpc.2015.04.023.     H-wave: a Python package for performing unrestricted Hartree-Fock calculations and random phase approximation calculations for itinerant electron systems     H-wave: a Python package for performing unrestricted Hartree-Fock calculations and random phase approx- imation calculations for itinerant electron systems, https://www.pasums.issp.u-tokyo.ac.jp/h-wave/en.   Superconductivity in Charge Ordered Organic Conductor -α-(ET) 2 I 3 Salt  A  Kobayashi    S  Katayama    K  Noguchi    Y  Suzumura    10.1143/JPSJ.73.3135     Journal of the Physical Society of Japan  73  11    2004    A. Kobayashi, S. Katayama, K. Noguchi, Y. Suzu- mura, Superconductivity in Charge Ordered Organic Conductor -α-(ET) 2 I 3 Salt-, Journal of the Physi- cal Society of Japan 73 (11) (2004) 3135-3148. doi: 10.1143/JPSJ.73.3135. URL https://doi.org/10.1143/JPSJ.73.3135   Strong-coupling theory of superconductivity in a degenerate Hubbard model  T  Takimoto    T  Hotta    K  Ueda    10.1103/PhysRevB.69.104504     Phys. Rev. B  69  104504  2004    T. Takimoto, T. Hotta, K. Ueda, Strong-coupling theory of superconductivity in a degenerate Hubbard model, Phys. Rev. B 69 (2004) 104504. doi:10.1103/ PhysRevB.69.104504. URL https://link.aps.org/doi/10.1103/PhysRevB. 69.104504   Orbital-controlled superconductivity in f -electron systems  K  Kubo    T  Hotta    10.1143/JPSJ.75.083702  doi:10.1143/JPSJ.75. 083702     Journal of the Physical Society of Japan  75  8  83702  2006    K. Kubo, T. Hotta, Orbital-controlled superconductiv- ity in f -electron systems, Journal of the Physical Soci- ety of Japan 75 (8) (2006) 083702. arXiv:https://doi. org/10.1143/JPSJ.75.083702, doi:10.1143/JPSJ.75. 083702. URL https://doi.org/10.1143/JPSJ.75.083702   Superconductivity in the vicinity of charge ordered state in organic conductor β-(meso-DMBEDT-TTF) 2 PF 6  K  Yoshimi    M  Nakamura    H  Mori    10.1143/JPSJ.76.024706  doi:10.1143/JPSJ.76.024706     Journal of the Physical Society of Japan  76  2  24706  2007    K. Yoshimi, M. Nakamura, H. Mori, Superconduc- tivity in the vicinity of charge ordered state in or- ganic conductor β-(meso-DMBEDT-TTF) 2 PF 6 , Jour- nal of the Physical Society of Japan 76 (2) (2007) 024706. arXiv:https://doi.org/10.1143/JPSJ.76. 024706, doi:10.1143/JPSJ.76.024706. URL https://doi.org/10.1143/JPSJ.76.024706   Charge ordered metal and pressure-induced superconductivity in the twodimensional organic conductor β ′′ -(DODHT) 2 PF 6  A  Kobayashi    Y  Suzumura    M  Higa    R  Kondo    S  Kagoshima    H  Nishikawa    10.1088/0953-8984/20/12/125205     Journal of Physics: Condensed Matter  20  12  125205  2008    A. Kobayashi, Y. Suzumura, M. Higa, R. Kondo, S. Kagoshima, H. Nishikawa, Charge ordered metal and pressure-induced superconductivity in the two- dimensional organic conductor β ′′ -(DODHT) 2 PF 6 , Journal of Physics: Condensed Matter 20 (12) (2008) 125205. doi:10.1088/0953-8984/20/12/125205. URL https://dx.doi.org/10.1088/0953-8984/20/12/ 125205   Near-degeneracy of several pairing channels in multiorbital models for the Fe pnictides  S  Graser    T  A  Maier    P  J  Hirschfeld    D  J  Scalapino    10.1088/1367-2630/11/2/025016     New Journal of Physics  11  2  25016  2009    S. Graser, T. A. Maier, P. J. Hirschfeld, D. J. Scalapino, Near-degeneracy of several pairing channels in multi- orbital models for the Fe pnictides, New Journal of Physics 11 (2) (2009) 025016. doi:10.1088/1367-2630/ 11/2/025016. URL https://dx.doi.org/10.1088/1367-2630/11/2/ 025016   Origin of orthorhombic transition, magnetic transition, and shear-modulus softening in iron pnictide superconductors: Analysis based on the orbital fluctuations theory  H  Kontani    T  Saito    S  Onari    10.1103/PhysRevB.84.024528     Phys. Rev. B  84  24528  2011    H. Kontani, T. Saito, S. Onari, Origin of orthorhom- bic transition, magnetic transition, and shear-modulus softening in iron pnictide superconductors: Analysis based on the orbital fluctuations theory, Phys. Rev. B 84 (2011) 024528. doi:10.1103/PhysRevB.84.024528. URL https://link.aps.org/doi/10.1103/PhysRevB. 84.024528   Role of vertex corrections in the matrix formulation of the random phase approximation for the multiorbital Hubbard model  M  Altmeyer    D  Guterding    P  J  Hirschfeld    T  A  Maier    R  Valentí    D  J  Scalapino    10.1103/PhysRevB.94.214515     Phys. Rev. B  94  214515  2016    M. Altmeyer, D. Guterding, P. J. Hirschfeld, T. A. Maier, R. Valentí, D. J. Scalapino, Role of vertex correc- tions in the matrix formulation of the random phase ap- proximation for the multiorbital Hubbard model, Phys. Rev. B 94 (2016) 214515. doi:10.1103/PhysRevB.94. 214515. URL https://link.aps.org/doi/10.1103/PhysRevB. 94.214515   Array programming with NumPy  C  R  Harris    K  J  Millman    S  J  Van Der Walt    R  Gommers    P  Virtanen    D  Cournapeau    E  Wieser    J  Taylor    S  Berg    N  J  Smith    R  Kern    M  Picus    S  Hoyer    M  H  Van Kerkwijk    M  Brett    A  Haldane    J  F  Del Río    M  Wiebe    P  Peterson    P  Gérard-Marchant    K  Sheppard    T  Reddy    W  Weckesser    H  Abbasi    C  Gohlke    T  E  Oliphant    10.1038/s41586-020-2649-2     Nature  585  7825    2020    C. R. Harris, K. J. Millman, S. J. van der Walt, R. Gom- mers, P. Virtanen, D. Cournapeau, E. Wieser, J. Tay- lor, S. Berg, N. J. Smith, R. Kern, M. Picus, S. Hoyer, M. H. van Kerkwijk, M. Brett, A. Haldane, J. F. del Río, M. Wiebe, P. Peterson, P. Gérard-Marchant, K. Sheppard, T. Reddy, W. Weckesser, H. Abbasi, C. Gohlke, T. E. Oliphant, Array programming with NumPy, Nature 585 (7825) (2020) 357-362. doi:10. 1038/s41586-020-2649-2. URL https://doi.org/10.1038/s41586-020-2649-2   SciPy 1.0 Contributors, SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python  P  Virtanen    R  Gommers    T  E  Oliphant    M  Haberland    T  Reddy    D  Cournapeau    E  Burovski    P  Peterson    W  Weckesser    J  Bright    S  J  Van Der Walt    M  Brett    J  Wilson    K  J  Millman    N  Mayorov    A  R J  Nelson    E  Jones    R  Kern    E  Larson    C  J  Carey    İ  Polat    Y  Feng    E  W  Moore    J  Vander-Plas    D  Laxalde    J  Perktold    R  Cimrman    I  Henriksen    E  A  Quintero    C  R  Harris    A  M  Archibald    A  H  Ribeiro    F  Pedregosa    P  Van Mulbregt    10.1038/s41592-019-0686-2   Nature Methods  17    2020    P. Virtanen, R. Gommers, T. E. Oliphant, M. Haber- land, T. Reddy, D. Cournapeau, E. Burovski, P. Pe- terson, W. Weckesser, J. Bright, S. J. van der Walt, M. Brett, J. Wilson, K. J. Millman, N. Mayorov, A. R. J. Nelson, E. Jones, R. Kern, E. Larson, C. J. Carey, İ. Polat, Y. Feng, E. W. Moore, J. Vander- Plas, D. Laxalde, J. Perktold, R. Cimrman, I. Hen- riksen, E. A. Quintero, C. R. Harris, A. M. Archibald, A. H. Ribeiro, F. Pedregosa, P. van Mulbregt, SciPy 1.0 Contributors, SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python, Nature Methods 17 (2020) 261-272. doi:10.1038/s41592-019-0686-2.   Respack: An ab initio tool for derivation of effective low-energy model of material  K  Nakamura    Y  Yoshimoto    Y  Nomura    T  Tadano    M  Kawamura    T  Kosugi    K  Yoshimi    T  Misawa    Y  Motoyama    10.1016/j.cpc.2020.107781     Comput. Phys. Commun  261  107781  2021    K. Nakamura, Y. Yoshimoto, Y. Nomura, T. Tadano, M. Kawamura, T. Kosugi, K. Yoshimi, T. Mis- awa, Y. Motoyama, Respack: An ab initio tool for derivation of effective low-energy model of mate- rial, Comput. Phys. Commun. 261 (2021) 107781. doi:https://doi.org/10.1016/j.cpc.2020.107781. URL https://www.sciencedirect.com/science/ article/pii/S001046552030391X   Quantum lattice model solver HΦ  M  Kawamura    K  Yoshimi    T  Misawa    Y  Yamaji    S  Todo    N  Kawashima    10.1016/j.cpc.2017.04.006     Computer Physics Communications  217    2017    M. Kawamura, K. Yoshimi, T. Misawa, Y. Yamaji, S. Todo, N. Kawashima, Quantum lattice model solver HΦ, Computer Physics Communications 217 (2017) 180-192. doi:10.1016/j.cpc.2017.04.006. URL https://www.sciencedirect.com/science/ article/pii/S0010465517301200   Update of HΦ: Newly added functions and methods in versions 2 and  K  Ido    M  Kawamura    Y  Motoyama    K  Yoshimi    Y  Yamaji    S  Todo    N  Kawashima    T  Misawa    arXiv:2307.13222  2023  3    K. Ido, M. Kawamura, Y. Motoyama, K. Yoshimi, Y. Yamaji, S. Todo, N. Kawashima, T. Misawa, Up- date of HΦ: Newly added functions and methods in versions 2 and 3 (2023). arXiv:2307.13222.   mVMC-Open-source software for many-variable variational Monte Carlo method  T  Misawa    S  Morita    K  Yoshimi    M  Kawamura    Y  Motoyama    K  Ido    T  Ohgoe    M  Imada    T  Kato    10.1016/j.cpc.2018.08.014     Comput. Phys. Commun  235    2019    T. Misawa, S. Morita, K. Yoshimi, M. Kawamura, Y. Motoyama, K. Ido, T. Ohgoe, M. Imada, T. Kato, mVMC-Open-source software for many-variable vari- ational Monte Carlo method, Comput. Phys. Commun. 235 (2019) 447-462. doi:10.1016/j.cpc.2018.08.014. URL https://www.sciencedirect.com/science/ article/pii/S0010465518303102   Magnetic phase diagram of the half-filled Hubbard model for a simple cubic lattice  Y  Kakehashi    H  Hasegawa    10.1103/PhysRevB.36.4066     Phys. Rev. B  36    1987    Y. Kakehashi, H. Hasegawa, Magnetic phase diagram of the half-filled Hubbard model for a simple cubic lat- tice, Phys. Rev. B 36 (1987) 4066-4069. doi:10.1103/ PhysRevB.36.4066. URL https://link.aps.org/doi/10.1103/PhysRevB. 36.4066   Critical properties of the half-filled Hubbard model in three dimensions  G  Rohringer    A  Toschi    A  Katanin    K  Held    10.1103/PhysRevLett.107.256402     Phys. Rev. Lett  107  256402  2011    G. Rohringer, A. Toschi, A. Katanin, K. Held, Critical properties of the half-filled Hubbard model in three dimensions, Phys. Rev. Lett. 107 (2011) 256402. doi:10.1103/PhysRevLett.107.256402. URL https://link.aps.org/doi/10.1103/ PhysRevLett.107.256402   Testing the Monte Carlomean field approximation in the one-band Hubbard model  A  Mukherjee    N  D  Patel    S  Dong    S  Johnston    A  Moreo    E  Dagotto    10.1103/PhysRevB.90.205133     Phys. Rev. B  90  205133  2014    A. Mukherjee, N. D. Patel, S. Dong, S. Johnston, A. Moreo, E. Dagotto, Testing the Monte Carlo- mean field approximation in the one-band Hubbard model, Phys. Rev. B 90 (2014) 205133. doi:10.1103/ PhysRevB.90.205133. URL https://link.aps.org/doi/10.1103/PhysRevB. 90.205133   Charge-Fluctuation-Induced Superconducting State in Two-Dimensional Quarter-Filled Electron Systems  A  Kobayashi    Y  Tanaka    M  Ogata    Y  Suzumura    10.1143/JPSJ.73.1115     Journal of the Physical Society of Japan  73  5    2004    A. Kobayashi, Y. Tanaka, M. Ogata, Y. Suzu- mura, Charge-Fluctuation-Induced Superconducting State in Two-Dimensional Quarter-Filled Electron Sys- tems, Journal of the Physical Society of Japan 73 (5) (2004) 1115-1118. doi:10.1143/JPSJ.73.1115. URL https://doi.org/10.1143/JPSJ.73.1115     MateriApps LIVE!: an environment for computational materials science     MateriApps LIVE!: an environment for compu- tational materials science., http://cmsi.github.io/ MateriAppsLive/.   MateriApps LIVE! and MateriApps Installer: Environment for starting and scaling up materials science simulations  Y  Motoyama    K  Yoshimi    T  Kato    S  Todo    10.1016/j.softx.2022.101210     SoftwareX  20  101210  2022    Y. Motoyama, K. Yoshimi, T. Kato, S. Todo, MateriApps LIVE! and MateriApps Installer: En- vironment for starting and scaling up materials science simulations, SoftwareX 20 (2022) 101210. doi:10.1016/j.softx.2022.101210. URL https://www.sciencedirect.com/science/ article/pii/S2352711022001285     MateriApps Installer: a script collection for installation of computational materials science programs     MateriApps Installer: a script collection for installation of computational materials science programs., https: //github.com/wistaria/MateriAppsInstaller.   Statistical-mechanical theory of irreversible processes. I. General theory and simple applications to magnetic and conduction problems  R  Kubo    10.1143/JPSJ.12.570  doi:     Journal of the Physical Society of Japan  12  6    1957    R. Kubo, Statistical-mechanical theory of irreversible processes. I. General theory and simple applications to magnetic and conduction problems, Journal of the Physical Society of Japan 12 (6) (1957) 570- 586. arXiv:https://doi.org/10.1143/JPSJ.12.570, doi:10.1143/JPSJ.12.570. URL https://doi.org/10.1143/JPSJ.12.570   The effect of electron-electron interaction on the nuclear spin relaxation in metals  T  Moriya    10.1143/JPSJ.18.516  doi:     Journal of the Physical Society of Japan  18  4    1963    T. Moriya, The effect of electron-electron interaction on the nuclear spin relaxation in metals, Journal of the Physical Society of Japan 18 (4) (1963) 516- 520. arXiv:https://doi.org/10.1143/JPSJ.18.516, doi:10.1143/JPSJ.18.516. URL https://doi.org/10.1143/JPSJ.18.516   Analysis of nuclear relaxation experiments in high Tc oxides based on Mila-Rice Hamiltonian  T  Imai    10.1143/JPSJ.59.2508  doi:     Journal of the Physical Society of Japan  59  7    1990    T. Imai, Analysis of nuclear relaxation experiments in high Tc oxides based on Mila-Rice Hamiltonian, Journal of the Physical Society of Japan 59 (7) (1990) 2508- 2521. arXiv:https://doi.org/10.1143/JPSJ.59.2508, doi:10.1143/JPSJ.59.2508. URL https://doi.org/10.1143/JPSJ.59.2508   Interactioninduced quantum spin Hall insulator in the organic Dirac electron system α-(BEDT-TSeF) 2 I 3  D  Ohki    K  Yoshimi    A  Kobayashi    10.1103/PhysRevB.105.205123     Phys. Rev. B  105  205123  2022    D. Ohki, K. Yoshimi, A. Kobayashi, Interaction- induced quantum spin Hall insulator in the organic Dirac electron system α-(BEDT-TSeF) 2 I 3 , Phys. Rev. B 105 (2022) 205123. doi:10.1103/PhysRevB.105. 205123. URL https://link.aps.org/doi/10.1103/PhysRevB. 105.205123   Solving the Eliashberg equations by means of N -point Padé approximants  H  J  Vidberg    J  W  Serene    10.1007/BF00655090     Journal of Low Temperature Physics  29  3    1977    H. J. Vidberg, J. W. Serene, Solving the Eliashberg equations by means of N -point Padé approximants, Journal of Low Temperature Physics 29 (3) (1977) 179- 192. doi:10.1007/BF00655090. URL https://doi.org/10.1007/BF00655090   Conserving approximations for strongly fluctuating electron systems. I. Formalism and calculational approach  N  Bickers    D  Scalapino    10.1016/0003-4916(89)90359-X     Annals of Physics  193  1    1989    N. Bickers, D. Scalapino, Conserving approxima- tions for strongly fluctuating electron systems. I. Formalism and calculational approach, Annals of Physics 193 (1) (1989) 206-251. doi:https: //doi.org/10.1016/0003-4916(89)90359-X. URL https://www.sciencedirect.com/science/ article/pii/000349168990359X   Conserving approximations for strongly correlated electron systems: Bethe-Salpeter equation and dynamics for the two-dimensional Hubbard model  N  E  Bickers    D  J  Scalapino    S  R  White    10.1103/PhysRevLett.62.961     Phys. Rev. Lett  62    1989    N. E. Bickers, D. J. Scalapino, S. R. White, Conserving approximations for strongly correlated electron sys- tems: Bethe-Salpeter equation and dynamics for the two-dimensional Hubbard model, Phys. Rev. Lett. 62 (1989) 961-964. doi:10.1103/PhysRevLett.62.961. URL https://link.aps.org/doi/10.1103/ PhysRevLett.62.961   Enhanced spin susceptibility toward the charge-ordering transition in a two-dimensional extended Hubbard model  K  Yoshimi    T  Kato    H  Maebashi    10.1143/JPSJ.78.104002  doi:10.1143/JPSJ.78.104002     Journal of the Physical Society of Japan  78  10  104002  2009    K. Yoshimi, T. Kato, H. Maebashi, Enhanced spin susceptibility toward the charge-ordering transition in a two-dimensional extended Hubbard model, Jour- nal of the Physical Society of Japan 78 (10) (2009) 104002. arXiv:https://doi.org/10.1143/JPSJ.78. 104002, doi:10.1143/JPSJ.78.104002. URL https://doi.org/10.1143/JPSJ.78.104002   Fermi surface deformation near charge-ordering transition  K  Yoshimi    T  Kato    H  Maebashi    10.1143/JPSJ.80.123707  doi:10.1143/JPSJ.80.123707     Journal of the Physical Society of Japan  80  12  123707  2011    K. Yoshimi, T. Kato, H. Maebashi, Fermi surface deformation near charge-ordering transition, Journal of the Physical Society of Japan 80 (12) (2011) 123707. arXiv:https://doi.org/10.1143/JPSJ.80. 123707, doi:10.1143/JPSJ.80.123707. URL https://doi.org/10.1143/JPSJ.80.123707   Coulomb frustrated phase separation in quasi-two-dimensional organic conductors on the verge of charge ordering  K  Yoshimi    H  Maebashi    10.1143/JPSJ.81.063003  doi:10.1143/JPSJ.81.063003     Journal of the Physical Society of Japan  81  6  63003  2012    K. Yoshimi, H. Maebashi, Coulomb frustrated phase separation in quasi-two-dimensional organic conduc- tors on the verge of charge ordering, Journal of the Physical Society of Japan 81 (6) (2012) 063003. arXiv:https://doi.org/10.1143/JPSJ.81. 063003, doi:10.1143/JPSJ.81.063003. URL https://doi.org/10.1143/JPSJ.81.063003   

     