*For correspondence:
lalonso@brandeis.edu
Competing interest: See
page 25
Funding: See page 25
Received: 09 October 2018
Accepted: 29 January 2019
Published: 31 January 2019
Reviewing editor: Frances K
Skinner, Krembil Research
Institute, University Health
Network, Canada
Copyright Alonso and Marder.
This article is distributed under
the terms of the Creative
Commons Attribution License,
which permits unrestricted use
and redistribution provided that
the original author and source are
credited.
Visualization of currents in neural models
with similar behavior and different
conductance densities
Leandro M Alonso*, Eve Marder
Volen Center and Biology Department, Brandeis University, Waltham, United States
Abstract Conductance-based models of neural activity produce large amounts of data that can
be hard to visualize and interpret. We introduce visualization methods to display the dynamics of
the ionic currents and to display the models’ response to perturbations. To visualize the currents’
dynamics, we compute the percent contribution of each current and display them over time using
stacked-area plots. The waveform of the membrane potential and the contribution of each current
change as the models are perturbed. To represent these changes over a range of the perturbation
control parameter, we compute and display the distributions of these waveforms. We illustrate
these procedures in six examples of bursting model neurons with similar activity but that differ as
much as threefold in their conductance densities. These visualization methods provide heuristic
insight into why individual neurons or networks with similar behavior can respond widely differently
to perturbations.
DOI: https://doi.org/10.7554/eLife.42722.001
Introduction
Experimental and computational studies have clearly demonstrated that neurons and circuits with
similar behaviors can, nonetheless, have very different values of the conductances that control intrin-
sic excitability and synaptic strength. Using a model of the crustacean stomatogastric ganglion
(STG), Prinz et al. (2004) showed that similar network activity can arise from widely different sets of
membrane and synaptic conductances. Recent experimental measurements have shown two- to six-
fold variability in individual components in the same identified neurons (Schulz et al., 2006;
Schulz et al., 2007; Roffman et al., 2012; Swensen and Bean, 2005). The use of RNA sequencing
and other molecular measurements have shown significant cell-to-cell variability in the expression of
ion channels (Temporal et al., 2012; Temporal et al., 2014; Tobin et al., 2009). Together these
results suggest that similar activities arise from different cellular and network mechanisms. Here, we
use conductance-based models to explore how different these mechanisms are and how they
respond to perturbation.
Because of the intrinsic variability, canonical models that capture the mean behavior of a set of
observations are not sufficient to address these issues (Golowasch et al., 2002; Balachandar and
Prescott, 2018). To incorporate intrinsic biophysical variability Prinz et al. (2004) introduced an
ensemble modeling approach. They constructed a database with millions of model parameter com-
binations, analyzed their solutions to assess network function, and screened for conductance values
for which the activity resembled the data (Calabrese, 2018). An alternative was used by Achard and
De Schutter (2006). They combined evolutionary strategies with a fitness function based on a
phase-plane analysis of the models’ solutions to find parameters that reproduce complex features in
electrophysiological recordings of neuronal activity, and applied their procedure to obtain 20 very
different computational models of cerebellar Purkinje cells. Here, we adopt a similar approach and
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
1 of 28
TOOLS AND RESOURCES
apply evolutionary techniques to optimize a different family of landscape functions that rely on
thresholds or Poincare´ sections to characterize the models’ solutions.
In some respects, biological systems are a black-box because one cannot read out the values
over time of all their underlying components. In contrast, computational models allow us to inspect
how all the components interact and this can be used to develop intuitions and predictions about
how these systems will respond to perturbations. Despite this, much modeling work focuses on the
variables of the models that are routinely measured in experiments, such as the membrane potential.
While in the models we have access to all state variables, this information can be hard to represent
when many conductances are at play. Similarly, the effect of perturbations – such as the effect of
partially or completely blocking or removing a particular channel – can be complex and also hard to
display in a compact fashion. Here, we address these difficulties and illustrate two novel visualization
methods. We represent the currents in a model neuron using stacked area plots: at each time step,
we display the shared contribution of each current to the total current through the membrane. This
representation is useful to visualize which currents are most important at each instant and allows the
development of insight into how these currents behave when the system is perturbed. Perturbation
typically results in drastic changes of the waveform of the activity and these changes depend on the
kind of perturbation under consideration. Additionally, we developed a novel representation that
relies on computing the probability of VðtÞ, which allows a visualization of these changes. We illus-
trate the utility of these procedures using models of single neuron bursters or oscillators.
Results
Finding parameters: landscape optimization
The numerical exploration of conductance-based models of neurons is a commonplace approach to
address fundamental questions in neuroscience (Dayan and Abbott, 2001). These models can dis-
play much of the phenomenology exhibited by intracellular recordings of single neurons and have
the major advantage that many of their parameters correspond to measurable quantities
(Herz et al., 2006). However, finding parameters for these models so that their solutions resemble
experimental observations is a difficult task. This difficulty arises because the models are nonlinear,
eLife digest The nervous system contains networks of neurons that generate electrical signals to
communicate with each other and the rest of the body. Such electrical signals are due to the flow of
ions into or out of the neurons via proteins known as ion channels. Neurons have many different
kinds of ion channels that only allow specific ions to pass. Therefore, for a neuron to produce an
electrical signal, the activities of several different ion channels need to be coordinated so that they
all open and close at certain times.
Researchers have previously used data collected from various experiments to develop detailed
models of electrical signals in neurons. These models incorporate information about how and when
the ion channels may open and close, and can produce numerical simulations of the different ionic
currents. However, it can be difficult to display the currents and observe how they change when
several different ion channels are involved.
Alonso and Marder used simple mathematical concepts to develop new methods to display ionic
currents in computational models of neurons. These tools use color to capture changes in ionic
currents and provide insights into how the opening and closing of ion channels shape electrical
signals.
The methods developed by Alonso and Marder could be adapted to display the behavior of
biochemical reactions or other topics in biology and may, therefore, be useful to analyze data
generated by computational models of many different types of cells. Additionally, these methods
may potentially be used as educational tools to illustrate the coordinated opening and closing of ion
channels in neurons and other fundamental principles of neuroscience that are otherwise hard to
demonstrate.
DOI: https://doi.org/10.7554/eLife.42722.002
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
2 of 28
Tools and resources
Neuroscience
they have many state variables and they contain a large number of parameters (Bhalla and Bower,
1993). These models are complex, and we are not aware of a general procedure that would allow
the prediction of how an arbitrary perturbation in any of the parameters will affect their solutions.
The problem of finding sets of parameters so that a nonlinear system will display a target behavior is
ubiquitous in the natural sciences. A general approach to this problem consists of optimizing a score
function that compares features of the models’ solutions to a set of target features. Consequently,
landscape-based optimization techniques for finding parameters in compartmental models of neu-
rons have been proposed before (Achard and De Schutter, 2006; Druckmann et al., 2007; Ben-
Shalom et al., 2012). Here, we employ these ideas to develop a family of score functions that are
useful to find parameters so that their activities reach a desired target.
In this work, we started with a well-studied model of neural activity described previously
(Liu et al., 1998; Goldman et al., 2001; Prinz et al., 2004; O’Leary et al., 2014). The neuron is
modeled according to the Hodgkin-Huxley formalism using a single compartment with eight cur-
rents. Following Liu et al. (1998), the neuron has a sodium current, INa; transient and slow calcium
currents, ICaT and ICaS; a transient potassium current, IA; a calcium-dependent potassium current,
IKCa; a delayed rectifier potassium current, IKd; a hyperpolarization-activated inward current, IH; and
a leak current Ileak.
We explored the space of solutions of the model using landscape optimization. The procedure
consists
of
three
steps.
First,
we
generate
voltage
traces
by
integration
of
Equation
5
(Materials and methods). We then score the traces using an objective or landscape function that
defines a target activity. Finally, we attempt to find minima of the objective function. The procedures
used to build objective functions whose minima correspond to sets of conductances that yield the
target activities are shown in Figure 1. Voltage traces were generated by integration of Equation 5
and were then scored according to a set of simple measures. The procedure is efficient in part
because we chose measures that require little computing power and yet are sufficient to build suc-
cessful target functions. For example, we avoid the use of Spike Density Functions (SDF) and Fourier
transforms when estimating burst frequencies and burst durations. In this section, we describe target
-50
0
V [mV]
1 sec
spike detection 
threshold
slow wave 
threshold
bs1
be1
bs2
be2
bs3
be3
A
-50
0
V [mV]
slow wave 
threshold 1
slow wave 
thresholds 2
1 sec
τ1 τ2
τn
τ3
B
spike detection 
threshold
ISI threshold
Figure 1. Landscape optimization can be used to find models with specific sets of features. (A) Example model
bursting neuron. The activity is described by the burst frequency and the burst duration in units of the period (duty
cycle). The spikes detection threshold (red line) is used to determine the spike times. The ISI threshold (cyan) is
used to determine which spikes are bursts starts (bs) and bursts ends (be). The slow wave threshold (blue line) is
used to ensure that slow wave activity is separated from spiking activity. (B) Example model spiking neuron. We
use thresholds as before to measure the frequency and the duty cycle of the cell. The additional slow wave
thresholds (purple) are used to control the waveform during spike repolarization.
DOI: https://doi.org/10.7554/eLife.42722.003
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
3 of 28
Tools and resources
Neuroscience
functions whose minima correspond to bursting and tonic activity in single compartment models.
This approach can also be applied to the case of small circuits of neurons (Prinz et al., 2004).
We begin with the case of bursters (Figure 1A). We targeted this type of activity by measuring
the bursting frequency, the duty cycle, and the number of crossings at a threshold value to ensure
that spiking activity is well separated from slow wave activity. To measure the burst frequency and
duty cycle of a solution, we first compute the time stamps at which the cell spikes. Given the
sequence of values V ¼ fVng we determine that a spike occurs every time that V crosses the spike
detection threshold Tsp ¼  20mV (red in Figure 1). We build a sequence of spike times S ¼ fsig by
going through the sequence of
voltages fVng and keeping the values of n for which
Vn  Tsp and Vnþ1 > Tsp (we consider upward crossings). Each element si of the sequence S contains
the time step at which the i-th spike is detected. Bursts are determined from the sequence of spike
times S; if two spikes happen within a temporal interval shorter than dspt ¼ 100msec they are part of a
burst. Using this criterion we can find which of the spike times in S correspond to the start and end
of bursts. The starts (bs) and ends (be) of bursts are used to estimate the duty cycle and burst fre-
quency. We loop over the sequence of spike times and determine that a burst starts at si if
siþ1   si < dspt and si   si 1 > dspt. After a burst starts, we define the end of the burst at sk if
skþ1   sk > dspt and sk   sk 1 < dspt. When a burst ends we can measure the burst duration as db ¼ sk   si
and since the next burst starts (by definition) at skþ1 we also can measure the ‘period’ (if periodic) of
the oscillation as tb ¼ db þ ðskþ1   skÞ. Every time a burst starts and ends we get an instance of the
burst frequency fb ¼ 1
tb and the duty cycle dc ¼ db
tb. We build distributions of these quantities by loop-
ing over the sequence S and define the burst frequency and duty cycle as the mean values < fb > and
< dc >. Finally, we count downward crossings in the sequence Vn with two slow wave thresholds #sw
(with tsw ¼  50  1mV) and the total number of bursts #b in S.
For any given set of conductances, we simulated the model for 20 s and dropped the first 10 s to
mitigate the effects of transient activity. We then computed the burst frequency < fb >, the duty cycle
< dc >, the number of crossings with the slow wave thresholds #sw and the number of bursts #b. We
discard
unstable
solutions;
a
solution
is
discarded
if
stdðffbgÞ  ð< fb >  0:1Þ
or
stdðfdcgÞ  ð< dc >  0:2Þ. If a solution is not discarded, we can use the following quantities to mea-
sure how close it is to the target behavior,
Ef ¼ ðftg   <fb >iÞ2
Edc ¼ ðdctg   <dc>iÞ2
Esw ¼ ð#sw
2   #bÞ2
(1)
Here, Ef measures the mismatch of the bursting frequency of the model cell with a target fre-
quency ftg and Edc accounts for the duty cycle. Esw measures the difference between the number of
bursts and the number of crossings with the slow wave thresholds tsw ¼  50  1mV. Because we want
a clear separation between slow wave activity and spiking activity, we ask that #sw ¼ #b. Note that if
during a burst V goes below tsw this solution would be penalized (factor 1
2 accounts for using two
slow wave thresholds). Let g denote a set of parameters, we can then define an objective function
EðgÞ ¼ aEf þ bEdc þ gEsw;
(2)
where the weights ða;b;gÞ determine the relative importance of the different sources of penalties. In
this work we used a ¼ 1, b ¼ 100, g ¼ 1, and the penalties Ei were calculated using T ¼ 10 seconds
with dt ¼ 0:1 msecs. The target behavior for bursters was defined by dctg ¼ 0:2 (duty cycle 20%)
(dctg ¼ 0:2) and bursting frequency ftg ¼ 1Hz.
We can use similar procedures to target tonic spiking activity. Note that the procedure we
described previously to determine bursts from the sequence of spike times S is also useful in this
case. If a given spike satisfies the definition of burst start and it also satisfies the definition of burst
end then it is a single spike and the burst duration is zero. Therefore, we compute the bursts and
duty cycles as before and ask that the the target duty cycle is zero.
There are multiple ways to produce tonic spiking in this model and some solutions display very
different slow wave activity. To further restrict the models, we placed a middle threshold at
tmid ¼  35mV and detected downward crossings at this value. We defined Elag as the lag between
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
4 of 28
Tools and resources
Neuroscience
the upward crossings at the spiking threshold (tspk ¼  20mV) and downward crossings at tmid: Elag is
useful because it takes different values for tonic spikers than it does for single-spike bursters even
though their spiking patterns can be identical. Finally, we found that the model attempts to minimize
Elag at the expense of hyperpolarizing the membrane beyond  50mV and introducing a wiggle that
can be different in different solutions. To penalize this we included additional thresholds between
 35mV and  45mV, counted the number of downward crossings at these values #midi, and asked
that these numbers are equal to the number of spikes #s. With these definitions, we define the par-
tial errors as before,
Ef ¼ ðftg   <fb >iÞ2
Edc ¼ ðdctg   <dc>iÞ2
Emid ¼
X
i
ð#midi   #sÞ2
Esw ¼ ð#swÞ2:
(3)
The total error as a function of the conductances reads as follows,
EðgÞ ¼ aEf þ bEdc þ gEmid þ dEsw þ hElag:
(4)
The values a ¼ 1000, b ¼ 1000, g ¼ 100, d ¼ 100 and h ¼ 1, produce solutions that are almost identi-
cal to the one displayed in Figure 1B.
In all cases, evaluation of the objective functions requires that the models are simulated for a
number of seconds and this is the part of the procedure that requires most computing power. Lon-
ger simulations will provide better estimations for the burst frequency and duty cycle of the cells,
but will linearly increase the time it takes to evaluate the objective function. If the simulations are
shorter, evaluations of the objective function are faster but the minimization may be more difficult
due to transient behaviors and its minima may not correspond to stable solutions. In this work, we
minimized the objective function using a standard genetic algorithm (Holland, 1992; Goldberg and
Holland, 1988). The choice of the optimization routine and the choice of the numerical scheme for
the simulations are independent of the functions. See Materials and methods for details on the how
we performed this optimization. The same functions can be utilized to estimate parameters in mod-
els with different channel types.
Visualizing the dynamics of ionic currents: currentscapes
Most modeling work focuses on the variables of the models that are routinely measured in experi-
ments such as the membrane potential as is shown in Figure 2A for a bursting neuron. While in the
models we have access to all state variables, this information can be hard to represent when several
current types are at play. One difficulty is that some currents like Na and Kd vary over several orders
of magnitude, while other currents like the leak and H span smaller ranges. Additionally, the relative
contribution of each current to the total flux through the membrane varies over time. Here, we intro-
duce a novel representation that is simple and permits displaying the dynamics of the currents in a
cohesive fashion.
At any given time stamp, we can compute the total inward and outward currents. We can then
express the values of each current as a percentage of this quantity. The normalized values of the cur-
rents at any time can be displayed as a pie chart representing the share of each current type
(Figure 2B). Because we want to observe how these percentages change in time, we display the
shares in a bar instead of a disk. The currentscapes are constructed by applying this procedure to all
time stamps and stacking the bars. These types of plots are known as stacked area plots and their
application to this problem is novel. Figure 2C shows the currentscape of a periodically bursting
model neuron over one cycle. The shares of each current type to the total inward and outward cur-
rents are displayed in colors, and the total inward and outward currents are represented by the filled
black curves in logarithmic scale in the top and bottom.
Visualizing changes in the waveforms as a parameter is changed
To visualize changes in the activity as a conductance is gradually removed we computed the distribu-
tion of membrane potential V values. This reduction contains information about the waveform of the
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
5 of 28
Tools and resources
Neuroscience
membrane potential, while all temporal information such as frequency can no longer be recovered.
The number of times that a given value of V is sampled is proportional to the time the system
spends at that value. Figure 3A shows the distribution of V for a periodic burster with fb » 1Hz and
dc » 20% sampled from 30 s of simulation. The count is larger than 104 for values between  52mV
and  40mV, and smaller than 103 for V between  35mv and 20mV. The areas of the shaded regions
are proportional to the probability that the system will be observed at the corresponding V range
(Figure 3B). Note that the area of the dark gray region is 105 while the light gray is 0:5  104, so the
probability that the cell is, at any given time, in a hyperpolarized state is more than 20 times larger
than the probability that the cell is spiking.
The distribution of V features sharp peaks. In many cases, the peaks in these distributions corre-
spond to features of the waveform, such as the amplitudes of the individual spikes, or the minimum
membrane potential (see Figure 3—figure supplement 1). This happens because every time the
membrane potential reaches a maxima or minima (in time) the derivative dV
dt is close to zero. The sys-
tem spends more time close to values of V where the velocity dV
dt is small than in regions where dV
dt is
large, as it occurs during the flanks of spikes. Therefore, when we sample a solution at a random
instant, it is more likely that V corresponds to the peak of a spike than to either flank of the spike,
while the most likely outcome is that V is in the hyperpolarized range (<   40mV). In this particular
burster, there are 12 spikes in the burst but there are only 7 peaks in the distribution (between 10mV
and 20mV); some spikes have similar amplitudes so they add to a larger peak in the distribution. The
overall or total amplitude of the oscillation can be read from the distribution since the count of V is
zero outside a range ( 52mV to 20mV). These distributions can also be represented by a graded bar
C
+[nA]
inward %
outward %
-[nA]
500
50
5
500
50
5
A
-50
-20
[mV]
Time
Na
CaT
CaS
A
KCa
Kd
H
L
100 [msec]
T1
T2
B
T1
T2
inward %
outward %
inward %
outward %
Figure 2. Currentscape of a model bursting neuron. A simple visualization of the dynamics of ionic currents in conductance-based model neurons. (A)
Membrane potential of a periodic burster. (B) Percent contribution of each current type to the total inward and outward currents displayed as pie charts
and bars at times T1 and T2 (C) Percent contribution of each current to the total outward and inward currents at each time stamp. The black filled curves
on the top and bottom indicate total inward outward currents respectively on a logarithmic scale. The color curves show the time evolution of each
current as a percentage of the total current at that time. For example, at t ¼ T1 the total outward current is » 2:5nA and the orange shows a large
contribution of KCa. At t ¼ T2 the total outward current has increased to » 4nA and the KCa current is contributing less to the total.
DOI: https://doi.org/10.7554/eLife.42722.004
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
6 of 28
Tools and resources
Neuroscience
CONTROL
100% gNa
85% gNa
80% gNa
60% gNa
30% gNa
0 [mV]
-50 [mV]
V [mV]
Time 100 [msec]
-50
0
-10
-40
-30
-20
10
20
-60
-70
V [mV]
log(count)
1
2
3
4
5
A
CONTROL 100% gNa
CONTROL 100% gNa
-10
-40
20
-70
V [mV]
B
C
3
4
5
1
2
log(#samples)
100%
85%
80%
60%
30%
 100%   
 
      gNa  
       
           0%
0 [mV]
-50 [mV]
0 
-50
Voltage [mV]
100%   gNa   0%
Time 300[msec] 
Time 300[msec] 
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
CONTROL 100% gNa
80% gNa
80% gNa
sharpness (arb. units)
D
Figure 3. Membrane potential V distributions. (A) Distribution of membrane potential V values. The total number of samples is N ¼ 2:2  106. Y-axis
scale is logarithmic. The area of the dark shaded region can be used to estimate of the probability that the activity is sampled between  50mV and
 40mV, and the area of the light shaded region is proportional to the probability that VðtÞ is sampled between  30mV and 20mV. The area of the dark
region is 20 times larger than the light region. (B) The same distribution in (A) represented as a graded bar. (C) Distribution of V as a function of V and
Figure 3 continued on next page
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
7 of 28
Tools and resources
Neuroscience
as shown in Figure 3B. As conductances are gradually removed the waveform of the activity changes
and so does the distribution of V values.
Figure 3C shows how the distribution of V changes as gNa is decreased. The waveforms at a few
values of gNa are shown for reference. For each value in the range (100%gNa to 0%gNa with N ¼ 1001
values) we computed the count pðV; gNaÞ and display log10ðpðV; gNaÞ þ 1Þ in gray scales. In this exam-
ple, the cell remains in a bursting regime up to » 85%gNa and transitions abruptly into a single-spike
bursting mode for further decrements (%80gNa). The spikes produce thin ridges in the distribution
that show how their individual amplitudes change. The colored symbols indicate the correspondence
between features in the waveform and ridges in the distribution. In this example, the peak ampli-
tudes of the spikes are similar for values of gNa greater than %85gNa. After the transition, the ampli-
tudes of the spikes are very different; two spikes go beyond 0mV and the rest accumulate near
 25mV. As gNa ! 0 the oscillations collapse onto a small band at »   20mV and only one spike is
left.
The distributions allow the visualization of the amplitudes of the individual spikes, the slow waves,
and other features as the parameter gNa is changed. To highlight ridges in the distributions, the cen-
ter panel in Figure 3D shows the derivative qVlog10ðpðVÞÞ in color. This operation is similar to per-
forming a Sobel filtering (Sobel and Feldman, 1968) of the image in Figure 3C. The traces on each
side of this panel correspond to the control (left) and 80%gNa conditions. Notice how the amplitudes
of each spike, features of the slow wave, and overall amplitude correspond to features in the proba-
bility distribution. This representation permits displaying how the features of the waveform change
for many values of the perturbation parameter gNa.
The maximal conductances do not fully predict the currentscapes
We explored the solutions of a classic conductance-based model of neural activity using landscape
optimization and found many sets of parameters that produce similar bursting activity. Inspired by
intracellular recording performed in the Pyloric Dilator (PD) neurons in crabs and lobsters we tar-
geted bursters with frequencies fb » 1Hz and duty cycles dc » 20%. We built 1000 bursting model neu-
rons and visually inspected the dynamics of their currents using their currentscapes. Based on this,
we selected six models that display similar membrane activity via different current compositions for
further study. Because the models are nonlinear, the relationship between the dynamics of a given
current type and the value of its maximal conductance is non-trivial. Figure 4 shows the values of
the maximal conductances in the models (top) and their corresponding activity together with their
currentscapes (bottom).
It can be difficult to predict the currentscapes based on the values of the maximal conductances.
In most cases, it appears that the larger the value of the maximal conductance, the larger the contri-
bution of the corresponding current. However, this does not hold in all cases. For example, burster
(f) shows the largest A current contribution, but bursters (c) and (e) have larger values of gA. The
maximal conductance of the CaS current is low in model (f) but the contribution of this current to the
total is similar to that in models (a) and (b). The values of gKCa are similar for bursters (e) and (f) but
the contribution of this current is visibly different in each model.
Response to current injection
The models produce similar activity with different current dynamics. To further reveal differences in
how these activities are generated, we subjected the models to simple perturbations. We begin
describing the response to constant current injections in Figure 5. Figure 5A and Figure 5B show
Figure 3 continued
gNa, and waveforms for several gNa values.The symbols indicate features of the waveforms and their correspondence to the ridges of the distribution of
V. (D) Waveforms under two conditions and their correspondence to the ridges of the distribution of V. The ridges were enhanced by computing the
derivative of the distribution along the V direction.
DOI: https://doi.org/10.7554/eLife.42722.005
The following figure supplement is available for figure 3:
Figure supplement 1. Probability distributions of membrane potential.
DOI: https://doi.org/10.7554/eLife.42722.006
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
8 of 28
Tools and resources
Neuroscience
the membrane potential of model (a) for different values of injected current. In control, the activity
corresponds to regular bursting and larger depolarizing currents result in a plethora of different
regimes. The distributions of inter-spike intervals (ISI) provide a means to characterize these regimes
(Figure 5C). When the cell is bursting regularly such as in control and in the 0:8nA condition, the
interspike interval distributions consist of one large value that corresponds to the interburst interval
(a)
Time [2 τ]
(b)
(c)
(d)
Na
CaT
CaS
A
KCa
Kd
H
L
(f)
(e)
+[nA]
in %
out %
-[nA]
500
50
5
500
505
-50
-20
[mV]
gNa
gCaT
gCaS
gA
gKCa
gKd
gH
gL
Figure 4. Currentscapes of model bursting neurons. (top) Maximal conductances of all model bursters. (bottom) The panels show the membrane
potential of the cell and the percent contribution of each current over two cycles.
DOI: https://doi.org/10.7554/eLife.42722.007
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
9 of 28
Tools and resources
Neuroscience
( » 640msec in control) and several smaller values around 10msec which correspond to the ISI within a
burst. There are values of current for which the activity appears irregular and correspondingly, the
ISI values are more diverse. Figure 5B shows the response of the model to larger depolarizing cur-
rents. The activity undergoes a sequence of interesting transitions that result in tonic spiking. When
Ie ¼ 3:45nA the activity is periodic and there are 4 ISI values. Larger currents result in 2 ISI values and
tonic spiking produces one ISI value. Figure 5C shows the ISI distributions (y-axis, logarithmic scale)
for each value of injected current (x-axis).
All these bursters transition into tonic spiking regimes for depolarizing currents larger than 5nA
but they do so in different ways. To explore these transitions in detail, we computed the inter-spike
interval (ISI) distributions over intervals of 60sec for different values of the injected current. Figure 6
shows the ISI distributions for the six models at N ¼ 1001 equally spaced values of injected current
over the shown range. The y-axis shows the values of all ISIs on a logarithmic scale and the x-axis
corresponds to injected current. In the control, the ISI distribution consists of a few small values
(<100msec) that correspond to the ISIs of spikes within a burst, and a single larger value (>100msec)
that corresponds to the interval between the last spike of a burst and the first spike of the next
burst. When the cell fires tonically the ISI distributions consist of a single value. The ISI distributions
exhibit complicated dependences on the control parameter that result in beautiful patterns. For
some current values, the cells produce small sets of ISI values indicating that the activity is periodic.
However, this activity is quite different across regions. Interspersed with the regions of periodicity
3.45[nA]
0.8[nA]
1.95[nA]
3.75[nA]
4.5[nA]
2.2[nA]
0[nA]
5
injected current [nA]
0
1000[msec]
100[msec]
10[msec]
3.45[nA]
0.8[nA]
1.95[nA]
3.75[nA]
4.5[nA]
2.2[nA]
0[nA]
ISI [msec]
0.8[nA]
1.95[nA]
0[nA] CONTROL
1 [sec]
~640[msec]
3.45[nA]
3.75[nA]
4.5[nA]
2.2[nA]
100 [msec]
A
B
C
-50
-20
V[mV]
-50
-20
V[mV]
Figure 5. Response to current injections and interspike-intervals (ISI) distributions of model (a). (A) (top) Control traces (no current injected 0nA), regular
bursting (0:8nA), irregular bursting 1:95nA. (B) (top) Fast regular bursting (fb » 6Hz), quadruplets (3:45nA), doublets (3:75nA) and singlets (4:5nA) (tonic
spiking). (C) ISI distributions over a range of injected current.
DOI: https://doi.org/10.7554/eLife.42722.008
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
10 of 28
Tools and resources
Neuroscience
there are regions where the ISI distributions densely cover a band of values indicating non-periodic
activity. Overall the patterns feature nested forking structures that are reminiscent of classical period
doubling routes to chaos (Feigenbaum, 1978; Canavier et al., 1990).
Extracting insights from these visualization tools
Detailed conductance-based models show complex and rich behaviors in response to all kinds of
perturbations. There is a vast amount of information that can be seen in these models and their visu-
alizations in Figures 7 - 15. It is entirely impossible for us to point out even a fraction of what can be
seen or learned from these figures. Nonetheless, we will illustrate a few examples of what can be
seen using these methods, knowing that these details will be different for models that are con-
structed in the future and analyzed using these and similar methods.
Perturbing the models with gradual decrements of the maximal
conductances
Figures 7 and 8 show the effects of gradually decreasing each of the currents in these bursters from
100% to 0% for all six models. This type of analysis might be relevant to some kinds of pharmacologi-
cal manipulations or studies of neuromodulators that decrease a given current. The figures show 3 s
of data for each condition. In all panels, the top traces correspond to the control condition (100%)
and the traces below show the activity that results from decreasing the maximal conductance. The
dashed lines are placed for reference at  50mV and 0mV. Each panel shows the traces for 11 values
of the corresponding maximal conductance equally spaced between 100% (control) and 0%
(completely removed). Each row of panels corresponds to a current type and the columns corre-
spond to the different model bursters. Figure 7 displays the perturbations for the inward currents
and Figure 8 shows the outward and leak currents.
Taken together Figures 7 and 8 illustrate that each model (a-f) changes its behavior differently in
response to decreases in each current. Additionally, decreases in some currents have only relatively
small effects but decreases in others have much more profound effects. Because the description of
all that can be seen in these figures is beyond the scope of this paper, we chose to focus on the
effects of decreasing the CaT because it has rich and unexpected behaviors.
5
injected current [nA]
(a)
(b)
(c)
(d)
(e)
(f)
ISI [msec]
-1
ISI [msec]
1000[msec]
100[msec]
10[msec]
1000[msec]
100[msec]
10[msec]
Figure 6. ISI distributions of the six model bursting neurons over a range of injected current. The panels show all
ISI values of each model burster over a range on injected currents (vertical axis is logarithmic). All bursters
transition into tonic spiking regimes for injected currents larger than 5nA and the details of the transitions are
different across models.
DOI: https://doi.org/10.7554/eLife.42722.009
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
11 of 28
Tools and resources
Neuroscience
The effect of decreasing the CaT conductance is quite diverse across models. The activities of the
models at the intermediate values of gCaT shows visible differences. When gCaT ! 0:7gCaT models
(a), (b) and (c) show bursting activity at different frequencies and with different duty cycles. Models
(d), (e) and (f) become tonic spikers at this condition, but their frequencies are different. Note that in
the case of model (e) the spiking activity is not regular and the ISIs take several different values.
When gCaT ! 0:2gCaT most models spike tonically but now (e) is regular and (f) shows doublets.
When CaT is completely removed, most models transition into a tonic spiking regime with the
exception of model (a), that displays a low frequency bursting regime with duty cycle » 0:5.
Gradually removing one current impacts the dynamics of all currents
Decreasing any conductance can trigger qualitative changes in the waveform of the membrane
potential and in the contributions of each current to the activity. In Figure 9 we plot currentscapes
for the effects of decreasing CaT in model (f). This allows us to examine at higher resolution the
0%       Na         100%
0%        CaT          100%
0%        CaS          100%
0%          H           100%
(b)
(c)
(d)
(e)
(f)
(a)
Figure 7. Effects of decreasing maximal conductances: inward currents. The figure shows the membrane potential V of all model cells as the maximal
conductance gi of each current is gradually decreased from 100% to 0% . Each panel shows 11 traces with a duration of 3 s. Dashed lines are placed at
0mV and  50mV. The shading indicates values of maximal conductance for which the activity the models differs the most.
DOI: https://doi.org/10.7554/eLife.42722.010
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
12 of 28
Tools and resources
Neuroscience
changed contributions of currents that give rise to the interesting dynamics seen in Figure 7. Each
panel in Figure 9 corresponds to a different decrement value and shows the membrane potential on
top, and the currentscapes at the bottom. The top panels show 1 second of data and correspond to
the 100%gCaT (control), 90%gCaT and 80%gCaT conditions. The center panels show 0:1 s of data for
decrements ranging from 70% to 20% and the bottom panels show 2 s for the 10% and 0% condi-
tions. As CaT is gradually removed the activity transitions from a bursting regime to a tonic spiking
regime.
When gCaT ! 90%gCaT the neuron produces bursts but these become irregular and their dura-
tions change. Decreasing the conductance to 80%gCaT results in completely different activity. The
spiking pattern appears to be periodic but there are at least three different ISI values. It is hard to
see changes in the CaT contribution across these conditions, but changes in other currents are more
discernible. The contribution of the A current that is large in the control and 90%gCaT conditions, is
much smaller in the 80%gCaT condition. Additionally, the Na and KCa currents show larger
(b)
(c)
(d)
(e)
(f)
(a)
0%          A         100%
0%        KCa          100%
0%          Kd          100%
0%        LEAK       100%
Figure 8. Effects of decreasing maximal conductances: outward currents. The figure shows the membrane potential V of all model cells as the maximal
conductance gi of each current is gradually decreased from 100% to 0%. Each panel shows 11 traces with a duration of 3 s. Dashed lines are placed at
0mV and  50mV. The shading indicates values of maximal conductance for which the activity the models differs the most.
DOI: https://doi.org/10.7554/eLife.42722.011
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
13 of 28
Tools and resources
Neuroscience
+[nA]
inward % outward %
-[nA]
500
50
5
500
50
5
-50
-20
[mV]
100% gCaT
90% gCaT
80% gCaT
70% gCaT
60% gCaT
50% gCaT
40% gCaT
30% gCaT
20% gCaT
Na
CaT
CaS
A
KCa
Kd
H
L
10% gCaT
0% gCaT
2 [sec]
100[msec]
1 [sec]
(f)
(f)
(f)
Figure 9. Decreasing CaT in model (f). The figure shows the traces and the currentscapes of model (f) as CaT is gradually decreased. Top panels show
1 second of data, center panels show 0:1 seconds and the bottom panels show 2 seconds (see full traces in Figure 8).
DOI: https://doi.org/10.7554/eLife.42722.012
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
14 of 28
Tools and resources
Neuroscience
contributions, the CaS current contributes less and the H current is negligible. Further increments in
simulated blocker concentration result in tonic spiking regimes with frequencies ranging from » 20Hz
to » 10Hz. The center panels in Figure 9 show the currentscapes for these conditions on a different
time scale to highlight the contributions of CaT. The leftmost panel shows the 70%gCaT condition. In
this panel, we placed vertical lines indicating the time stamps at which the peak of the spike and the
minimum occur. Notice the large contribution of the Na current prior to the peak of the spike, and
the large contribution of the Kd current for the next » 10msec. When the membrane potential is at its
minimum value the CaT current dominates the inward currents and remains the largest contributor
for the next » 10msec. The CaT current reduces its share drastically by the time the Na current is visi-
ble and CaS takes over. The contribution of CaT remains approximately constant during repolariza-
tion and vanishes as the membrane becomes depolarized and the Na current becomes dominant.
The effect of removing CaT is visible on this scale. The waveform of the contribution remains qualita-
tively the same: largest at the minimum voltage and approximately constant until the next spike.
However, the contribution of CaT during repolarization becomes smaller, and for larger conductance
decrements results in a thinner band. Finally, the bottom panels show the cases 10%gCaT and
0%gCaT which correspond to a two-spike burster and a tonic spiker, respectively. Note that even
though the contribution of CaT is barely visible, complete removal of this current results in a very dif-
ferent pattern. The activity switched from bursting to spiking and the current composition is differ-
ent; KCa disappeared in the 0% condition and the A current takes over. Notice also the larger
contribution of the H current.
Modeling current deletions
There has been a great deal of work studying the effects of genetic and/or pharmacological dele-
tions of currents. One of the puzzles is why some currents, known to be physiologically important,
can have relatively little phenotype in some, or all individuals. For this reason in Figures 10 and
11, we show the effects of deletion of each current in all six models. Each panel shows 2 seconds of
Figure 10. Complete removal of one current: inward currents. The figure shows the traces and currentscapes for all bursters when one current is
completely removed.
DOI: https://doi.org/10.7554/eLife.42722.013
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
15 of 28
Tools and resources
Neuroscience
data. The inward currents are portrayed in Figure 10 and the outward and leak currents are shown
in Figure 11.
Removal of some currents has little obvious phenotype differences across the population
although the currentscapes are different, such as seen for the gNa and gCaS cases. Removal of some
currents produces similar phenotypes in most, but not all of the six models as seen in the gH and gA
cases. Removal of Kd had virtually identical effects both on the phenotype and the currents. For
other currents, such as KCa and the Leak, we find two types of responses with nearly half of the mod-
els for each case (the exception is model (d) Leak). In the case of the CaT current both the phenotype
and the currents composition are very diverse across models.
Changes in waveform as conductances are gradually decreased
A fuller description of the behavior/phenotype of all of the models for all values of conductance dec-
rements can be seen in Figures 12 and 13. These figures use the probability scheme described in
Figure 3 and Figure 3—figure supplement 1. Using these methods, it is possible to see exactly
how the waveforms change and the boundaries of activity for each model and each conductance.
The panels show the ridges of the probability distributions pðVÞ of the membrane potential VðtÞ for
1001 values of maximal conductance values (see Materials and methods). The probability of VðtÞ was
computed using 30 s of data after dropping a transient period of 120 s. It was estimated using
Nb ¼ 1001 bins in the range ð 70; 35Þmv and N » 2  106 samples for each maximal conductance
value. The system spends more time in regions where dV
dt » 0 and is sampled more at those values.
Therefore, features such as the amplitudes of the spikes appear as sharp peaks in the probability dis-
tributions. To highlight these peaks and visualize how they change as currents are gradually
decreased, we plot the derivative or sharpness of the distribution in colors (see color scale in
Figure 3D). Overall, these plots show that for any given current, there are ranges of the conduc-
tance values where a small change results in a smooth deformation of the waveform, and there are
specific values at which abrupt transitions take place. As before there is too much detail to describe
Figure 11. Complete removal of one current: outward currents. The figure shows the traces and currentscapes for all bursters when one current is
completely removed.
DOI: https://doi.org/10.7554/eLife.42722.014
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
16 of 28
Tools and resources
Neuroscience
everything in these figures so we will discuss a subset of the features highlighted by this
representation.
The top rows in Figure 12 correspond to removing the Na current in the models. Note that the
minimum value of V in control (left) is close to  50mV and a small decrement in gNa results in larger
amplitude. The colored curves inside the envelopes correspond to the spikes’ amplitudes and fea-
tures of the slow waves. For instance, when the Na current is completely removed (right) the ampli-
tude of the oscillation is » 40mV and the activity corresponds to a single-spike bursting mode. The
spike amplitude is given by the top edge of the colored region and the curve near »   20mV indi-
cates the burst ‘belly’: the membrane hyperpolarizes slowly after spike termination and there is a
wiggle at this transition.
(b)
(c)
(d)
(e)
(f)
(a)
Na
CaT
CaS
H
100%    gi     0%
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
Figure 12. Changes in waveform as currents are gradually removed. Inward currents. The figure shows the ridges of the probability distribution of VðtÞ
as a function of V and each maximal conductance pðV; giÞ. The ridges of the probability distributions appear as curves and correspond to values of V
where the system spends more time, such as extrema. The panels show how different features of the waveform such as total amplitude, and the
amplitude of each spike, change as each current is gradually decreased.
DOI: https://doi.org/10.7554/eLife.42722.015
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
17 of 28
Tools and resources
Neuroscience
Removing CaT in model (a) does not disrupt bursting activity immediately. Notice that the ampli-
tude of the bursts remains approximately constant over a range of gCaT values. The dim red and yel-
low lines at » 20mV show that the amplitudes of the spikes are different and have different
dependences with gCaT. When the model transitions into a tonic spiking regime, the amplitude of
the spikes is the same and there is only one amplitude value. This value stays constant over a range
but the minimum membrane potential decreases and the overall amplitude therefore increases. The
model returns to a bursting regime for values of gCaT smaller than 30%gCaT. Notice that in model
(a) the membrane potential during bursts goes below  50mV, unlike in the control condition. Notice
that the waveform of the membrane potential changes abruptly as gCaT is reduced and the models
transition into a spiking regime. Model (f) is less resilient to this perturbation and this transition takes
place at lower conductance values.
(b)
(c)
(d)
(e)
(f)
(a)
A
KCa
Kd
Leak
100%    gi     0%
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
0 [mV]
-50 [mV]
Figure 13. Changes in waveform as currents are gradually removed. Outward and leak currents. The figure shows the ridges of the probability
distribution of VðtÞ as a function of V and each maximal conductance pðV; giÞ. See Figure 12.
DOI: https://doi.org/10.7554/eLife.42722.016
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
18 of 28
Tools and resources
Neuroscience
Removing CaS does not much change the waveform, but it alters the temporal properties of the
activity. The models remain bursting up to a critical value and the amplitude of the spikes was
changed little. The features of the slow wave do not much change either except in model (f). Model
(c) is less resilient to this perturbation since it becomes quiescent for lower decrements of the maxi-
mal conductance than the other models. The effect of gradually removing H appears similar to CaS
in this representation. In this case again, the morphology of the waveform is less altered than its
temporal properties (except in model (e) where a transition takes place).
Figure 13 shows the same plots for the outward and leak currents. The A current in model (a) is
very small (gA » 10S) and its removal has little effect on the activity. This translates into curves that
appear as parallel lines indicating spikes with different amplitudes that remain unchanged. The rest
of the models exhibit a transition into a different regime. The waveforms of this regime appears sim-
ilar to the waveforms which result from removing gNa (see Figure 7) but in this representation it is
easier to observe differences such as the overall amplitude of the oscillation. The amplitude
decreases as gNa is decreased and increases as gA is decreased. Removing KCa has a similar effect
to removing gCaT in that the models transition into tonic spiking regimes. The difference is that the
spiking regimes that result from removing KCa have smaller amplitudes and also correspond to
more depolarized states.
All models are very sensitive to removing Kd and low values result in single-spike bursting modes
with large amplitudes. Model (c) is least fragile to this perturbation and exhibits a visible range
( ~ 100% to ~ 90%) with bursting modes. These oscillations break down in a similar way to the Na
case and display similar patterns. However, an important difference is that unlike in the gNa case,
the overall amplitude of the oscillation increases as gKd is decreased. As before, the top edge corre-
sponds to the amplitude of the large spike and the curves in the colored region correspond to
extrema of the oscillation. After spiking, the membrane remains at a constant depolarized value
( »   20mV) for a long period and produces a high-frequency oscillation before hyperpolarization.
The amplitude of this oscillation increases as Kd is further decreased, and this results in a white curve
that starts above 0mV and ends above 0mV. The beginning of this curve corresponds to a high-fre-
quency oscillation that occurs after spike termination. This type of activity is termed plateau oscilla-
tions and was reported in models of leech heart interneurons (Cymbalyuk and Calabrese, 2000)
and in experiments in lamprey spinal neurons (Wang et al., 2014). These features are hardly visible
in the traces in Figure 8 and are highlighted by this representation. Finally, the Leak case appears
similar to mixture of the Na and A cases. The cells remain bursting over a range of values and some
of them transition into a single-spike bursting mode that is different from the KCa case.
Na
CaT
CaS
 H
 A
KCa
Kd
CaT
0          share [%]         100
100%  gCaT  0% 100%  gCaT  0% 100%  gCaT  0% 100%  gCaT  0% 100%  gCaT  0% 100%  gCaT  0% 100%  gCaT  0%
75%
50%
25%
*
3
4
5
1
2
log(#samples)
Figure 14. Changes in waveform of current shares as one current is gradually decreased. The panels show the probability distribution of the share of
each current ^CiðtÞ for model (f) as CaT is decreased (see Figure 14—figure supplement 1).
DOI: https://doi.org/10.7554/eLife.42722.017
The following figure supplement is available for figure 14:
Figure supplement 1. Probability distributions of currents shares.
DOI: https://doi.org/10.7554/eLife.42722.018
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
19 of 28
Tools and resources
Neuroscience
Changes in current contributions as conductances are gradually
decreased
The key to the visualization method in Figures 12 and 13 is to consider VðtÞ not as a time series but
as a stochastic variable with a probability distribution (see Figure 3 and supplement). The same pro-
cedure can be applied to the time series of each current. However, because the contributions of the
currents are different at different times, and at different decrements of conductance values, it is not
possible to display this information using the same scale for all channels. To overcome this, we pro-
ceed as in the currentscapes and instead focus on the normalized currents or shares to the total
Na
CaT
CaS
 H
 A
KCa
Kd
  Leak  
Na
CaT
CaS
 H
 A
KCa
Kd
  Leak  
0  share[%]  100
100%  gi  0%
3
4
5
1
2
log(#samples)
75%
50%
25%
*
75%
50%
25%
*
75%
50%
25%
*
75%
50%
25%
*
75%
50%
25%
*
75%
50%
25%
*
75%
50%
25%
*
75%
50%
25%
*
Figure 15. Changes in waveform of current shares as each current is gradually decreased. The panels show the probability distribution of the share of
each current ^CiðtÞ for model (c) as each current is decreased.
DOI: https://doi.org/10.7554/eLife.42722.019
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
20 of 28
Tools and resources
Neuroscience
inward and outward currents (the rows of matrices ^Cþ and ^C , see Materials and methods). The cur-
rent shares ^CiðtÞ correspond to the width of the color bands in the currentscapes and can also be
represented by a time series that is normalized to the interval ½0; 1. The probability distribution of
^CiðtÞ permits displaying changes in the contributions of each current to the activity as one current is
gradually removed. Interpreting these distributions is straightforward as before: the number of times
the system is sampled in a given current share configuration is proportional to the time the system
spends there. The aim of plotting these distributions is to visualize how the currentscapes would
change for all values of the conductance decrement. To illustrate this procedure, we return to CaT
to explore further the causes of the complex behavior of model (f) (see Figure 9).
Figure 14 shows the probability distributions of the current shares as CaT is gradually decreased
in model (f) (see also Figure 9 and Figure 14—figure supplement 1). The panels show the share of
each current as CaT is gradually decreased and the probability is indicated in colors. In control the
Na and CaT current shares are distributed in a similar way. Both currents can at times be responsible
for » 90% of the inward current, but most of the time they contribute » 20%. The Na current is larger
right before spike repolarization and the CaT amounts to » 90% of the small ( » 5nA) total inward cur-
rent. For larger decrements, the system transitions into tonic spiking and the contribution of the Na
current is more evenly distributed over a wider range. The contribution of the CaT current is pre-
dominantly » 15% and trends to zero as gCaT ! 0. Note also that as the contribution of CaT
decreases, the contribution of CaS increases to values larger than 75% while in control it contributes
with » 50%. The contribution of the H current is small ( 25%) between 100%gCaT and » 80%gCaT; it
becomes negligible between » 80%gCaT and » 20%gCaT and becomes dominant after 20%gCaT.
The A current behaves similarly to the H. It contributes » 90% of the (small » 2nA) total outward cur-
rent before burst initiation and its contribution decreases drastically when the system transitions into
tonic spiking. As CaT is removed further the A current is more likely to contribute with a larger share.
The contribution of the KCa current decreases as gCaT is decreased and some of it persists even
when gCaT is completely removed. In contrast, the contribution of the Kd current does not appear
to change much and nor does its role in the activity.
Performing the same analysis for all conductances results in a large amount of information.
Despite this and because we are plotting the normalized currents or current shares, our representa-
tion allows us to display this information in a coherent fashion. As an example, in Figure 15 we show
the effect of gradually decreasing each current on all the currents in model (c). The rows indicate
which conductance is decreased and the columns show the effect of this perturbation on the corre-
sponding current. The first row shows how the shares of each current change as the Na current is
decreased. For instance, the effect of decreasing gNa on the Na current (indicated by *) is as
expected, with the maxima of the distribution trending to zero as gNa ! 0. The effect of removing
gNa on the other currents is non-trivial and is displayed along the same row. Notice that while the
effect of removing a current on that same current (diagonal panels) is relatively predictable, the rest
of the currents become rearranged in complicated ways.
Again, a full description of these diagrams is beyond the scope of this work so we will only make
some observations. When the pertubations are negligible or weak (100% to » 90%) all currents play a
role because there are periods of time in which they contribute to at least » 20% of the total current.
There are ranges of the conductances over which small changes result in smooth transformations of
the current configuration, there are specific values at which sharp transitions take place, and these
values are different depending on the current that is decreased. While some of this information can
also be extracted from Figures 12 and 13, the diagrams in Figure 15 show how the currents get
reorganized at these transitions. In addition, this arrangement is convenient for comparing the effect
of decreasing each conductance on a given current. For example, the contributions of the Na and Kd
currents change little for most perturbations (except when these conductances are decreased). In
contrast, the contributions of CaT, CaS, H, KCa, and the leak change more noticeably. Finally, the
contribution of the A current increases for most conductance decrements of any type, except at the
transition values where it can grow or shrink in an abrupt manner.
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
21 of 28
Tools and resources
Neuroscience
Discussion
There is an ever larger availability of experimental data to inform detailed models of identified neu-
ron types (McDougal et al., 2017). Experimenters have determined the kinetics of many channel
types, both in vertebrate and invertebrate neurons. There are also model databases with thousands
of parameters which permit the development of large scale models of neural tissue (Bezaire et al.,
2016). One difficulty in ensemble modeling is the necessity of incorporating the biological variability
observed in some of the parameters – such as the conductances – at the same time that we require
the models to capture some target activity. In other words, we may be interested in modeling a type
of cell that displays some sterotypical behavior, and would like to obtain many different versions of
such models. Two main approaches to this problem were introduced in the past. One consists of
building a database of model solutions over a search domain and screening for target solutions: this
considers all possible value combinations within an allowed range up to a numerical resolution and
then applies quantitative criteria to determine which solutions correspond to the target activity
(Prinz et al., 2004). An alternative approach consists of designing a target function that assigns a
score to the models’ solutions in such a way that lower scores correspond to solutions that meet the
targets, and then optimizing these functions (Achard and De Schutter, 2006; Druckmann et al.,
2007; Ben-Shalom et al., 2012).
Both approaches have advantages and shortcomings. In the case of the database approach, try-
ing all posible parameter combinations in a search range becomes prohibitively expensive as more
parameters are allowed to vary. One advantage of this approach is that it provides a notion of how
likely it is to find conductances within a search range that will produce the activity. In the landscape
approach, we find solutions by optimization and – without further analysis – we do not know how
likely a given solution type is. This approach has the advantage that it can be scaled to include large
numbers of parameters. Additionally, if a particular solution is interesting, we can use genetic algo-
rithms on successful target functions to ‘breed’ as many closely related models as desired. Ulti-
mately, any optimization heuristic requires blind testing random combinations of the parameters,
and developing quantitative criteria for screening solutions in a database results in some sort of
score function, so the two approaches are complementary. A successful target function can deter-
mine if a random perturbation results in disruption of the activity and this can be used to perform
population-based sensitivity analyses (Devenyi and Sobie, 2016).
Regardless of the optimization approach, most work is devoted to the design of successful target
functions. Different modeling problems require different target functions (Roemschied et al., 2014;
Fox et al., 2017; Migliore et al., 2018) and one challenge in their design is that sometimes we do
not know a priori if the model contains solutions that will produce good minima. In addition, a poorly
constrained target function can feature multiple local minima that could make the optimization
harder, so even if there are good minima they may be hard to find. One difference between the
landscape functions in Achard and De Schutter (2006) and the ones utilized here is that in their
setup model solutions are compared to a target time series via a phase-plane method. The functions
introduced in this work use an analysis based on Poincare´ sections or thresholds to characterize the
waveform and to define an error or score. Instead of targeting a particular waveform, we ask that
some features of the waveform – such as the frequency and the burst duration – are tightly con-
strained, while other features – such as the concavity of the slow waves – can be diverse. This is moti-
vated by the fact that across individuals and species, the activity of the pyloric neurons can be
diverse but the neurons always fire in the same sequence and the burst durations have a well-
defined mean. Our approach is successful in finding hundreds of models that display a target activity
in minutes using a commercially available desktop computer. Application of evolutionary techniques
to optimize these functions provides a natural means to model the intrinsic variability observed in
biological populations.
One of the main benefits of computational modeling is that once a behavior of interest is success-
fully captured we then possess a mechanistic description of the phenomena that can be used to test
ideas and inform experiments (Coggan et al., 2011; Lee et al., 2016; Devenyi and Sobie, 2016;
Gong and Sobie, 2018). As the models gain biophysical detail these advantages wane in the face of
the complexity imposed by larger numbers of variables and parameters. Conductance-based models
of neural activity generate large amounts of data that can be hard to visualize and interpret. The
development of novel visualization procedures has the potential to assist intuition into the details of
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
22 of 28
Tools and resources
Neuroscience
how these models work (Gutierrez et al., 2013). Here, we introduced a novel representation of the
dynamics of the ionic currents in a single compartment neuron. Our representation is simple and dis-
plays in a concise way the contribution of each current to the activity. This representation is easily
generalizable to multi-compartment models and small networks, and to any type of electrically excit-
able cell, such as models of cardiac cells (Britton et al., 2017).
We employed these procedures to build many similar bursting models with different conductance
densities and to study their response to perturbations. The responses of the models to current injec-
tions and gradual decrements of their conductances can be diverse and complex. Inspection of the
ISI distributions revealed wide ranges of parameter values for which the activity appears irregular,
and similar regimes can be attained by gradually removing some of the currents. Period doubling
routes to chaos in neurons have been observed experimentally and in conductance-based models
(Hayashi et al., 1982; Hayashi and Ishizuka, 1992; Szu¨cs et al., 2001; Canavier et al., 1990;
Xu et al., 2017). The sort of bifurcation diagrams displayed by these models upon current injection
are qualitatively similar to those exhibited by simplified models of spiking neurons for which further
theoretical insight is possible (Touboul and Brette, 2008). Period doubling bifurcations and low
dimensional chaos arise repeatedly in neural models of different natures including rate models
(Ermentrout, 1984; Alonso, 2017). The bursters studied here are close (in parameter space) to ape-
riodic or irregular regimes suggesting that such regimes are ubiquitous and not special cases.
We showed that in these model neurons similar membrane activities can be attained by multiple
mechanisms that correspond to different current compositions. Because the dynamical mechanisms
driving the activity are different in different models, perturbations can result in qualitatively different
scenarios. Our visualization methods allow us to gather intuition on how different these responses
can be and to explore the contribution of each current type to the neural activity. Even in the case of
single compartment bursters, the response to perturbations of a population can be diverse and hard
to describe. To gain intuition into the kind of behaviors the models display upon perturbation, we
developed a representation based on the probability of the membrane potential V. This representa-
tion permits displaying changes in the waveform of V as each current is blocked. This representation
shows that the models respond to perturbations in different ways, but that there are also similarities
among their responses. A concise representation of the effect of a perturbation is a necessary step
towards developing a classification scheme for the responses.
Materials and methods
Numerical data and data analysis and plotting code, sufficient to reproduce the figures in the paper
are available on Dryad Digital Repository (https://dx.doi.org/10.5061/dryad.d0779mb).
Model equations
The membrane potential V of a cell containing N channels and membrane capacitance C is given by:
CdV
dt ¼ Ie  X
8
i¼1
Ii:
(5)
Each term in the sum corresponds to a current Ii ¼ gimpihqiðV   EiÞ and Ie is externally applied cur-
rent. The maximal conductance of each channel is given by gi, m and h are the activation and inacti-
vation variables, the integers pi and qi are the number of gates in each channel, and Ei is the reversal
potential of the ion associated with the i-th current. The reversal potential of the Na, K, H and leak
currents were kept fixed at ENa ¼ 30mV, EK ¼  80mV, EH ¼  20mV and Eleak ¼  50mV while the cal-
cium reversal potential ECa was computed dynamically using the Nernst equation assuming an extra-
cellular calcium concentration of 3  103M. The kinetic equations describing the seven voltage-
gated conductances were modeled as in Liu et al. (1998),
tmiðVÞdmi
dt ¼ m¥iðVÞ   mi
thiðVÞdhi
dt ¼ h¥iðVÞ   hi:
(6)
The functions tmiðVÞ, m¥iðVÞ, thiðVÞ and h¥iðVÞ are based on the experimental work of
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
23 of 28
Tools and resources
Neuroscience
Turrigiano et al., 1995 and are listed in refs. (Liu et al., 1998; Turrigiano et al., 1995). The activa-
tion functions of the KCa current require a measure of the internal calcium concentration
½Caþ2 (Liu et al., 1998). This is an important state variable of the cell and its dynamics are given by,
tCa
d½Caþ2
dt
¼  CaFðICaT þ ICaSÞ   ½Caþ2 þ Ca0:
(7)
Here, CaF ¼ 0:94 M
nA is a current-to-concentration factor and Ca0 ¼ 0:05M. These values were
originally taken from Liu et al. and were kept fixed. Finally, C ¼ 10nF. The number of state variables
or dimension of the model is 13. We explored the solutions of this model in a range of values of the
maximal conductances and calcium buffering time scales. The units for voltage are mV, the conduc-
tances are expressed in S and currents in nA. Voltage traces were obtained by numerical integration
of
Equation
5
using
a
Runge-Kutta
order
4
(RK4)
method
with
a
time
step
of
dt ¼ 0:1msec (Press et al., 1988). We used the same set of initial conditions for all simulations in this
work V ¼  51mV, m;hi ¼ 0 and ½Caþ2 ¼ 5M. For some values of the parameters, the system (Equa-
tion 5) can display multistability (Cymbalyuk et al., 2002; Shilnikov et al., 2005).
Optimization of target function
Optimization of the objective function Equation 2 is useful to produce sets of parameters g that
result in bursting regimes. In this work, the optimization was performed over a search space of
allowed
values
listed
here:
we
searched
for
gNa 2 ½0; 2  103
([S]),
gCaT 2 ½0; 2  102,
gCaS 2 ½0; 2  102,
gA 2 2  ½0; 102,
gKCa 2 ½0; 2  103,
gKd 2 ½0; 2  102,
gH 2 ½0; 2  102,
gL 2 ½0; 2  10, tCa 2 ½0; 103 ([msecs]). We minimized the objective function using a standard genetic
algorithm Holland (1992). This is optimization technique is useful to produce large pools of
different solutions and is routinely utilized to estimate parameters in biophysical models (see for
example Assaneo and Trevisan, 2010). The algorithm was started with a population of 1000 random
seeds that were evolved for » 10000 generations. The mutation rate was 5%. Fitter individuals were
chosen more often to breed new solutions (elitism parameter was 1:2 with 1 corresponding to equal
breeding probability). The computation was performed on a multicore desktop computer (32
threads) and takes about » 1 hr to produce good solutions.
Currentscapes
The currentscapes are stacked area plots of the normalized currents. Although it is easy to describe
their meaning, a precise mathematical definition of the images in Figure 2 can appear daunting in a
first glance. Fortunately, the implementation of this procedure results in simple python code.
The time series of the 8 currents can be represented by a matrix C with 8 rows and nsecs  1
dt ¼ N
columns. For simplicity, we give a formal definition of the currentscapes for positive currents. The
definition is identical for both current signs and is applied independently for each. We construct a
matrix of positive currents Cþ by setting all negative elements of C to zero, Cþ
i; j ¼ Ci; j j Ci; j > 0 and
Cþ
i;j ¼ 0 j Ci;j  0. Summing Cþ over rows results in a normalization vector nþ with N elements
Table 1. Parameters used in this study and error value.
gNa
gCaT
gCaS
gA
gKCa
gKd
gH
gL
tCa
EðgÞ
model (a)
1076.392
6.4056
10.048
8.0384
17.584
124.0928
0.11304
0.17584
653.5
0.051
model (b)
1165.568
6.6568
9.5456
54.5104
16.328
110.7792
0.0628
0.10676
813.88
0.053
model (c)
1228.368
7.0336
11.0528
117.5616
16.328
111.2816
0.13816
0.10676
605.98
0.027
model (d)
1203.248
6.6568
10.5504
59.5344
16.328
111.4072
0.0
0.10676
653.5
0.471
model (e)
1210.784
8.164
6.28
113.04
12.56
118.4408
0.1256
0.0314
393.13
0.109
model (f)
1245.952
7.7872
6.7824
84.6544
12.56
113.9192
0.02512
0.0
174.34
0.047
model (Figure 2)
1228.368
7.0336
11.0528
117.5616
16.328
110.7792
0.13816
0.10048
605.98
0.007
model (Figure 3)
895.528
3.8936
16.5792
116.4312
21.352
115.6776
0.0
0.08792
828.73
0.058
DOI: https://doi.org/10.7554/eLife.42722.020
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
24 of 28
Tools and resources
Neuroscience
nþ
j ¼ P
i Cþ
i;j. The normalized positive currents can be obtained as ^Cþ ¼ Cþ=nþ (element by element
or entry-wise product). Matrix ^Cþ is hard to visualize as it is. The columns of ^Cþ correspond to the
shares of each positive current and can be displayed as pie charts (see Figure 2). Here, instead of
mapping the shares to a pie we map them to a segmented vertical ‘churro’. The currentscapes are
generated by constructing a new matrix CS whose number of rows is given by a resolution factor
R ¼ 2000, and the same number of columns N as C. Each column j of ^Cþ produces one column j of
CS. Introducing the auxiliary variable pi;j ¼ ^Cþ
i;j  R we can define the currentscape as,
CSi;j ¼ k j
X
k
m
pm;j  i<pkþ1;j þ
X
k
m
pm;j:
(8)
The current types are indexed by k 2 ½0;7 and we assume Pk¼0
m
pm;j ¼ 0. The black filled curve in
Figure 2B corresponds to the normalization vector nþ plotted in logarithmic scale. We placed dot-
ted lines at 5nA, 50nA and 500nA for reference throughout this work. The currentscapes for the nega-
tive currents are obtained by applying definition (Equation 8) to a matrix of negative C  currents
defined in an analogous way as Cþ. Finally, note that matrices ^Cþ and ^C  are difficult to visualize as
they are. The transformation given by definition (Equation 8) is useful to display their contents.
ISI distributions
We inspected the effects of injecting currents in our models by computing the inter-spike interval ISI
distributions. For this, we started the models from the same initial condition and simulated them for
580 s. We dropped the first 240 s to remove transient activity and kept the last 240 s for analysis.
Spikes were detected as described before. We collected ISI values for N ¼ 1001 values of injected
current equally spaced between  1nA and 5nA.
V distributions
To sample the distributions of V
we simulated the system with high temporal resolution
(dt ¼ 0:001msec ) for 30 s, after dropping the first 120 s to remove transients. We then sampled the
numerical solution at random time stamps and kept 2  106 samples V ¼ fVig for each percent value.
We took 1001 values between 1 and 0.
Parameters
Model parameters used in this study are listed in Table 1.
Acknowledgements
LMA acknowledges Marcos Trevisan for early discussions on genetic algorithms and Francisco Roslan
for programming training.
Additional information
Competing interests
Eve Marder: Senior editor, eLife. The other author declares that no competing interests exist.
Funding
Funder
Grant reference number
Author
National Institutes of Health
R35 NS097343
Eve Marder
Swartz Foundation
2017
Leandro M Alonso
National Institutes of Health
MH046742
Eve Marder
National Institutes of Health
T32 NS07292
Leandro M Alonso
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
25 of 28
Tools and resources
Neuroscience
The funders had no role in study design, data collection and interpretation, or the
decision to submit the work for publication.
Author contributions
Leandro M Alonso, Software, Formal analysis, Investigation, Visualization, Writing—original draft,
Writing—review and editing; Eve Marder, Conceptualization, Resources, Supervision, Visualization,
Writing—review and editing
Author ORCIDs
Leandro M Alonso
https://orcid.org/0000-0001-8211-2855
Eve Marder
https://orcid.org/0000-0001-9632-5448
Decision letter and Author response
Decision letter https://doi.org/10.7554/eLife.42722.025
Author response https://doi.org/10.7554/eLife.42722.026
Additional files
Supplementary files
. Transparent reporting form
DOI: https://doi.org/10.7554/eLife.42722.021
Data availability
All data generated or analysed during this study are included in the manuscript and supporting files.
Source data files have been provided for Figures 2 through 15. Data package available in Dryad:
doi:10.5061/dryad.d0779mb.
The following dataset was generated:
Author(s)
Year Dataset title
Dataset URL
Database and
Identifier
Alonso LM, Marder
E
2019
Data from: Visualization of currents
in neural models with similar
behavior and different conductance
densities
https://dx.doi.org/10.
5061/dryad.d0779mb
Dryad Digital
Repository, 10.5061/
dryad.d0779mb
References
Achard P, De Schutter E. 2006. Complex parameter landscape for a complex neuron model. PLOS
Computational Biology 2:e94. DOI: https://doi.org/10.1371/journal.pcbi.0020094, PMID: 16848639
Alonso LM. 2017. Nonlinear resonances and multi-stability in simple neural circuits. Chaos: An Interdisciplinary
Journal of Nonlinear Science 27:013118. DOI: https://doi.org/10.1063/1.4974028
Assaneo MF, Trevisan MA. 2010. Computational model for vocal tract dynamics in a suboscine bird. Physical
Review E 82. DOI: https://doi.org/10.1103/PhysRevE.82.031906
Balachandar A, Prescott SA. 2018. Origin of heterogeneous spiking patterns from continuously distributed ion
channel densities: a computational study in spinal dorsal horn neurons. The Journal of Physiology 596:1681–
1697. DOI: https://doi.org/10.1113/JP275240, PMID: 29352464
Ben-Shalom R, Aviv A, Razon B, Korngreen A. 2012. Optimizing ion channel models using a parallel genetic
algorithm on graphical processors. Journal of Neuroscience Methods 206:183–194. DOI: https://doi.org/10.
1016/j.jneumeth.2012.02.024, PMID: 22407006
Bezaire MJ, Raikov I, Burk K, Vyas D, Soltesz I. 2016. Interneuronal mechanisms of hippocampal theta oscillations
in a full-scale model of the rodent CA1 circuit. eLife 5:e18566. DOI: https://doi.org/10.7554/eLife.18566,
PMID: 28009257
Bhalla US, Bower JM. 1993. Exploring parameter space in detailed single neuron models: simulations of the
mitral and granule cells of the olfactory bulb. Journal of Neurophysiology 69:1948–1965. DOI: https://doi.org/
10.1152/jn.1993.69.6.1948, PMID: 7688798
Britton OJ, Bueno-Orovio A, Vira´g L, Varro´ A, Rodriguez B. 2017. The electrogenic na+/K+ Pump Is a key
determinant of repolarization abnormality susceptibility in human ventricular cardiomyocytes: a population-
based simulation study. Frontiers in Physiology 8:278. DOI: https://doi.org/10.3389/fphys.2017.00278, PMID: 2
8529489
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
26 of 28
Tools and resources
Neuroscience
Calabrese RL. 2018. Inconvenient truth to principle of neuroscience. Trends in Neurosciences 41:488–491.
DOI: https://doi.org/10.1016/j.tins.2018.05.006, PMID: 30053951
Canavier CC, Clark JW, Byrne JH. 1990. Routes to chaos in a model of a bursting neuron. Biophysical Journal 57:
1245–1251. DOI: https://doi.org/10.1016/S0006-3495(90)82643-6, PMID: 1697484
Coggan JS, Ocker GK, Sejnowski TJ, Prescott SA. 2011. Explaining pathological changes in axonal excitability
through dynamical analysis of conductance-based models. Journal of Neural Engineering 8:065002.
DOI: https://doi.org/10.1088/1741-2560/8/6/065002, PMID: 22058273
Cymbalyuk GS, Gaudry Q, Masino MA, Calabrese RL. 2002. Bursting in leech heart interneurons: cell-
autonomous and network-based mechanisms. The Journal of Neuroscience 22:10580–10592. DOI: https://doi.
org/10.1523/JNEUROSCI.22-24-10580.2002, PMID: 12486150
Cymbalyuk GS, Calabrese RL. 2000. Oscillatory behaviors in pharmacologically isolated heart interneurons from
the medicinal leech. Neurocomputing 32-33:97–104. DOI: https://doi.org/10.1016/S0925-2312(00)00149-1
Dayan P, Abbott LF. 2001. Theoretical Neuroscience. Cambridge: MIT Press.
Devenyi RA, Sobie EA. 2016. There and back again: iterating between population-based modeling and
experiments reveals surprising regulation of calcium transients in rat cardiac myocytes. Journal of Molecular
and Cellular Cardiology 96:38–48. DOI: https://doi.org/10.1016/j.yjmcc.2015.07.016, PMID: 26235057
Druckmann S, Banitt Y, Gidon A, Schu¨ rmann F, Markram H, Segev I. 2007. A novel multiple objective
optimization framework for constraining conductance-based neuron models by experimental data. Frontiers in
Neuroscience 1:7–18. DOI: https://doi.org/10.3389/neuro.01.1.1.001.2007, PMID: 18982116
Ermentrout GB. 1984. Period doublings and possible chaos in neural models. SIAM Journal on Applied
Mathematics 44:80–95. DOI: https://doi.org/10.1137/0144007
Feigenbaum MJ. 1978. Quantitative universality for a class of nonlinear transformations. Journal of Statistical
Physics 19:25–52. DOI: https://doi.org/10.1007/BF01020332
Fox DM, Tseng HA, Smolinski TG, Rotstein HG, Nadim F. 2017. Mechanisms of generation of membrane
potential resonance in a neuron with multiple resonant ionic currents. PLOS Computational Biology 13:
e1005565. DOI: https://doi.org/10.1371/journal.pcbi.1005565, PMID: 28582395
Goldberg DE, Holland JH. 1988. Machine Learning and Its Applications. In: Genetic Algorithms and Machine
Learning. 3 Springer. p. 95–99.
Goldman MS, Golowasch J, Marder E, Abbott LF. 2001. Global structure, robustness, and modulation of
neuronal models. The Journal of Neuroscience 21:5229–5238. DOI: https://doi.org/10.1523/JNEUROSCI.21-14-
05229.2001, PMID: 11438598
Golowasch J, Goldman MS, Abbott LF, Marder E. 2002. Failure of averaging in the construction of a
conductance-based neuron model. Journal of Neurophysiology 87:1129–1131. DOI: https://doi.org/10.1152/jn.
00412.2001, PMID: 11826077
Gong JQX, Sobie EA. 2018. Population-based mechanistic modeling allows for quantitative predictions of drug
responses across cell types. Npj Systems Biology and Applications 4:11. DOI: https://doi.org/10.1038/s41540-
018-0047-2, PMID: 29507757
Gutierrez GJ, O’Leary T, Marder E. 2013. Multiple mechanisms switch an electrically coupled, synaptically
inhibited neuron between competing rhythmic oscillators. Neuron 77:845–858. DOI: https://doi.org/10.1016/j.
neuron.2013.01.016, PMID: 23473315
Hayashi H, Nakao M, Hirakawa K. 1982. Chaos in the self-sustained oscillation of an excitable biological
membrane under sinusoidal stimulation. Physics Letters A 88:265–266. DOI: https://doi.org/10.1016/0375-9601
(82)90245-6
Hayashi H, Ishizuka S. 1992. Chaotic nature of bursting discharges in the onchidium pacemaker neuron. Journal
of Theoretical Biology 156:269–291. DOI: https://doi.org/10.1016/S0022-5193(05)80676-9
Herz AV, Gollisch T, Machens CK, Jaeger D. 2006. Modeling single-neuron dynamics and computations: a
balance of detail and abstraction. Science 314:80–85. DOI: https://doi.org/10.1126/science.1127240,
PMID: 17023649
Holland JH. 1992. Genetic algorithms. Scientific American 267:66–72. DOI: https://doi.org/10.1038/
scientificamerican0792-66
Lee YS, Hwang M, Song JS, Li C, Joung B, Sobie EA, Pak HN. 2016. The contribution of ionic currents to Rate-
Dependent action potential duration and pattern of reentry in a mathematical model of human atrial fibrillation.
PLOS ONE 11:e0150779. DOI: https://doi.org/10.1371/journal.pone.0150779, PMID: 26964092
Liu Z, Golowasch J, Marder E, Abbott LF. 1998. A model neuron with activity-dependent conductances regulated
by multiple calcium sensors. The Journal of Neuroscience 18:2309–2320. DOI: https://doi.org/10.1523/
JNEUROSCI.18-07-02309.1998, PMID: 9502792
McDougal RA, Morse TM, Carnevale T, Marenco L, Wang R, Migliore M, Miller PL, Shepherd GM, Hines ML.
2017. Twenty years of ModelDB and beyond: building essential modeling tools for the future of neuroscience.
Journal of Computational Neuroscience 42:1–10. DOI: https://doi.org/10.1007/s10827-016-0623-7, PMID: 2762
9590
Migliore R, Lupascu CA, Bologna LL, Romani A, Courcol JD, Antonel S, Van Geit WAH, Thomson AM, Mercer A,
Lange S, Falck J, Ro¨ ssert CA, Shi Y, Hagens O, Pezzoli M, Freund TF, Kali S, Muller EB, Schu¨ rmann F, Markram
H, et al. 2018. The physiological variability of channel density in hippocampal CA1 pyramidal cells and
interneurons explored using a unified data-driven modeling workflow. PLOS Computational Biology 14:
e1006423. DOI: https://doi.org/10.1371/journal.pcbi.1006423, PMID: 30222740
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
27 of 28
Tools and resources
Neuroscience
O’Leary T, Williams AH, Franci A, Marder E. 2014. Cell types, network homeostasis, and pathological
compensation from a biologically plausible ion channel expression model. Neuron 82:809–821. DOI: https://
doi.org/10.1016/j.neuron.2014.04.002, PMID: 24853940
Press WH, Teukolsky SA, Vetterling WT, Flannery BP. 1988. Numerical Recipes in C. Cambridge University Press.
Prinz AA, Bucher D, Marder E. 2004. Similar network activity from disparate circuit parameters. Nature
Neuroscience 7:1345–1352. DOI: https://doi.org/10.1038/nn1352, PMID: 15558066
Roemschied FA, Eberhard MJ, Schleimer JH, Ronacher B, Schreiber S. 2014. Cell-intrinsic mechanisms of
temperature compensation in a grasshopper sensory receptor neuron. eLife 3:e02078. DOI: https://doi.org/10.
7554/eLife.02078, PMID: 24843016
Roffman RC, Norris BJ, Calabrese RL. 2012. Animal-to-animal variability of connection strength in the leech
heartbeat central pattern generator. Journal of Neurophysiology 107:1681–1693. DOI: https://doi.org/10.
1152/jn.00903.2011, PMID: 22190622
Schulz DJ, Goaillard JM, Marder E. 2006. Variable channel expression in identified single and electrically coupled
neurons in different animals. Nature Neuroscience 9:356–362. DOI: https://doi.org/10.1038/nn1639,
PMID: 16444270
Schulz DJ, Goaillard JM, Marder EE. 2007. Quantitative expression profiling of identified neurons reveals cell-
specific constraints on highly variable levels of gene expression. PNAS 104:13187–13191. DOI: https://doi.org/
10.1073/pnas.0705827104, PMID: 17652510
Shilnikov A, Calabrese RL, Cymbalyuk G. 2005. Mechanism of bistability: tonic spiking and bursting in a neuron
model. Physical Review E 71:056214. DOI: https://doi.org/10.1103/PhysRevE.71.056214
Sobel I, Feldman G. 1968. A 3x3 isotropic gradient operator for image processing. A Talk at the Stanford
Artificial Project, Pages.
Swensen AM, Bean BP. 2005. Robustness of burst firing in dissociated purkinje neurons with acute or long-term
reductions in sodium conductance. Journal of Neuroscience 25:3509–3520. DOI: https://doi.org/10.1523/
JNEUROSCI.3929-04.2005, PMID: 15814781
Szu¨ cs A, Elson RC, Rabinovich MI, Abarbanel HD, Selverston AI. 2001. Nonlinear behavior of sinusoidally forced
pyloric pacemaker neurons. Journal of Neurophysiology 85:1623–1638. DOI: https://doi.org/10.1152/jn.2001.
85.4.1623, PMID: 11287486
Temporal S, Desai M, Khorkova O, Varghese G, Dai A, Schulz DJ, Golowasch J. 2012. Neuromodulation
independently determines correlated channel expression and conductance levels in motor neurons of the
stomatogastric ganglion. Journal of Neurophysiology 107:718–727. DOI: https://doi.org/10.1152/jn.00622.
2011, PMID: 21994267
Temporal S, Lett KM, Schulz DJ. 2014. Activity-dependent feedback regulates correlated ion channel mRNA
levels in single identified motor neurons. Current Biology 24:1899–1904. DOI: https://doi.org/10.1016/j.cub.
2014.06.067, PMID: 25088555
Tobin AE, Cruz-Bermu´ dez ND, Marder E, Schulz DJ. 2009. Correlations in ion channel mRNA in rhythmically
active neurons. PLOS ONE 4:e6742. DOI: https://doi.org/10.1371/journal.pone.0006742, PMID: 19707591
Touboul J, Brette R. 2008. Dynamics and bifurcations of the adaptive exponential integrate-and-fire model.
Biological Cybernetics 99:319–334. DOI: https://doi.org/10.1007/s00422-008-0267-4, PMID: 19011921
Turrigiano G, LeMasson G, Marder E. 1995. Selective regulation of current densities underlies spontaneous
changes in the activity of cultured neurons. The Journal of Neuroscience 15:3640–3652. DOI: https://doi.org/
10.1523/JNEUROSCI.15-05-03640.1995, PMID: 7538565
Wang D, Grillner S, Walle´ n P. 2014. Endogenous release of 5-HT modulates the plateau phase of NMDA-induced
membrane potential oscillations in lamprey spinal neurons. Journal of Neurophysiology 112:30–38.
DOI: https://doi.org/10.1152/jn.00582.2013, PMID: 24740857
Xu K, Maidana JP, Caviedes M, Quero D, Aguirre P, Orio P. 2017. Hyperpolarization-Activated current induces
Period-Doubling cascades and chaos in a cold thermoreceptor model. Frontiers in Computational
Neuroscience 11:12. DOI: https://doi.org/10.3389/fncom.2017.00012, PMID: 28344550
Alonso and Marder. eLife 2019;8:e42722. DOI: https://doi.org/10.7554/eLife.42722
28 of 28
Tools and resources
Neuroscience
