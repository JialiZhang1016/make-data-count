METHOD
Open Access
SCALE: modeling allele-specific gene
expression by single-cell RNA sequencing
Yuchao Jiang1, Nancy R. Zhang2* and Mingyao Li3*
Abstract
Allele-specific expression is traditionally studied by bulk RNA sequencing, which measures average expression across
cells. Single-cell RNA sequencing allows the comparison of expression distribution between the two alleles of a diploid
organism and the characterization of allele-specific bursting. Here, we propose SCALE to analyze genome-wide allele-
specific bursting, with adjustment of technical variability. SCALE detects genes exhibiting allelic differences in bursting
parameters and genes whose alleles burst non-independently. We apply SCALE to mouse blastocyst and human
fibroblast cells and find that cis control in gene expression overwhelmingly manifests as differences in burst frequency.
Keywords: Single-cell RNA sequencing, Expression stochasticity, Allele-specific expression, Transcriptional bursting, cis
and trans transcriptional control, Technical variability
Background
In diploid organisms, two copies of each autosomal gene
are available for transcription, and differences in gene
expression level between the two alleles are widespread
in tissues [1–7]. Allele-specific expression (ASE), in its
extreme, is found in genomic imprinting, where the
allele from one parent is uniformly silenced across cells,
and in random X-chromosome inactivation, where one
of the two X-chromosomes in females is randomly
silenced. During the past decade, using single-nucleotide
polymorphism (SNP)-sensitive microarrays and bulk
RNA sequencing (RNA-seq), more subtle expression dif-
ferences between the two alleles were found, mostly in
the form of allelic imbalance of varying magnitudes in
mean expression across cells [8–11]. In some cases such
expression differences between alleles can lead to pheno-
typic consequences and result in disease [3, 12–14].
These studies, though revelatory, were at the bulk tissue
level, where one could only observe average expression
across a possibly heterogeneous mixture of cells.
Recent developments in single-cell RNA sequencing
(scRNA-seq) have made possible the better characterization
of the nature of allelic differences in gene expression across
individual cells [6, 15, 16]. For example, recent scRNA-seq
studies estimated that 12–24% of the expressed genes are
monoallelically expressed during mouse preimplantation
development [2] and that 76.4% of the heterozygous loci
across all cells express only one allele [17]. These ongoing
efforts have improved our understanding of gene regulation
and enriched our vocabulary in describing gene expression
at the allelic level with single-cell resolution.
Despite this rapid progress, much of the potential
offered by scRNA-seq data remains untapped. ASE, in
the setting of bulk RNA-seq data, is usually quantified
by comparing the mean expression level of the two
alleles. However, due to the inherent stochasticity of
gene expression across cells, the characterization of ASE
using scRNA-seq data should look beyond mean expres-
sion. A fundamental property of gene expression is tran-
scriptional bursting, in which transcription from DNA
to RNA occurs in bursts, depending on whether the
gene’s promoter is activated (Fig. 1a) [18, 19]. Transcrip-
tional bursting is a widespread phenomenon that has
been observed across many species, including bacteria
[20], yeast [21], Drosophila embryos [22], and mamma-
lian cells [23, 24], and is one of the primary sources of
expression variability in single cells. Figure 1b illustrates
the expression across time of the two alleles of a gene.
Under the assumption of ergodicity, each cell in a
scRNA-seq sample pool is at a different time in this
process, implying that, for each allele, some cells might
* Correspondence: nzh@wharton.upenn.edu; mingyao@mail.med.upenn.edu
2Department of Statistics, The Wharton School, University of Pennsylvania,
Philadelphia, PA 19104, USA
3Department of Biostatistics and Epidemiology, Perelman School of
Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA
Full list of author information is available at the end of the article
© The Author(s). 2017 Open Access This article is distributed under the terms of the Creative Commons Attribution 4.0
International License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted use, distribution, and
reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to
the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver
(http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.
Jiang et al. Genome Biology  (2017) 18:74 
DOI 10.1186/s13059-017-1200-8
be in the transcriptional “ON” state, whereas other cells
are in the “OFF” state. While in the ON state, the mag-
nitude and length of the burst can also vary across cells,
further complicating analysis. For each expressed hetero-
zygous site, a scRNA-seq experiment gives us the bivari-
ate distribution of the expression of its two alleles across
cells, allowing us to compare the alleles not only in their
mean, but also in their distribution. In this study, we use
scRNA-seq data to characterize transcriptional bursting
in an allele-specific manner and detect genes with allelic
differences in the parameters of this process.
Kim and Marioni [25] first studied bursting kinetics
of stochastic gene expression from scRNA-seq data,
using a Beta-Poisson model, and estimated the kinetic
parameters via a Gibbs sampler. In this early attempt,
they assumed shared bursting kinetics between the
two alleles and modeled total expression of a gene in-
stead of ASE. Current scRNA-seq protocols often
introduce substantial technical noise (e.g., gene drop-
outs, amplification and sequencing bias; Additional
file 1: Figure S1) [26–30] and this is largely ignored
in Kim and Marioni [25] and another recent scRNA-
seq study by Borel et al. [17], where, in particular,
gene dropout may have led to overestimation of the
pervasiveness of monoallelic expression (ME). Realiz-
ing this, Kim et al. [31] incorporated measurements
of technical noise from external spike-in molecules in
the identification of stochastic ASE (defined as exces-
sive variability in allelic ratios among cells) and con-
cluded that more than 80% of stochastic ASE in
mouse embryonic stem cells is due to scRNA-seq
technical noise. Kim et al.’s analysis was restricted to
the identification of random ME and did not consider
more general patterns of ASE, such as allele-specific
transcriptional bursting.
scRNA-seq also enables us to quantify the degree of
dependence between the expression of the two alleles. A
previous RNA fluorescence in situ hybridization (FISH)
experiment fluorescently labeled 20 genes in an allele-
specific manner and showed that there was no signifi-
cant deviation from independent bursting between the
two alleles [32]. A recent scRNA-seq study of mouse
cells through embryonic development [2] produced simi-
lar conclusions on the genome-wide level: they modeled
transcript loss by splitting each cell’s lysate into two frac-
tions of equal volume and controlling for false discover-
ies by diluting bulk RNA down to the single-cell level.
Their results suggest that, on the genome-wide scale, as-
suming both alleles share the same bursting kinetics, the
two alleles of most genes burst independently. Deviation
from the theoretical curve in Deng et al. [2] for inde-
pendent bursting with shared allele-specific kinetics,
however, can be due to not only dependent bursting, but
also different bursting kinetics.
In this study, we develop SCALE (Single-Cell ALlelic
Expression), a systematic statistical framework to study
ASE in single cells by examining allele-specific transcrip-
tional bursting kinetics. Our main goal is to detect and
characterize differences between the two alleles in their
expression distribution across cells. As a by-product, we
also quantify the degree of dependence between the ex-
pression of the two alleles. SCALE is comprised of three
steps. First, an empirical Bayes method determines, for
each gene, whether it is silent, monoallelically expressed,
or biallelically expressed based on its allele-specific
counts across cells (Fig. 1c). Next, for genes determined
(A)
(C)
(B)
Fig. 1 Allele-specific transcriptional bursting and gene categorization by single-cell ASE. a Transcription from DNA to RNA occurs in bursts, where
genes switch between the “ON” and the “OFF” states. kon, koff, s, and d are activation, deactivation, transcription, and mRNA decay rate in the
kinetic model, respectively. b Transcriptional bursting of the two alleles of a gene give rise to cells expressing neither, one, or both alleles of a
gene, sampled as vertical snapshots along the time axis. Partially adapted from Reinius and Sandberg [6]. c Empirical Bayes framework that
categorizes each gene as silent, monoallelic and biallelic (biallelic bursty, one-allele constitutive, and both-alleles constitutive) based on ASE data
with single-cell resolution
Jiang et al. Genome Biology  (2017) 18:74 
Page 2 of 15
to be biallelic bursty (i.e., both alleles have zero expression
level in some but not all cells), a Poisson-Beta hierarchical
model is used to estimate allele-specific transcriptional
kinetics while accounting for technical noise and cell size
differences. Finally, resampling-based testing procedures
are developed to detect allelic differences in transcrip-
tional burst size or burst frequency and identify genes
whose alleles exhibit non-independent transcription.
In silico simulations are conducted to investigate esti-
mation accuracy and testing power. The stringency of
model assumptions, and the robustness of the proposed
procedures to the violation of these assumptions, will be
discussed as they are introduced. Using SCALE, we re-
analyze the scRNA-seq data for 122 mouse blastocyst cells
[2] and 104 human fibroblast cells [17]. The mouse blasto-
cyst study initially found abundant random ME generated
by independent and stochastic allelic transcription [2]; the
human fibroblast study reported that 76.4% of the hetero-
zygous loci displayed patterns of ME [17]. Through proper
modeling of technical noise, our re-analysis of these two
datasets brings forth new insights: While for 90% of the
bursty genes there are no significant deviations from the
assumption of independent allelic bursting and shared
bursting kinetics, the remaining bursty genes show
different burst frequencies by a cis-effect and/or non-in-
dependent bursting with an enrichment in coordinated
bursting. Collectively, we present a genome-wide ap-
proach to systematically analyze expression variation in
an allele-specific manner with single-cell resolution.
SCALE is an open-source R package available at
https://github.com/yuchaojiang/SCALE.
Results
Methods overview
Figure 2 shows an overview of the analysis pipeline of
SCALE. We start with allele-specific read counts of
endogenous RNAs across all profiled single cells. An
empirical Bayes method is adopted to classify expression
of genes into monoallelic, biallelic, and silent states
based on ASE data across cells. SCALE then estimates
allele-specific transcriptional bursting parameters via a
hierarchical Poisson-Beta model, while adjusting for
technical variabilities and cell size differences. Statistical
testing procedures are then performed to identify genes
whose two alleles have different bursting parameters or
burst non-independently. We describe each of these
steps in turn.
Gene classification by ASE data across cells
SCALE first determines for each gene whether its expres-
sion is silent, paternal/maternal monoallelic, or biallelic.
Figure 1c outlines this categorization scheme. Briefly, for
each gene, each cell is assigned to one of four categories
corresponding to scenarios where both alleles are off (∅),
only the A allele is expressed ( A ), only the B allele is
expressed (B ), and both alleles are expressed ( AB ). An
expectation-maximization (EM) algorithm is implemented
for parameter estimation. This classification accounts for
both sequencing depth variation and sequencing errors.
The assignment of the gene is then determined based on
the posterior assignments of all cells. For example, if all
cells are assigned to
∅
f g, the gene is silent; if all cells are
assigned to either
∅
f g or
A
f g, the gene has ME of the A
allele; if all cells are assigned to either
∅
f g or
B
f g, the
gene has ME of the B allele; if both the A and B allele are
expressed in the cell pool, then the gene is biallelically
expressed. Refer to “Methods” for detailed statistical
methods and the EM algorithm.
Through simulation studies (see the “Assessment of
estimation accuracy and testing power” section), we
show that bursting parameters can only be stably
estimated for bursty genes, that is, genes that are
silent in a non-zero proportion of cells. Therefore, for
biallelic
bursty
genes,
allele-specific
transcriptional
kinetics are modeled through a Poisson-Beta distribu-
tion with adjustment for technical noise, see next sec-
tion.
For
silent,
monoallelically
expressed,
or
constitutively expressed genes, there is no way nor
need to estimate bursting kinetics for both alleles.
Fig. 2 Overview of analysis pipeline of SCALE. SCALE takes as input
allele-specific read counts at heterozygous loci and carries out three
major steps: (i) gene classification using an empirical Bayes method,
(ii) estimation of allele-specific transcriptional kinetics using a
Poisson-Beta hierarchical model with adjustment of technical
variability and cell size, (iii) testing of the two alleles of a gene to
determine if they have different bursting kinetics and/or non-
independent firing using a hypothesis testing framework
Jiang et al. Genome Biology  (2017) 18:74 
Page 3 of 15
Allele-specific transcriptional bursting
When studying ASE in single cells, it is critical to con-
sider transcriptional bursting due to its pervasiveness in
various organisms [20–24]. We adopt a Poisson-Beta
hierarchical model to quantify allele-specific transcrip-
tional kinetics while accounting for dropout events and
amplification and sequencing bias. Here, we start by
reviewing the relevant literature with regard to tran-
scriptional bursting at the single-cell level.
A two-state model for gene transcription is shown in
Fig. 1a, where genes switch between the ON and OFF
states with activation and deactivation rates kon and koff .
When the gene is in the ON state, DNA is transcribed
into RNA at rate s while RNA decays at rate d . A
Poisson-Beta stochastic model was first proposed by
Kepler and Elston [33]:
Ye Poisson sp
ð
Þ;
p e Beta kon; koff


;
where Y is the number of mRNA molecules and p is the
fraction of time that the gene spends in the active state,
the latter having mean
kon= kon þ koff


. Under this
model, 1=kon and 1=koff are the average waiting times in
the inactive and active states, respectively. Burst size,
defined as the average number of synthesized mRNA
per burst episode, is given by s=koff , and burst frequency
is given by kon . Kepler and Elston [33] gave detailed
analytical solutions via differential equations. Raj et al.
[23] offered empirical support for this model via single-
molecule FISH on reporter genes. Since the kinetic
parameters are measured in units of time and only the
stationary distribution is assumed to be observed (e.g.,
when cells are killed for sequencing and fixed for FISH),
the rate of decay d is set to one [15]. This is equivalent to
having three kinetic parameters fs; kon; kof f g, each normal-
ized by the decay rate d. Kim and Marioni [25] applied this
Poisson-Beta model to total gene-level transcript counts
from scRNA-seq data of mouse embryonic stem cells.
While they found that the inferred kinetic parameters are
correlated with RNA polymerase II occupancy and histone
modification [25], they didn’t address the issue of technical
noise, especially the dropout events, introduced by scRNA-
seq. Failure to account for gene dropouts may lead to
biased estimation of bursting kinetics.
Furthermore, since the transitions between active and in-
active states occur separately for the two alleles, when ASE
data are available, it seems more appropriate to model
transcriptional bursting in an allele-specific manner. The
fact that transcriptional bursting occurs independently for
the two alleles has been supported by empirical evidence:
case studies based on imaging methods have suggested that
the two alleles of genes are transcribed in an independent
fashion [34, 35]; using scRNA-seq data, Deng et al. [2]
showed that the two alleles of most genes tend to fire inde-
pendently with the assumption that both alleles share the
same set of kinetic parameters. These findings, although
limited
in
scale
or
relying
on
strong
assumptions,
emphasize the need to study transcriptional bursting in an
allele-specific manner.
Technical noise in scRNA-seq and other complicating factors
Additional file 1: Figure S1 outlines the major steps of the
scRNA-seq protocols and the sources of bias that are intro-
duced during library preparation and sequencing. After the
cells are captured and lysed, exogenous spike-ins are added
as internal controls, which have fixed and known concen-
trations and can thus be used to convert the number of se-
quenced transcripts into actual abundances. During the
reverse transcription, pre-amplification, and library prepar-
ation steps, lowly expressed transcripts might be lost, in
which case they will not be detected during sequencing.
This leads to so-called “dropout” events. Since spike-ins
undergo the same experimental procedure as endogenous
RNAs in a cell, amplification and sequencing bias can be
captured and estimated through the spike-in molecules.
Here we adopt the statistical model in TASC (Toolkit for
Analysis of Single Cell data, unpublished), which explicitly
models the technical noise through spike-ins. TASC’s
model is based on the key observation that the probability
of a gene being a dropout depends on its true expression in
the cell, with lowly expressed genes more likely to drop out.
Specifically, let Qcg and Y cg be, respectively, the observed
and true expression levels of gene g in cell c. The hierarch-
ical mixture model used to model dropout, amplification,
and sequencing bias is:
Qcg e ZcgPoisson αc Y cg

βc


;
Zcg e Bernoulli πcg


;
πcg ¼ expit κc þ τc log Y cg




;
where Zcg is a Bernoulli random variable indicating that
gene g is detected in cell c, that is, a dropout event has
not occurred. The success probability πcg ¼ P Zcg ¼ 1


depends on logðY cgÞ, the logarithm of the true under-
lying expression. Cell-specific parameter αc models the
capture and sequencing efficiency; βc models the amplifi-
cation bias; κc and τc characterize whether a transcript is
successfully captured in the library. This model will later
be used to adjust for technical noise in ASE.
As input to SCALE, we recommend scRNA-seq data
from cells of the same type. Unwanted heterogeneity,
however, still persists as the cells may differ in size or
may be in different phases of the cell cycle. Through a
series of single-cell FISH experiments, Padovan-Merhar
et al. [36] showed how gene transcription depends on
these exogenous factors: burst size is independent of cell
Jiang et al. Genome Biology  (2017) 18:74 
Page 4 of 15
cycle but is kept proportional to cell size by a trans
mechanism; burst frequency is independent of cell size
but is reduced approximately by half, through a cis
mechanism, between G1 and G2 phases to compensate
for the doubling of DNA content. Additional file 1:
Figure S2 illustrates how burst size and burst frequency
change with cell size and cell cycle phase. Note that
while the burst frequency from each DNA copy is halved
when the amount of DNA is doubled, the total burst fre-
quency remains roughly constant through the cell cycle.
Thus, SCALE adjusts for variation in cell size through
modulation of burst size and does not adjust for vari-
ation in cell cycle phase. Details will be given below.
Cell size can be measured in multiple ways. Padovan-
Merhar et al. [36] proposed using the expression level of
GAPDH as a cell size marker. When spike-ins are avail-
able, we use the ratio of the total number of endogenous
RNA reads over the total number of spike-in reads as a
measure (Additional file 1: Figure S2) of the total RNA
volume, which was shown to be a good proxy for cell
size [28]. SCALE allows the user to input the cell sizes
ϕc if these are available through other means.
Modeling transcriptional bursting with adjustment for
technical and cell-size variation
We are now ready to formulate the allele-specific burst-
ing model for scRNA-seq data. For genes that are cate-
gorized as biallelic bursty (with the proportion of cells
expressing each allele between 5 and 95% from the Bayes
framework), SCALE proceeds to estimate the allele-
specific bursting parameters using a hierarchical model:
Y A
cg e Poisson ϕcsA
g pA
cg


Y B
cg e Poisson ϕcsB
g pB
cg


pA
cg e Beta kA
on;g; kA
off ;g


pB
cg e Beta kB
on;g; kB
off ;g


;
where Y A
cg and Y B
cg are the true ASE for gene g in cell c.
The two alleles of each gene are modeled by separate
Poisson-Beta distributions with kinetic parameters that
are gene- and allele-specific. These two Poisson-Beta
distributions share the same cell size factor ϕc, which
affects burst size. The true ASE Y A
cg and Y B
cg are not
directly observable. The observed allele-specific read
counts QA
cg and QB
cg are confounded by technical noise
and follow the Poisson mixture model outlined in the
previous section:
QA
cg e ZA
cgPoisson αc Y A
cg

βc


QB
cg e ZB
cgPoisson αc Y B
cg

βc


ZA
cg e Bernoulli πA
cg


ZB
cg e Bernoulli πB
cg


πA
cg ¼ expit κc þ τc log Y A
cg




πB
cg ¼ expit κc þ τc log Y B
cg




:
How to generate input for SCALE for both endogenous
RNAs and exogenous spike-ins is included in “Methods”
and Additional file 1: Supplementary methods. For param-
eter estimation, we developed a new “histogram-repiling”
method to obtain the distribution of Y cg from the ob-
served distribution of Qcg . The bursting parameters are
then derived from the distribution of Y cg
by moment
estimators. Standard errors and confidence intervals of
the parameters are obtained using nonparametric boot-
strapping. The details are shown in “Methods”.
Hypothesis testing
For biallelic bursty genes, we use nonparametric boot-
strapping to test the null hypothesis that the burst
frequency and burst size of the two alleles are the
same (kA
on ¼ kB
on , sA=kA
off ¼ sB=kB
off ) against the alternative
hypothesis that either or both parameters differ between
alleles. For each gene, we also a perform chi-square test to
determine if the transcription of each of the two alleles is
independent by comparing the observed proportions of
cells from the gene categorization framework against the
expected proportions under independence. For genes where
the proportion of cells expressing both alleles is significantly
higher than expected, we define their bursting as coordi-
nated; for genes where the proportion of cells expressing
only one allele is significantly higher than expected, we
define their bursting as repulsed (Fig. 2). We use false
discovery rate (FDR) to adjust for multiple comparisons.
Details of the testing procedures are outlined in “Methods”.
Analysis of scRNA-seq dataset of mouse cells during
preimplantation development
We re-analyzed the scRNA-seq dataset of mouse blasto-
cyst cells dissociated from in vivo F1 embryos (CAST/fe-
male x C57/male) from Deng et al. [2]. Transcriptomic
profiles of each individual cell were generated using the
Smart-seq [37] protocol. For 22,958 genes, reads per
kilobase per million reads (RPKM) and total number of
read counts across all cells are available. Parental allele-
specific read counts are also available at heterozygous
loci (Additional file 1: Figure S3). Principal component
analysis was performed on cells from oocyte to blasto-
cyst stages of mouse preimplantation development and
showed that the first three principal components sep-
arate well the early-stage cells from the blastocyst
cells (Additional file 1: Figure S4). The clusters of
early-, mid-, and late-blastocyst cells are combined to
gain a sufficient sample size. In the “Discussion”, we give
further insights into the potential effects of cell subtype
confounding. A quality control procedure was used to re-
move outliers in library size, mean, and standard deviation
of allelic read counts/proportions. We applied SCALE to
this dataset of 122 mouse blastocyst cells, with a focus on
addressing the issue of technical variability and modeling
of transcriptional bursting.
Jiang et al. Genome Biology  (2017) 18:74 
Page 5 of 15
Eight exogenous RNAs with known serial dilutions
were added to late blastocyst cells (Additional file 2:
Table S1) and used to estimate the technical noise-
associated parameters (Additional file 1: Figure S5a).
We applied the Bayes gene classification framework to
these cells to get the genome-wide distribution of gene
categories. Specifically, out of the 22,958 genes profiled
across all cells, ~43% are biallelically expressed (~33%
of the total are biallelic bursty, and ~10% of the total
are
biallelic
non-bursty),
~7%
are
monoallelically
expressed, and ~50% are silent. Our empirical Bayes
categorization results show that, on the genome-wide
scale, the two alleles of most biallelic bursty genes share
the same bursting kinetics and burst independently
(Additional file 1: Figure S6a), as has been reported by
Deng et al. [2].
For the 7486 genes that are categorized as biallelic bursty,
we applied SCALE to identify genes whose alleles have dif-
ferent bursting kinetic parameters by the bootstrap-based
hypothesis tests as previously described. After FDR control,
we identified 425 genes whose two alleles have significantly
different burst frequencies (Fig. 3a) and two genes whose
two
alleles
have
significantly
different
burst
sizes
(Fig. 3b). Figure 4 shows the allelic read counts of a
gene that has different burst frequencies (Btf3l4) and a
gene that has different burst sizes (Fdps). The two
genes with significantly different allelic burst sizes
(Fdps and Atp6ap2) are also significant in having differ-
ent burst frequencies between the two alleles. P values
from differential burst frequency testing have a spike
below the significance level after FDR control (Fig. 3a),
while those from differential burst size testing are
roughly uniformly distributed (Fig. 3b).
At the whole genome level, these results show that
allelic differences in the expression of bursty genes dur-
ing embryo development are achieved through differen-
tial modulation of burst frequency rather than burst
size. This seems to agree with intuition, since allelic
differences must be caused by factors that act in cis to
regulate gene expression, and cis factors are likely to
change burst frequency by affecting promoter accessibility
[36, 38–40]. On the contrary, while it is plausible for cis
factors to affect allelic burst size through, for example, the
efficiency of RNA polymerase II recruitment or the speed
(A)
(B)
Fig. 3 Allele-specific transcriptional kinetics of 7486 genes from 122 mouse blastocyst cells. a Burst frequency of the two alleles has a correlation of
0.852; 425 genes show significant allelic differences in burst frequency after FDR control. b Burst size of the two alleles has a correlation of 0.746; two
genes show significant allelic difference in burst size. X-chromosome genes as positive controls show significantly higher burst frequencies of the
maternal alleles than those of the paternal alleles. The p values for allelic burst size difference (bottom right) are uniformly distributed as expected
under the null, whereas those for allelic burst frequency difference (bottom left) have a spike below significance level after FDR control
Jiang et al. Genome Biology  (2017) 18:74 
Page 6 of 15
of elongation, the few known cases of burst size modula-
tion are controlled in trans [36]. Furthermore, previous
studies have shown that the kinetic parameter that varies
the most—along the cell cycle [36], between different
genes [41], between different growth conditions [42], or
under regulation by a transcription factor [43]—is the
probabilistic rate of switching to the active state kon, while
the rates of gene inactivation koff and of transcription s
vary much less.
Our analysis includes 107 male cells (XAY) and 15 fe-
male cells (XAXB) and this allows us to use those bursty
X-chromosome genes as positive controls. As a result of
this gender mixture, more cells express the maternal XA
allele compared to the paternal XB allele. As shown in
Fig. 3, SCALE successfully detects these bursty X-
chromosome genes with significant difference in allelic
burst frequencies but not in allelic burst sizes. If we keep
only the 107 male cells, these X-chromosome genes are
correctly categorized as monoallelically expressed—the
bursting kinetics for the paternal XB allele are not esti-
mable—and in this case there is no longer a cluster of
significant X-chromosome genes separated from the
autosomal genes (Additional file 1: Figure S8).
For biallelic bursty genes, we also used a simple bino-
mial test to determine if the mean allelic coverage across
cells is biased towards either allele. This is comparable
to existing tests of allelic imbalance in bulk tissue,
although the total coverage across cells in this dataset is
much higher than standard bulk tissue RNA-seq data.
After multiple hypothesis testing correction, we identi-
fied 417 genes with significant allelic imbalance, out of
which 238 overlap with the significant genes from the
testing of differential bursting kinetics (Fig. 5a). Inspec-
tion of the estimated bursting kinetic parameters in
Fig. 5a shows that, when the burst size and burst fre-
quency of the two alleles change in the same direction
(e.g., gene Gprc5a in Fig. 5b), testing of allelic imbalance
can detect more significant genes with higher power.
This is not unexpected—a small insignificant increase in
burst size adds on top of an insignificant increase in
burst frequency, resulting in a significant increase in
overall expression levels between the two alleles. How-
ever, for genes shown in red in the top left and bottom
right quadrants of Fig. 5a, the test for differential burst-
ing kinetics detects more genes than the allelic imbal-
ance test. This is due to the fact that when burst size
and burst frequency change in opposite directions (e.g.,
gene Dhrs7 in Fig. 5b), their effects cancel out when
looking at the mean expression. Furthermore, even when
the burst size does not change, if the change in burst
frequency is small, by using a more specific model
SCALE has higher power to detect it compared to an
analysis based on mean allelic imbalance. Overall, the
allelic imbalance test and differential bursting test report
overlapping but substantially different sets of genes, with
each test having its benefits. Compared to the allelic im-
balance test, SCALE gives more detailed characterization
of the nature of the difference by attributing the change
in mean expression to a change in the burst frequency
and/or burst size.
It is also noticeable that in Fig. 5a the vertical axis,
Δfreq, has a 50% wider range than the horizontal axis,
Δsize . Therefore, while it is visually not obvious from
this scatter plot, much more genes have large absolute
Δfreq than large absolute Δsize. Although the standard
errors of these estimated differences are not reflected in
the plot, given our testing results, those genes with large
estimated differences in Δsize also have large standard
(B)
(A)
(C)
Fig. 4 Examples of significant genes from hypothesis testing. a The two alleles of the gene have significantly different burst frequencies from the
bootstrap-based testing. b The two alleles of the gene have significantly different burst sizes and burst frequencies. c The two alleles of the gene
fire non-independently from the chi-square test of independence
Jiang et al. Genome Biology  (2017) 18:74 
Page 7 of 15
errors in their estimates, which is further confirmed via
simulations.
Further chi-squared test of the null hypothesis of inde-
pendence (Fig. 4c) shows that 424 genes have two alleles
that fire in a significantly non-independent fashion. We
find that all significant genes have higher proportions of
cells expressing both alleles than expected, indicating
coordinated expression between the two alleles. In this
dataset, there are no significant genes with repulsed
bursting between the two alleles. Repulsed bursting, in
the extreme case where at most one allele is expressed
in any cell, is also referred to as stochastic ME [31]. Our
testing results indicate that, in mouse embryo develop-
ment, all cases of stochastic ME (i.e., repulsion between
the two alleles) can be explained by independent and in-
frequent stochastic bursting. The burst synchronization
in the 424 significant genes is not unexpected and is
possibly due to a shared trans factor between the two
alleles (e.g., co-activation of both alleles by a shared
enhancer). This result is concordant with the findings
from a mouse embryonic stem cell scRNA-seq study by
Kim et al. [31], which reported that the two alleles of a
gene show correlated allelic expression across cells more
often than expected by chance, potentially suggesting
regulation by extrinsic factors [31]. We further discuss
the sharing of such extrinsic factors under the context of
cell population admixtures in the “Discussion”.
In summary, our results using SCALE suggest that: (i)
the two alleles from 10% of the bursty genes show either
significant deviations from independent firing or signifi-
cant differences in bursting kinetic parameters; (ii) for
genes whose alleles differ in their bursting kinetic
parameters, the difference is found mostly in the burst
frequency instead of the burst size; (iii) for genes whose
alleles violate independence, their expression tends to be
coordinated. Refer to Additional file 3: Table S2 for
genome-wide output from SCALE.
Analysis of scRNA-seq dataset of human fibroblast cells
To further examine our findings in a dataset without
potential confounding of cell type admixtures, we
applied SCALE to a scRNA-seq dataset of 104 cells
from female human newborn primary fibroblast cul-
ture from Borel et al. [17]. The cells were captured
by Fluidigm C1 with 22 PCR cycles and were se-
quenced with, on average, 36 million reads (100 bp,
paired end) per cell. Bulk-tissue whole-genome se-
quencing was performed on two different lanes with
26-fold coverage on average and was used to identify
heterozygous loci in coding regions. After quality
control
procedures,
9016
heterozygous
loci
from
9016 genes were identified (if multiple loci coexist in
the same gene, we picked the one with the highest
mean depth of coverage). At each locus, we used
SAMtools [44] mpileup to obtain allelic read counts
in each single cell from scRNA-seq, which are fur-
ther used as input for SCALE. Ninety-two ERCC
synthesized RNAs were added in the lysis buffer of
12 fibroblast cells with a final dilution of 1:40,000.
The true concentrations and the observed number of
reads for all spike-ins were used as baselines to estimate
technical variability (Additional file 4: Table S3; Additional
(A)
(B)
Fig. 5 Testing of bursting kinetics by scRNA-seq and testing mean difference by bulk-tissue sequencing. a Genes that are significant from testing
of shared burst frequency and allelic imbalance. *Also includes the two genes that are significant from testing of shared burst size. Change in
burst frequency and burst size in the same direction leads to higher detection power of allelic imbalance; change in different directions leads to
allelic imbalance testing being underpowered. b Gene Dhrs7, whose two alleles have bursting kinetics in different directions, and gene Gprc5a,
whose two alleles have bursting kinetics in the same direction. Dhrs7 is significant from testing of differential allelic bursting kinetics; Gprc5a is
significant from the testing of mean difference between the two alleles
Jiang et al. Genome Biology  (2017) 18:74 
Page 8 of 15
file 1: Figure S5b). Refer to Additional file 1: Supplementary
methods for details on the bioinformatic pipeline.
We applied the gene categorization framework using
SCALE and found that out of the 9016 genes, the
proportions of monoallelically expressed, biallelically
expressed, and silent genes are 11.5, 45.7, and 42.8%,
respectively. For the 2277 genes that are categorized as
biallelic bursty, we estimated their allele-specific bursting
kinetic parameters and found that the correlations be-
tween the estimated burst frequency and burst size be-
tween the two alleles are 0.859 and 0.692 (Fig. 6). We
then carried out hypothesis testing on differential allelic
bursting kinetics. After FDR correction, we identified 26
genes with significantly different burst frequencies be-
tween the two alleles (Fig. 6a) and one gene Nfx1 with
significantly different burst sizes between the two alleles,
which is also significant in burst frequency testing (Fig. 6b).
We further carried out testing of non-independent burst-
ing between the two alleles and identified 35 significant
genes after FDR correction (Additional file 1: Figure S6b).
Out of the 35 significant genes, 27 showed patterns of co-
ordinated bursting while the other eight showed repulsed
patterns. Refer to Additional file 5: Table S4 for detailed
output from SCALE across all tested genes.
We also carried out pairwise correlation analysis be-
tween the estimated allelic bursting kinetics, the propor-
tion of unit time that the gene stays in the active state
kon= kon þ koff


for each allele, as well as the overall ASE
levels (taken as the sum across all cells at the heterozygous
locus). Notably, we found that the overall ASE correlates
strongly with the burst frequency and the proportion of
time that the gene stays active, but not with the burst size
(Additional file 1: Figure S9), in concordance with Kim
and Marioni [25]. This further supports our previous
conclusion that ASE at the single-cell level manifests as
differences in burst frequency in a cis-manner.
Assessment of estimation accuracy and testing power
First, we investigated the accuracy of the moment esti-
mators for the bursting parameters under four different
scenarios in the Poisson-Beta transcription model: (i)
small kon and small koff , which we call bursty and leads
to relatively few transitions between the ON and OFF
states with a bimodal mRNA distribution across cells
(Additional file 1: Figure S10a); (ii) large kon and small
koff , which leads to long durations in the ON state and
resembles
constitutive
expression
with
the
mRNA
Fig. 6 Allele-specific transcriptional kinetics of 2277 genes from 104 human fibroblast cells. a Burst frequency of the two alleles has a correlation
of 0.859; 26 genes show significant allelic difference in burst frequency after FDR. b Burst size of the two alleles has a correlation of 0.692. One
gene has significant allelic difference in burst size. The results are concordant with the findings from the mouse embryonic development study
Jiang et al. Genome Biology  (2017) 18:74 
Page 9 of 15
having a Poisson-like distribution (Additional file 1:
Figure S10B); (iii) small kon and large koff , which leads to
most cells being silent (Additional file 1: Figure S10c);
(iv) and large kon and large koff , which leads to constitu-
tive expression (Additional file 1: Figure S10d).
We generated simulated data for 100 cells from the four
cases above and started with no technical noise or cell size
confounding. Within each case, we vary kon , koff , and s
and use relative absolute error θ  θ
j
j=θ
^
as a measurement
of accuracy (Additional file 1: Figure S11). Our results show
that genes with large kon and small koff (shown as the black
curves in Additional file 1: Figure S11) have the largest es-
timation errors of the bursting parameters. Statistically it
is hard to distinguish these constitutively expressed genes
from genes with large kon and large koff and thus the kin-
etic parameters in this case cannot be accurately esti-
mated, which has been previously reported [25, 45].
Furthermore, the estimation errors are large for genes
with small kon, large koff , and small s (shown as red curves
in Additional file 1: Figure S11) due to lack of cells with
non-zero expression. The standard errors and confidence
intervals of the estimated kinetics from bootstrap resam-
pling further confirm the underperformance for the above
two classes (Additional file 1: Table S5). This emphasizes
the need to adopt the Bayes categorization framework as a
first step so that kinetic parameters are stably estimated
only for genes whose both alleles are bursty. For genes
whose alleles are perpetually silent or constitutively
expressed across cells, there is no good method, nor any
need, to estimate their bursting parameters.
Importantly, we see that the estimation bias in tran-
scription rate s and deactivation rate koff
cancel—over/
underestimation of s is compensated by over/underesti-
mation of koff —and as a consequence the burst size s=koff
can be more stably estimated than either parameter alone,
especially when
kon≪koff
(shown as red curves in
Additional file 1: Figure S11). This is further confirmed by
empirical results that allelic burst size has much higher
correlation (0.746 from the mouse blastocyst dataset and
0.692 from the human fibroblast dataset) than allelic
transcription and deactivation rate (0.464 and 0.265 for
mouse blastocyst, and 0.458 and 0.33 for human fibro-
blast) (Additional file 1: Figure S12). For this reason, all of
our results on real data are based on s=koff and we do not
consider s and koff separately.
We further carried out power analysis of the testing of
differential burst frequency and burst size between the
two alleles. The null hypothesis is both alleles sharing the
same bursting kinetics (kA
on ¼ kB
on ¼ 0:2; kA
off ¼ kB
off ¼ 0:2;
sA ¼ sB ¼ 50 ), while the alternative hypotheses with
differential burst frequency or burst size are shown in the
legends in Additional file 1: Figure S13. The detailed setup
of the simulation procedures is as follows. (i) Simulate the
true allele-specific read counts Y A and Y B across 100 cells
from the Poisson-Beta model under the alternative hy-
pothesis. Technical noise is then added based on the noise
model described earlier with technical noise parameters
α; β; κ; τ
f
g estimated from the mouse blastocyst cell data-
set. (ii) Apply SCALE to the observed expression level QA
and QB , which returns a p value for testing differential
burst size or burst frequency. If the p value is less than the
significance level, we reject the null hypothesis. (iii) Repeat
(i) and (ii)
N
times with the power estimated as
Number of pvalues≤0:05
N
. Our results indicate that the testing of
burst frequency and burst size have similar power
overall with relatively reduced power if the difference
in allelic burst size is due to a difference in the de-
activation rate koff .
We then simulated allele-specific counts from the full
model including technical noise as well as variations in cell
size with the ground truth kA
on ¼ kB
on ¼ kA
off ¼ kB
off ¼ 0:2;
sA ¼ sB ¼ 100 (bursty with small activation and deactiva-
tion rate). For parameters quantifying the degree of tech-
nical noise, we used the estimates from the mouse
blastocyst cells (Additional file 1: Figure S5a) as well as the
human fibroblast cells (Additional file 1: Figure S5b). Cell
sizes were simulated from a normal distribution with mean
0 and standard deviation 0.1 and 0.01. We ran SCALE
under four different settings: (i) in its default setting, (ii)
without accounting for cell size, (iii) without adjusting for
technical variability, (iv) not in an allele-specific fashion but
using total coverage as input. Each was repeated 5000 times
with a sample size of 100 and 400 cells, respectively.
Relative estimation errors of burst size and burst frequency
were summarized across all simulation runs. Our results
show that SCALE in its default setting has the smallest
estimation errors for both burst size and burst frequency
(Additional file 1: Figure S14 and S15). Not surprisingly, cell
size has a larger effect on burst size estimation than burst
frequency estimation, while technical variability leads to
biased estimation of both burst frequency and burst size.
The estimates taking total expression instead of ASE as
input are completely off. Furthermore, the estimation
accuracy improved as the number of cells increased. These
results indicate the necessity to profile transcriptional
kinetics in an allele-specific fashion with adjustment for
technical variability and cell size.
Discussion
We propose SCALE, a statistical framework to study
ASE using scRNA-seq data. The input data to SCALE
are allele-specific read counts at heterozygous loci across
all cells. In the two datasets that we analyzed, we used
F1 mouse crossing and bulk-tissue sequencing to profile
the true heterozygous loci. When these are not available,
scRNA-seq itself can be used to retrieve ASE and, more
Jiang et al. Genome Biology  (2017) 18:74 
Page 10 of 15
specifically,
haplotype
information,
as
described
in
Edsgard et al. [46]. SCALE estimates parameters that
characterize allele-specific transcriptional bursting after
accounting for technical biases in scRNA-seq and size
differences between cells. This allows us to detect genes
that exhibit allelic differences in burst frequency and
burst size and genes whose alleles show coordinated or
repulsed bursting patterns. Differences in mean expres-
sion between two alleles have long been observed in
bulk RNA-seq. By scRNA-seq, we now move beyond the
mean and characterize the difference in expression
distributions between the two alleles, specifically in
terms of their transcriptional bursting parameters.
Transcriptional bursting is a fundamental property of
gene expression, yet its global patterns in the genome
have not been well characterized, and most studies con-
sider bursting at the gene level by ignoring the allelic
origin of transcription. In this paper, we reanalyzed the
Deng et al. [2] and Borel et al. [17] data. We confirmed
the findings from Levesque and Raj [32] and Deng et al.
[2] that, for most genes across the genome, there is no
sufficient evidence against the assumption of independ-
ent bursting with shared bursting kinetics between the
two alleles. For genes where significant deviations are
observed, SCALE allows us to attribute the deviation to
differential bursting kinetics and/or non-independent
bursting between the two alleles.
More specifically, for genes that are transcribed in a
bursty fashion, we compared the burst frequency and
burst size between their two alleles. For both scRNA-seq
datasets, we identified a significant number of genes
whose allele-specific bursting differs according to burst
frequency but not burst size. Our findings provide evi-
dence that burst frequency, which represents the rate of
gene activation, is modified in cis and that burst size,
which represents the ratio of transcription rate to gene
inactivation rate, is less likely to be modulated in cis. Al-
though our testing framework may have slightly reduced
power in detecting the differential deactivation rate
(Additional file 1: Figure S13), regulation of burst size
can result from either a global trans factor or extrinsic
factors that act upon both alleles. Similar findings have
been previously reported, from different perspectives
and on different scales, using various technologies, plat-
forms, and model organisms [31, 36, 41–43].
It is worth noting that the bursting parameters estimated
by SCALE are normalized by the decay rate, where the
inverse 1=d denotes the average lifetime of an mRNA mol-
ecule. Here we implicitly make the assumptions that, for
each allele, the gene-specific decay rates (dA
g and dB
g ) are
constant, and thus the estimated allelic burst frequencies
are the ratio of true burst frequency over decay rate (that
is kA
on;g=dA
g and kB
on;g=dB
g ). The decay rates, however, cancel
out in the numerator and denominator in the allelic burst
sizes, sA
g =kA
off ;g and sB
g =kB
off ;g. Therefore, the differences that
we observe in the allelic burst frequencies can also poten-
tially be due to different decay rates between the two al-
leles, which has been previously reported to be regulated
by microRNAs [47].
It is also important to note that 44% of the genes found
to be significant for differential burst frequency are not
significant in the allelic imbalance test based on mean
expression across cells. This suggests that expression
quantitative trait loci (eQTL) affecting gene expression
through modulation of bursting kinetics are likely to
escape detection in existing eQTL studies by bulk sequen-
cing, especially when burst size and burst frequency
change in different directions. This is further underscored
by the study of Wills et al. [48], which measured the
expression of 92 genes affected by Wnt signaling in 1440
single cells from 15 individuals and then correlated SNPs
with various gene-expression phenotypes. They found
bursting kinetics as characterized by burst size and burst
frequency to be heritable, thus suggesting the existence of
bursting QTLs. Taken together, these results should
further motivate more large scale genome-wide studies to
systematically characterize the impact of eQTLs on
various aspects of transcriptional bursting.
Kim et al. [31] described a statistical framework to
quantify the extent of stochastic ASE in scRNA-seq data
by using spike-ins, where stochastic ASE is defined as
excessive variability in the ratio of the expression level of
the paternal (or maternal) allele between cells after
controlling for mean allelic expression levels. While they
attributed 18% of the stochastic ASE to biological vari-
ability, they did not examine what biological factors lead
to this stochastic ASE. In this study, we attribute the
observed stochastic ASE to differences in allelic bursting
kinetics. By studying bursting kinetics in an allele-
specific manner, we can compare the transcriptional
differences between the two alleles at a finer scale.
Kim and Marioni [25] described a procedure to estimate
bursting kinetic parameters using scRNA-seq data. Our
method differs from that of Kim and Marioni [25] in sev-
eral ways. First, our model is an allele-specific model that
infers kinetic parameters for each allele separately, thus
allowing comparisons between alleles. Second, we infer kin-
etic parameters based on the distribution of “true expres-
sion” rather than the distribution of observed expression.
We are able to do this through the use of a simple and
novel deconvolution approach, which allows us to eliminate
the impact of technical noise when making inference on
the kinetic parameters. Appropriate modeling of technical
noise, particularly gene dropouts, is critical in this context,
as failing to do so could lead to the overestimation of koff .
Third, we employ a gene categorization procedure prior to
Jiang et al. Genome Biology  (2017) 18:74 
Page 11 of 15
fitting the bursting model. This is important because the
bursting parameters can only be reliably estimated for
genes that have sufficient expression and that are bursty.
As a by-product, SCALE also allows us to rigorously test,
for scRNA-seq data, whether the paternal and maternal
alleles of a gene are independently expressed. In both
scRNA-seq datasets we analyzed, we identified more genes
whose allele-specific bursting is in a coordinated fashion
than those for which it is in a repulsed fashion. The ten-
dency towards coordination is not surprising, since the two
alleles of a gene share the same nuclear environment and
thus the same ensemble of transcription factors. We are
aware that this degree of coordination can also arise from
the mixture of non-homogeneous cell populations, e.g.,
different lineages of cells during mouse embryonic develop-
ment, as we combine the early-, mid-, and late-blastocyst
cells to gain a large enough sample size. While it is possible
that this might lead to false positives in identifying coordi-
nated bursting events, it will result in a decrease in power
for the testing of differential bursting kinetics. Given the
amount of stochasticity that is observed in the ASE data,
how to define cell sub-types and how to quantify between-
cell heterogeneity need further investigation.
Conclusions
We have developed SCALE, a statistical framework for
systematic characterization of ASE using data generated
from scRNA-seq experiments. Our approach allows us
to profile allele-specific bursting kinetics while account-
ing for technical variability and cell size difference. For
genes that are classified as biallelic bursty through a
Bayes categorization framework, we further examine
whether transcription of the paternal and maternal
alleles are independent and whether there are any kin-
etic differences, as represented by burst frequency and
burst size, between the two alleles. Our results from the
re-analysis of Deng et al. [2] and Borel et al. [17] provide
insights into the extent of differences, coordination, and
repulsion between alleles in transcriptional bursting.
Methods
Input for endogenous RNAs and exogenous spike-ins
For endogenous RNAs, SCALE takes as input the ob-
served allele-specific read counts at heterozygous loci
QA
cg and QB
cg, with adjustment by library size factor:
ηc ¼ median
g
QA
cg þ QB
cg
Y
c¼1
C
QA
cg þ QB
cg


h
i1=C :
In addition, for spike-ins, SCALE takes as input the
true concentrations of the spike-in molecules, the
lengths of the molecules, as well as the depths of
coverage for each spike-in sequence across all cells
(Additional file 2: Table S1; Additional file 4: Table S3).
The true concentration of each spike-in molecule is cal-
culated according to the known concentration (denoted
as C attomoles/μL) and the dilution factor (×40,000):
C  10−18 moles=μL  6:02214  1023mole−1 Avogadro constant
ð
Þ
40000 dilution factor
ð
Þ
:
The observed number of reads for each spike-in is
calculated by adjusting for the library size factor, the
read length, and the length of the spike-in RNA. The
bioinformatic pipeline to generate the input for SCALE
is included in Additional file 1: Supplementary methods.
Empirical Bayes method for gene categorization
We propose an empirical Bayes method that categorizes
gene expression across cells into silent, monoallelic, or
biallelic states based on their ASE data. Without loss of
generality, we focus on one gene here with the goal of
determining the most likely gene category based on its
ASE pattern. Let nA
c and nB
c be the allele-specific read
counts in cell c for alleles A and B, respectively. For each
cell, there are four different categories based on its
ASE— ∅; A; B; AB
f
g corresponding to scenarios where
both alleles are off, only the A allele is expressed, only
the B allele is expressed, and both alleles are expressed,
respectively. Let k∈1; 2; 3; 4
f
g represent this cell-specific
category. The log-likelihood for the gene across all cells
can be written as:
log ℒΘjnA; nB




¼ log
Y
c f nA
c ; nB
c jΘ


¼
X
c log
X4
k¼1φkf k nA
c ; nB
c j; a; b


h
i
;
where the parameters are Θ ¼ φ1; …; ; φ4; ; a; bg
f
with
P4
k¼1φk ¼ 1 and each f k is a density function parame-
terized by ; a; b.  is the per-base sequencing error rate,
and a and b are hyper-parameters for a Beta distribution,
where θceBeta a; b
ð
Þ corresponds to the relative expres-
sion of A allele when both alleles are expressed. It is easy
to show that:
f 1 nA
c ; nB
c j; a; b


∝nA
c þnB
c ;
f 2 nA
c ; nB
c j; a; b


∝ð1−ÞnA
c nB
c;
f 3 nA
c ; nB
c j; a; b


∝ncAð1−ÞnB
c;
f 4 nA
c ; nB
c j; a; b


∝
Z1
0
½θcð1−Þ þ 1−θc
ð
ÞnA
c
½θcþ 1−θc
ð
Þð1−ÞnB
c θc
a−1 1−θc
ð
Þb−1
B a;b
ð
Þ
dθc:
 can be estimated using sex chromosome mismatch-
ing or be prefixed at the default value, 0.001. We require
a ¼ b≥3 in the prior on θc so that the AB state is distin-
guishable from the A and B states. This is a reasonable
Jiang et al. Genome Biology  (2017) 18:74 
Page 12 of 15
assumption in that most genes have balanced ASE on
average and the use of Beta distribution allows variability
of allelic ratio across cells. We adopt an EM algorithm
for estimation, with Z being the missing variables:
Zck ¼
1
0

if cell c belongs to category k
otherwise
:
The complete-data log-likelihood is given as:
log ℒΘjnA; nB; Z




¼ log
Y
c
Y
4
k¼1
f k nA
c ; nB
c j; a; b

Zckφk
Zck
"
#
¼ P
c
P
k¼1
4
Zck log φk


þ P
c
P
k¼1
4
Zck log f k nA
c ; nB
c j; a; b


	

:
For each cell, we assign the state that has the
maximum posterior probability and only keep a cell
if its maximum posterior probability is greater than
0.8. Let N∅, NA, NB, and NAB be the number of cells
in state
∅
f g,
A
f g,
B
f g, and
AB
f
g, respectively. We
then assign a gene to be: (i) silent if NA ¼ NB ¼ NAB ¼ 0;
(ii) A-allele monoallelic if NA > 0; NB ¼ NAB ¼ 0; (iii) B-
allele monoallelic if NB > 0; NA ¼ NAB ¼ 0; (iv) bial-
lelic otherwise (biallelic bursty if 0:05≤NA þ NAB
ð
Þ=
N∅þ NA þ NB þ NAB
ð
Þ≤0:95
and
0:05≤NB þ NAB
ð
Þ=
N∅þ NA þ NB þ NAB
ð
Þ≤0:95).
Parameter estimation for Poisson-Beta hierarchical model
Since exogenous spike-ins are added in a fixed amount
and don’t undergo transcriptional bursting, they can be
used
to
directly
estimate
the
technical
variability-
associated parameters
α; β; κ; τ
f
g that are shared across
all cells from the same sequencing batch. Specifically, we
use non-zero read counts to estimate α and β through
log-linear regression:
Qcg e Poisson α Y cg

β


;
where
Qcg > 0 , capture and sequencing efficiencies are
confounded in α , and amplification bias is modeled by β
(Additional file 1: Figure S5). We then use the Nelder-Mead
simplex algorithm to jointly optimize κ and τ, which models
the probability of non-dropout, using the likelihood function:
log ℒκ; τjQ; Y; ^α; ^β




¼ Q
c
Q
g
log pPoisson Qcg; ^α Y cg

^β


n
expit κ þ τ logY cg


þ 1−expit κ þ τ logY cg




l Qcg ¼ 0

o
;
where pPoisson x; y
ð
Þ specifies the Poisson likelihood of
getting x from a Poisson distribution with mean y. This
log-likelihood
function
together
with
the
estimated
parameters decomposes the zero read counts (Qcg ¼ 0)
into being from the dropout events or from being
sampled as zero from the Poisson sampling during
sequencing (Additional file 1: Figure S5a).
The allele-specific kinetic parameters are estimated
via the moment estimator methods, which is more
computationally
efficient
than
the
Gibbs
sampler
method adopted by Kim and Marioni [25]. For each
gene, the distribution moments of the A allele given
true expression levels Y A
c and Y B
c are:
mA
1 ≡
E
X
cY A
c
h
i
X
cϕc
¼
kA
onsA
kA
on þ kA
off
mA
2 ≡
E
X
cY A
c Y A
c −1


h
i
X
cϕ2
c
¼
kA
on kA
on þ 1


sA

2
kA
on þ kA
off


kA
on þ kA
off þ 1


mA
3 ≡
E
X
cY A
c Y A
c −1


Y A
c −2


h
i
X
cϕ3
c
¼
kA
on kA
on þ 1


kA
on þ 2


sA

3
kA
on þ kA
off


kA
on þ kA
off þ 1


kA
on þ kA
off þ 2

 :
Solving this system of three equations, we have:
^k
A
on ¼
−2 −mA
1 mA
2

2 þ mA
1

2mA
3


−mA
1 mA
2
ð
Þ2 þ 2 mA
1
ð
Þ2mA
3 −mA
2 mA
3
^k
A
off ¼
2
mA
1

2−mA
2


mA
1 mA
2 −mA
3


mA
1 mA
3 −mA
2

2


mA
1
ð
Þ2mA
2 −2 mA
2
ð
Þ2 þ mA
1 mA
3


2 mA
1
ð
Þ2mA
3 −mA
1 mA
2
ð
Þ2−mA
2 mA
3


^sA ¼ −mA
1 mA
2

2 þ 2 mA
1

2mA
3 −mA
2 mA
3
mA
1
ð
Þ2mA
2 −2 mA
2
ð
Þ2 þ mA
1 mA
3
:
Substituting A with B we get the kinetic parameters for
the B allele. To get the sample moments, we propose a
novel histogram repiling method that gives the sample
distribution and sample moment estimates of the true ex-
pression from the distribution of the observed expression
(Additional file 1: Figure S7). Specifically, for each gene we
denote c Q
ð Þ as the number of cells with observed expres-
sion Q and n Y
ð Þ as the number of cells with the corre-
sponding true expression
Y .
c Q
ð Þ
follows a Binomial
distribution indexed at n Y
ð Þ with probability of no dropout:
c Q
ð Þ e Binomial n Y
ð Þ; expit ^κ þ ^τ logY
ð
Þ
ð
Þ:
Then:
^n Y
ð Þ ¼
c Q
ð Þ
expit ^κ þ ^τ logY
ð
Þ ¼
c Q
ð Þ
expit ^κ þ^τ
^β logQ
^α

 :
These moment estimates of the kinetic parameters are
sometimes negative as is pointed out by Kim and
Marioni [25]. Using in silico simulation studies, we
Jiang et al. Genome Biology  (2017) 18:74 
Page 13 of 15
investigate the estimation accuracy and robustness under
different settings.
Hypothesis testing framework
We carry out a nonparametric bootstrap hypothesis
testing procedure with the null hypothesis that the two
alleles of a gene share the same kinetic parameters
(Fig. 4a, b). The procedures are as follow.
(i) For gene g, let
QA
1g; QA
2g; …; QA
ng
n
o
and
QB
1g; QB
2g; …; QB
ng
n
o
be the observed allele-specific
read counts. Estimate allele-specific kinetic parame-
ters with adjustment of technical variability:
^θ
A ¼
^k
A
on;g; ^k
A
off ;g;^sA
g
n
o
; ^θ
B ¼
^k
B
on;g; ^k
B
off ;g;^sB
g
n
o
:
(ii) Combine the 2n observed allelic measurements and
draw samples of size 2n from the combined pool
with replacement. Assign the first n with their
corresponding cell sizes to allele A as
QA
1g ; QA
2g ; …; QA
ng
n
o
, the next n to allele B
QB
1g ; QB
2g ; …; QB
ng
n
o
. Estimate kinetic parameters
with adjustment of technical variability from the
bootstrap samples:
θA ¼
kA
on;g; kA
off ;g; sA
g
n
o
; θB ¼
kB
on;g; kB
off ;g; sB
g
n
o
:
Iterate this N times.
(iii) Compute the p values:
p ¼
X
l
θA−θB

≥^θ
A−^θ
B




N
:
We use a binomial test of allelic imbalance with the
null hypothesis that the allelic ratio of the mean expres-
sion across all cells is 0.5. A chi-square test of independ-
ence is further performed to test whether the two alleles
of a gene fire independently (Fig. 4c). The observed
number of cells is from the direct output of the Bayes
gene categorization framework. For all hypothesis test-
ing, we adopt FDR to adjust for multiple comparisons.
Additional files
Additional file 1: Figures S1–S15. Table S5. Supplementary Methods.
(PDF 3472 kb)
Additional file 2: Table S1. Spike-in input for mouse blastocyst dataset.
(XLSX 11 kb)
Additional file 3: Table S2. SCALE output for mouse blastocyst dataset.
(XLSX 2118 kb)
Additional file 4: Table S3. Spike-in input for human fibroblast dataset.
(XLSX 17 kb)
Additional file 5: Table S4. SCALE output for human fibroblast dataset.
(XLSX 785 kb)
Abbreviations
ASE: Allele-specific expression; EM: Expectation-maximization;
eQTL: Expression quantitative trait loci; FDR: False discovery rate;
FISH: Fluorescence in situ hybridization; ME: Monoallelic expression;
QTL: Quantitative trait loci; RNA-seq: RNA sequencing; scRNA-seq: Single-cell
RNA sequencing; SNP: Single-nucleotide polymorphism
Acknowledgements
We thank Dr. Daniel Ramsköld for providing the mouse preimplantation
embryo dataset, Dr. Christelle Borel for providing the human fibroblast
dataset, and Cheng Jia, Dr. Arjun Raj, and Dr. Uschi Symmons for helpful
comments and suggestions.
Funding
This work was supported by National Institutes of Health (NIH) grant
R01HG006137 to NRZ, and R01GM108600 and R01HL113147 to ML.
Availability of data and materials
SCALE is an open-source R package available at https://github.com/yuchao
jiang/SCALE with license GPL-3.0. Source code used in the manuscript is
available via Zenodo with DOI 10.5281/zenodo.437554.
Authors’ contributions
NRZ and ML initiated and envisioned the study. YJ, NRZ, and ML formulated
the model. YJ developed and implemented the algorithm. YJ, NRZ, and ML
conducted the analysis and wrote the manuscript. All authors read and
approved the final manuscript.
Competing interests
The authors declare that they have no competing interests.
Consent for publication
Not applicable.
Ethics approval and consent to participate
Not applicable.
Publisher’s Note
Springer Nature remains neutral with regard to jurisdictional claims in
published maps and institutional affiliations.
Author details
1Genomics and Computational Biology Graduate Program, Perelman School
of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA.
2Department of Statistics, The Wharton School, University of Pennsylvania,
Philadelphia, PA 19104, USA. 3Department of Biostatistics and Epidemiology,
Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA
19104, USA.
Received: 17 February 2017 Accepted: 24 March 2017
References
1.
Buckland PR. Allele-specific gene expression differences in humans. Hum
Mol Genet. 2004;13 Spec No 2:R255–60.
2.
Deng Q, Ramskold D, Reinius B, Sandberg R. Single-cell RNA-seq reveals
dynamic, random monoallelic gene expression in mammalian cells.
Science. 2014;343:193–6.
Jiang et al. Genome Biology  (2017) 18:74 
Page 14 of 15
3.
Gendrel AV, Attia M, Chen CJ, Diabangouaya P, Servant N, Barillot E, Heard
E. Developmental dynamics and disease potential of random monoallelic
gene expression. Dev Cell. 2014;28:366–80.
4.
Eckersley-Maslin MA, Spector DL. Random monoallelic expression: regulating
gene expression one allele at a time. Trends Genet. 2014;30:237–44.
5.
Eckersley-Maslin MA, Thybert D, Bergmann JH, Marioni JC, Flicek P, Spector
DL. Random monoallelic gene expression increases upon embryonic stem
cell differentiation. Dev Cell. 2014;28:351–65.
6.
Reinius B, Sandberg R. Random monoallelic expression of autosomal genes:
stochastic transcription and allele-level regulation. Nat Rev Genet. 2015;16:
653–64.
7.
Reinius B, Mold JE, Ramskold D, Deng Q, Johnsson P, Michaelsson J, Frisen J,
Sandberg R. Analysis of allelic expression patterns in clonal somatic cells by
single-cell RNA-seq. Nat Genet. 2016;48:1430–5.
8.
Bjornsson HT, Albert TJ, Ladd-Acosta CM, Green RD, Rongione MA, Middle
CM, Irizarry RA, Broman KW, Feinberg AP. SNP-specific array-based allele-
specific expression analysis. Genome Res. 2008;18:771–9.
9.
Skelly DA, Johansson M, Madeoy J, Wakefield J, Akey JM. A powerful and
flexible statistical framework for testing hypotheses of allele-specific gene
expression from RNA-seq data. Genome Res. 2011;21:1728–37.
10.
Leon-Novelo LG, McIntyre LM, Fear JM, Graze RM. A flexible Bayesian
method for detecting allelic imbalance in RNA-seq data. BMC Genomics.
2014;15:920.
11.
Castel SE, Levy-Moonshine A, Mohammadi P, Banks E, Lappalainen T. Tools
and best practices for data processing in allelic expression analysis. Genome
Biol. 2015;16:195.
12.
Knight JC. Allele-specific gene expression uncovered. Trends Genet.
2004;20:113–6.
13.
Bell CG, Beck S. Advances in the identification and analysis of allele-specific
expression. Genome Med. 2009;1:56.
14.
de la Chapelle A. Genetic predisposition to human disease: allele-specific
expression and low-penetrance regulatory loci. Oncogene. 2009;28:3345–8.
15.
Stegle O, Teichmann SA, Marioni JC. Computational and analytical
challenges in single-cell transcriptomics. Nat Rev Genet. 2015;16:133–45.
16.
Kolodziejczyk AA, Kim JK, Svensson V, Marioni JC, Teichmann SA. The technology
and biology of single-cell RNA sequencing. Mol Cell. 2015;58:610–20.
17.
Borel C, Ferreira PG, Santoni F, Delaneau O, Fort A, Popadin KY, Garieri M,
Falconnet E, Ribaux P, Guipponi M, et al. Biased allelic expression in human
primary fibroblast single cells. Am J Hum Genet. 2015;96:70–80.
18.
Chubb JR, Trcek T, Shenoy SM, Singer RH. Transcriptional pulsing of a
developmental gene. Curr Biol. 2006;16:1018–25.
19.
Raj A, van Oudenaarden A. Nature, nurture, or chance: stochastic gene
expression and its consequences. Cell. 2008;135:216–26.
20.
Chong S, Chen C, Ge H, Xie XS. Mechanism of transcriptional bursting in
bacteria. Cell. 2014;158:314–26.
21.
Blake WJ, Balazsi G, Kohanski MA, Isaacs FJ, Murphy KF, Kuang Y, Cantor CR,
Walt DR, Collins JJ. Phenotypic consequences of promoter-mediated
transcriptional noise. Mol Cell. 2006;24:853–65.
22.
Fukaya T, Lim B, Levine M. Enhancer control of transcriptional bursting. Cell.
2016;166:358–68.
23.
Raj A, Peskin CS, Tranchina D, Vargas DY, Tyagi S. Stochastic mRNA synthesis
in mammalian cells. PLoS Biol. 2006;4, e309.
24.
Suter DM, Molina N, Gatfield D, Schneider K, Schibler U, Naef F. Mammalian
genes are transcribed with widely different bursting kinetics. Science. 2011;
332:472–4.
25.
Kim JK, Marioni JC. Inferring the kinetics of stochastic gene expression from
single-cell RNA-sequencing data. Genome Biol. 2013;14:R7.
26.
Brennecke P, Anders S, Kim JK, Kolodziejczyk AA, Zhang X, Proserpio V, Baying
B, Benes V, Teichmann SA, Marioni JC, Heisler MG. Accounting for technical
noise in single-cell RNA-seq experiments. Nat Methods. 2013;10:1093–5.
27.
Pierson E, Yau C. ZIFA: Dimensionality reduction for zero-inflated single-cell
gene expression analysis. Genome Biol. 2015;16:241.
28.
Vallejos CA, Marioni JC, Richardson S. BASiCS: Bayesian analysis of single-cell
sequencing data. PLoS Comput Biol. 2015;11, e1004333.
29.
Ding B, Zheng L, Zhu Y, Li N, Jia H, Ai R, Wildberg A, Wang W.
Normalization and noise reduction for single cell RNA-seq experiments.
Bioinformatics. 2015;31:2225–7.
30.
Qiu X, Hill A, Packer J, Lin D, Ma YA, Trapnell C. Single-cell mRNA quantification
and differential analysis with Census. Nat Methods. 2017;14(3):309–15.
31.
Kim JK, Kolodziejczyk AA, Illicic T, Teichmann SA, Marioni JC. Characterizing
noise structure in single-cell RNA-seq distinguishes genuine from technical
stochastic allelic expression. Nat Commun. 2015;6:8687.
32.
Levesque MJ, Raj A. Single-chromosome transcriptional profiling reveals
chromosomal gene expression regulation. Nat Methods. 2013;10:246–8.
33.
Kepler TB, Elston TC. Stochasticity in transcriptional regulation: origins,
consequences, and mathematical representations. Biophys J. 2001;81:3116–36.
34.
Bix M, Locksley RM. Independent and epigenetic regulation of the
interleukin-4 alleles in CD4+ T cells. Science. 1998;281:1352–4.
35.
Levesque MJ, Ginart P, Wei Y, Raj A. Visualizing SNVs to quantify allele-
specific expression in single cells. Nat Methods. 2013;10:865–7.
36.
Padovan-Merhar O, Nair GP, Biaesch AG, Mayer A, Scarfone S, Foley SW, Wu
AR, Churchman LS, Singh A, Raj A. Single mammalian cells compensate for
differences in cellular volume and DNA copy number through independent
global transcriptional mechanisms. Mol Cell. 2015;58:339–52.
37.
Ramskold D, Luo S, Wang YC, Li R, Deng Q, Faridani OR, Daniels GA,
Khrebtukova I, Loring JF, Laurent LC, et al. Full-length mRNA-Seq from
single-cell levels of RNA and individual circulating tumor cells. Nat
Biotechnol. 2012;30:777–82.
38.
Dadiani M, van Dijk D, Segal B, Field Y, Ben-Artzi G, Raveh-Sadka T, Levo M,
Kaplow I, Weinberger A, Segal E. Two DNA-encoded strategies for
increasing expression with opposing effects on promoter dynamics and
transcriptional noise. Genome Res. 2013;23:966–76.
39.
Bartman CR, Hsu SC, Hsiung CC, Raj A, Blobel GA. Enhancer regulation of
transcriptional bursting parameters revealed by forced chromatin looping.
Mol Cell. 2016;62:237–47.
40.
Sepulveda LA, Xu H, Zhang J, Wang M, Golding I. Measurement of gene
regulation in individual cells reveals rapid switching between promoter
states. Science. 2016;351:1218–22.
41.
Skinner SO, Xu H, Nagarkar-Jaiswal S, Freire PR, Zwaka TP, Golding I. Single-cell
analysis of transcription kinetics across the cell cycle. Elife. 2016;5, e12175.
42.
Ochiai H, Sugawara T, Sakuma T, Yamamoto T. Stochastic promoter
activation affects Nanog expression variability in mouse embryonic stem
cells. Sci Rep. 2014;4:7125.
43.
Xu H, Sepulveda LA, Figard L, Sokac AM, Golding I. Combining protein and
mRNA quantification to decipher transcriptional regulation. Nat Methods.
2015;12:739–42.
44.
Li H, Handsaker B, Wysoker A, Fennell T, Ruan J, Homer N, Marth G, Abecasis
G, Durbin R, Genome Project Data Processing S. The Sequence Alignment/
Map format and SAMtools. Bioinformatics. 2009;25:2078–9.
45.
Munsky B, Neuert G, van Oudenaarden A. Using gene expression noise to
understand gene regulation. Science. 2012;336:183–7.
46.
Edsgard D, Reinius B, Sandberg R. scphaser: haplotype inference using
single-cell RNA-seq data. Bioinformatics. 2016;32:3038–40.
47.
Valencia-Sanchez MA, Liu J, Hannon GJ, Parker R. Control of translation and
mRNA degradation by miRNAs and siRNAs. Genes Dev. 2006;20:515–24.
48.
Wills QF, Livak KJ, Tipping AJ, Enver T, Goldson AJ, Sexton DW, Holmes C.
Single-cell gene expression analysis reveals genetic associations masked in
whole-tissue experiments. Nat Biotechnol. 2013;31:748–52.
•  We accept pre-submission inquiries 
•  Our selector tool helps you to ﬁnd the most relevant journal
•  We provide round the clock customer support 
•  Convenient online submission
•  Thorough peer review
•  Inclusion in PubMed and all major indexing services 
•  Maximum visibility for your research
Submit your manuscript at
www.biomedcentral.com/submit
Submit your next manuscript to BioMed Central 
and we will help you at every step:
Jiang et al. Genome Biology  (2017) 18:74 
Page 15 of 15
